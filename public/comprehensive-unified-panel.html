<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RawrZ Security Platform - Complete Unified Panel</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0b1020 0%, #1a1f3a 100%);
            color: #e6e9ef;
            min-height: 100vh;
        }

        .header {
            background: rgba(17, 22, 42, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid #222a45;
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header h1 {
            color: #4a9eff;
            font-size: 2rem;
            font-weight: 600;
            text-align: center;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .feature-card {
            background: rgba(17, 22, 42, 0.8);
            border: 1px solid #222a45;
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            border-color: #4a9eff;
            box-shadow: 0 0 20px rgba(74, 158, 255, 0.2);
        }

        .feature-card h3 {
            color: #4a9eff;
            font-size: 1.2rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            background: rgba(34, 42, 69, 0.5);
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .checkbox-item:hover {
            background: rgba(34, 42, 69, 0.8);
        }

        .checkbox-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
            accent-color: #4a9eff;
        }

        .checkbox-item label {
            font-size: 0.9rem;
            cursor: pointer;
            flex: 1;
        }

        .action-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-top: 1rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: #4a9eff;
            color: white;
        }

        .btn-primary:hover {
            background: #3a8eef;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .btn-warning {
            background: #ffc107;
            color: #212529;
        }

        .btn-warning:hover {
            background: #e0a800;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        .status-online {
            background: #28a745;
            box-shadow: 0 0 6px rgba(40, 167, 69, 0.6);
        }

        .status-offline {
            background: #dc3545;
            box-shadow: 0 0 6px rgba(220, 53, 69, 0.6);
        }

        .status-loading {
            background: #ffc107;
            box-shadow: 0 0 6px rgba(255, 193, 7, 0.6);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .file-upload-area {
            border: 2px dashed #4a9eff;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            margin: 1rem 0;
            background: rgba(74, 158, 255, 0.1);
            transition: all 0.3s ease;
        }

        .file-upload-area:hover {
            background: rgba(74, 158, 255, 0.2);
            border-color: #3a8eef;
        }

        .file-upload-area.dragover {
            background: rgba(74, 158, 255, 0.3);
            border-color: #3a8eef;
        }

        .hidden {
            display: none;
        }

        .expanded {
            grid-column: 1 / -1;
        }

        .algorithm-list {
            max-height: 200px;
            overflow-y: auto;
            background: rgba(34, 42, 69, 0.3);
            border-radius: 6px;
            padding: 1rem;
        }

        .algorithm-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.25rem 0;
            border-bottom: 1px solid rgba(74, 158, 255, 0.1);
        }

        .algorithm-item:last-child {
            border-bottom: none;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: rgba(34, 42, 69, 0.5);
            border-radius: 2px;
            overflow: hidden;
            margin: 0.5rem 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4a9eff, #3a8eef);
            transition: width 0.3s ease;
        }

        .log-output {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid #222a45;
            border-radius: 6px;
            padding: 1rem;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 1rem;
        }

        .log-entry {
            margin-bottom: 0.25rem;
            padding: 0.25rem;
            border-radius: 3px;
        }

        .log-info {
            color: #4a9eff;
        }

        .log-success {
            color: #28a745;
        }

        .log-warning {
            color: #ffc107;
        }

        .log-error {
            color: #dc3545;
        }

        /* Settings Panel */
        .settings-panel {
            background: rgba(17, 22, 42, 0.95);
            border: 1px solid #222a45;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .settings-panel h3 {
            color: #4a9eff;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .setting-group {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(74, 158, 255, 0.1);
        }

        .setting-group:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .setting-label {
            color: #e6e9ef;
            font-weight: 500;
        }

        .setting-input {
            background: rgba(34, 42, 69, 0.5);
            border: 1px solid #222a45;
            border-radius: 4px;
            color: #e6e9ef;
            padding: 0.5rem;
            width: 120px;
            text-align: right;
        }

        .setting-input:focus {
            outline: none;
            border-color: #4a9eff;
            box-shadow: 0 0 0 2px rgba(74, 158, 255, 0.2);
        }

        .setting-unit {
            color: #888;
            margin-left: 0.5rem;
            font-size: 0.9rem;
        }

        .settings-toggle {
            background: rgba(74, 158, 255, 0.1);
            border: 1px solid #4a9eff;
            color: #4a9eff;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 1rem;
        }

        .settings-toggle:hover {
            background: rgba(74, 158, 255, 0.2);
        }

        /* Achievement Badge System */
        .achievement-badge {
            display: inline-block;
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #333;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: bold;
            margin: 2px;
            box-shadow: 0 2px 4px rgba(255, 215, 0, 0.3);
            animation: badgeGlow 2s ease-in-out infinite alternate;
        }

        .achievement-badge.platinum {
            background: linear-gradient(135deg, #e5e4e2, #f7f7f7);
            color: #333;
            box-shadow: 0 2px 4px rgba(229, 228, 226, 0.3);
        }

        .achievement-badge.gold {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #333;
            box-shadow: 0 2px 4px rgba(255, 215, 0, 0.3);
        }

        .achievement-badge.silver {
            background: linear-gradient(135deg, #c0c0c0, #e8e8e8);
            color: #333;
            box-shadow: 0 2px 4px rgba(192, 192, 192, 0.3);
        }

        .achievement-badge.bronze {
            background: linear-gradient(135deg, #cd7f32, #daa520);
            color: white;
            box-shadow: 0 2px 4px rgba(205, 127, 50, 0.3);
        }

        .achievement-badge.legendary {
            background: linear-gradient(135deg, #8a2be2, #ff69b4);
            color: white;
            box-shadow: 0 2px 4px rgba(138, 43, 226, 0.3);
            animation: legendaryGlow 1.5s ease-in-out infinite alternate;
        }

        @keyframes badgeGlow {
            from { box-shadow: 0 2px 4px rgba(255, 215, 0, 0.3); }
            to { box-shadow: 0 4px 8px rgba(255, 215, 0, 0.6); }
        }

        @keyframes legendaryGlow {
            from { box-shadow: 0 2px 4px rgba(138, 43, 226, 0.3); }
            to { box-shadow: 0 6px 12px rgba(138, 43, 226, 0.8); }
        }

        .achievement-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
        }

        .achievement-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .achievement-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .achievement-item:hover {
            transform: translateY(-5px);
        }

        .achievement-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .achievement-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .achievement-description {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .achievement-progress {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            margin-top: 10px;
            overflow: hidden;
        }

        .achievement-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            border-radius: 3px;
            transition: width 0.5s ease;
        }

        .engine-achievements {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 10px;
        }

        /* Enhanced UI Components */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: rgba(17, 22, 42, 0.95);
            margin: 5% auto;
            padding: 2rem;
            border: 1px solid #4a9eff;
            border-radius: 12px;
            width: 80%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #222a45;
        }

        .modal-title {
            color: #4a9eff;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .close {
            color: #888;
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .close:hover {
            color: #dc3545;
        }

        .progress-container {
            background: rgba(34, 42, 69, 0.5);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .progress-bar-enhanced {
            width: 100%;
            height: 8px;
            background: rgba(34, 42, 69, 0.8);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill-enhanced {
            height: 100%;
            background: linear-gradient(90deg, #4a9eff, #3a8eef, #28a745);
            transition: width 0.3s ease;
            position: relative;
        }

        .progress-fill-enhanced::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .stat-card {
            background: rgba(34, 42, 69, 0.5);
            border: 1px solid #222a45;
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: #4a9eff;
            box-shadow: 0 0 15px rgba(74, 158, 255, 0.2);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #4a9eff;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #888;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(17, 22, 42, 0.95);
            border: 1px solid #4a9eff;
            border-radius: 8px;
            padding: 1rem;
            color: #e6e9ef;
            z-index: 1001;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            max-width: 300px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-color: #28a745;
        }

        .notification.error {
            border-color: #dc3545;
        }

        .notification.warning {
            border-color: #ffc107;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(17, 22, 42, 0.9);
            border: 1px solid #4a9eff;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 100;
        }

        .theme-toggle:hover {
            background: rgba(74, 158, 255, 0.2);
            box-shadow: 0 0 15px rgba(74, 158, 255, 0.3);
        }

        .quick-actions {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            z-index: 100;
        }

        .quick-action-btn {
            background: rgba(17, 22, 42, 0.9);
            border: 1px solid #4a9eff;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #4a9eff;
            font-size: 1.2rem;
        }

        .quick-action-btn:hover {
            background: rgba(74, 158, 255, 0.2);
            transform: scale(1.1);
        }

        .file-preview {
            background: rgba(34, 42, 69, 0.5);
            border: 1px solid #222a45;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            display: none;
        }

        .file-preview.show {
            display: block;
        }

        .file-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .file-info-item {
            display: flex;
            justify-content: space-between;
            padding: 0.25rem 0;
            border-bottom: 1px solid rgba(74, 158, 255, 0.1);
        }

        .file-info-item:last-child {
            border-bottom: none;
        }

        .file-info-label {
            color: #888;
            font-size: 0.9rem;
        }

        .file-info-value {
            color: #4a9eff;
            font-weight: 500;
        }

        /* Light Theme Styles */
        .light-theme {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            color: #212529;
        }

        .light-theme .header {
            background: rgba(248, 249, 250, 0.95);
            border-bottom: 1px solid #dee2e6;
        }

        .light-theme .header h1 {
            color: #495057;
        }

        .light-theme .feature-card {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #dee2e6;
        }

        .light-theme .feature-card:hover {
            border-color: #007bff;
            box-shadow: 0 0 20px rgba(0, 123, 255, 0.2);
        }

        .light-theme .feature-card h3 {
            color: #007bff;
        }

        .light-theme .checkbox-item {
            background: rgba(248, 249, 250, 0.8);
        }

        .light-theme .checkbox-item:hover {
            background: rgba(248, 249, 250, 1);
        }

        .light-theme .btn-primary {
            background: #007bff;
        }

        .light-theme .btn-primary:hover {
            background: #0056b3;
        }

        .light-theme .modal-content {
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid #007bff;
        }

        .light-theme .modal-title {
            color: #007bff;
        }

        .light-theme .stat-card {
            background: rgba(248, 249, 250, 0.8);
            border: 1px solid #dee2e6;
        }

        .light-theme .stat-card:hover {
            border-color: #007bff;
            box-shadow: 0 0 15px rgba(0, 123, 255, 0.2);
        }

        .light-theme .stat-value {
            color: #007bff;
        }

        .light-theme .stat-label {
            color: #6c757d;
        }

        .light-theme .file-upload-area {
            border: 2px dashed #007bff;
            background: rgba(0, 123, 255, 0.1);
        }

        .light-theme .file-upload-area:hover {
            background: rgba(0, 123, 255, 0.2);
            border-color: #0056b3;
        }

        .light-theme .file-upload-area.dragover {
            background: rgba(0, 123, 255, 0.3);
            border-color: #0056b3;
        }

        .light-theme .file-preview {
            background: rgba(248, 249, 250, 0.8);
            border: 1px solid #dee2e6;
        }

        .light-theme .file-info-label {
            color: #6c757d;
        }

        .light-theme .file-info-value {
            color: #007bff;
        }

        .light-theme .theme-toggle {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #007bff;
        }

        .light-theme .theme-toggle:hover {
            background: rgba(0, 123, 255, 0.2);
            box-shadow: 0 0 15px rgba(0, 123, 255, 0.3);
        }

        .light-theme .quick-action-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #007bff;
            color: #007bff;
        }

        .light-theme .quick-action-btn:hover {
            background: rgba(0, 123, 255, 0.2);
        }

        .light-theme .notification {
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid #007bff;
            color: #212529;
        }

        .light-theme .notification.success {
            border-color: #28a745;
        }

        .light-theme .notification.error {
            border-color: #dc3545;
        }

        .light-theme .notification.warning {
            border-color: #ffc107;
        }
    </style>
</head>
<body>
    <!-- Theme Toggle -->
    <div class="theme-toggle" onclick="toggleTheme()" title="Toggle Theme">
        üåô
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <div class="quick-action-btn" onclick="showSystemInfo()" title="System Info">
            ‚ÑπÔ∏è
        </div>
        <div class="quick-action-btn" onclick="showSettings()" title="Settings">
            ‚öôÔ∏è
        </div>
        <div class="quick-action-btn" onclick="showHelp()" title="Help">
            ‚ùì
        </div>
    </div>

    <div class="header">
        <h1>üõ°Ô∏è RawrZ Security Platform - Complete Unified Panel</h1>
        <div class="engine-achievements" id="headerAchievements">
            <span class="achievement-badge legendary">üèÜ LEGENDARY</span>
            <span class="achievement-badge platinum">üíé PLATINUM</span>
            <span class="achievement-badge gold">ü•á GOLD</span>
            <span class="achievement-badge silver">ü•à SILVER</span>
            <span class="achievement-badge bronze">ü•â BRONZE</span>
        </div>
    </div>

    <div class="container">
        <!-- Settings Panel -->
        <button class="settings-toggle" onclick="toggleSettings()">‚öôÔ∏è Settings</button>
        
        <div class="settings-panel" id="settingsPanel" style="display: none;">
            <h3>‚öôÔ∏è Configuration Settings</h3>
            
            <div class="setting-group">
                <span class="setting-label">Maximum File Size</span>
                <div>
                    <input type="number" id="maxFileSize" class="setting-input" value="1000" min="1" max="1048576">
                    <select id="fileSizeUnit" class="setting-input" style="width: 80px; margin-left: 0.5rem;">
                        <option value="MB">MB</option>
                        <option value="GB">GB</option>
                        <option value="TB">TB</option>
                    </select>
                </div>
            </div>
            
            <div class="setting-group">
                <span class="setting-label">Default Encryption Algorithm</span>
                <select id="defaultAlgorithm" class="setting-input" style="width: 150px;">
                    <option value="aes-256-gcm">AES-256-GCM</option>
                    <option value="aes-192-gcm">AES-192-GCM</option>
                    <option value="aes-128-gcm">AES-128-GCM</option>
                    <option value="aes-256-cbc">AES-256-CBC</option>
                    <option value="chacha20-poly1305">ChaCha20-Poly1305</option>
                    <option value="cam-256-gcm">CAM-256-GCM</option>
                    <option value="aria-256-gcm">ARIA-256-GCM</option>
                </select>
            </div>
            
            <div class="setting-group">
                <span class="setting-label">Show Progress for Files ></span>
                <div>
                    <input type="number" id="progressThreshold" class="setting-input" value="10" min="1" max="100">
                    <span class="setting-unit">MB</span>
                </div>
            </div>
            
            <div class="setting-group">
                <span class="setting-label">Auto-save Settings</span>
                <input type="checkbox" id="autoSaveSettings" checked>
            </div>
            
            <div style="margin-top: 1rem;">
                <button class="btn btn-primary" onclick="saveSettings()">üíæ Save Settings</button>
                <button class="btn btn-secondary" onclick="resetSettings()">üîÑ Reset to Defaults</button>
            </div>
        </div>

        <!-- Quick Actions Bar -->
        <div class="quick-actions-bar">
            <div class="quick-action" onclick="selectAllAlgorithms()">‚úÖ Select All</div>
            <div class="quick-action" onclick="deselectAllAlgorithms()">‚ùå Deselect All</div>
            <div class="quick-action" onclick="selectAESOnly()">üîê AES Only</div>
            <div class="quick-action" onclick="selectModernOnly()">üöÄ Modern Only</div>
            <div class="quick-action" onclick="selectLegacyOnly()">üìú Legacy Only</div>
            <div class="quick-action" onclick="toggleBatchMode()">üì¶ Batch Mode</div>
        </div>

        <!-- Performance Monitor -->
        <div class="performance-monitor">
            <h3><span class="status-indicator status-online"></span>üìä Performance Monitor</h3>
            <div class="performance-metrics">
                <div class="metric-item">
                    <div class="metric-value" id="currentSpeed">0</div>
                    <div class="metric-label">MB/s</div>
                </div>
                <div class="metric-item">
                    <div class="metric-value" id="totalProcessed">0</div>
                    <div class="metric-label">Files</div>
                </div>
                <div class="metric-item">
                    <div class="metric-value" id="avgTime">0</div>
                    <div class="metric-label">Avg Time (s)</div>
                </div>
                <div class="metric-item">
                    <div class="metric-value" id="successRate">100</div>
                    <div class="metric-label">Success %</div>
                </div>
            </div>
        </div>

        <!-- Batch Operations -->
        <div class="batch-operations" id="batchOperations">
            <h3><span class="status-indicator status-online"></span>üì¶ Batch Operations</h3>
            <div class="batch-info">
                <div>
                    <span class="batch-count" id="batchCount">0</span> files selected
                </div>
                <div class="batch-size" id="batchSize">0 MB total</div>
            </div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="batchEncrypt()">üîê Batch Encrypt</button>
                <button class="btn btn-secondary" onclick="batchGenerateStubs()">üì¶ Batch Generate Stubs</button>
                <button class="btn btn-success" onclick="batchProcess()">‚ö° Batch Process</button>
                <button class="btn btn-warning" onclick="clearBatch()">üóëÔ∏è Clear Batch</button>
            </div>
        </div>

        <!-- Achievement System -->
        <div class="achievement-section">
            <h3>üèÜ Achievement System</h3>
            <div class="achievement-grid" id="achievementGrid">
                <div class="achievement-item">
                    <div class="achievement-icon">üîê</div>
                    <div class="achievement-title">Crypto Master</div>
                    <div class="achievement-description">Use all 21 encryption algorithms</div>
                    <div class="achievement-progress">
                        <div class="achievement-progress-bar" style="width: 100%"></div>
                    </div>
                    <span class="achievement-badge legendary">LEGENDARY</span>
                </div>
                <div class="achievement-item">
                    <div class="achievement-icon">üõ°Ô∏è</div>
                    <div class="achievement-title">Security Expert</div>
                    <div class="achievement-description">Activate all 48 security engines</div>
                    <div class="achievement-progress">
                        <div class="achievement-progress-bar" style="width: 100%"></div>
                    </div>
                    <span class="achievement-badge platinum">PLATINUM</span>
                </div>
                <div class="achievement-item">
                    <div class="achievement-icon">üéØ</div>
                    <div class="achievement-title">Precision Operator</div>
                    <div class="achievement-description">Complete 100 operations</div>
                    <div class="achievement-progress">
                        <div class="achievement-progress-bar" style="width: 75%"></div>
                    </div>
                    <span class="achievement-badge gold">GOLD</span>
                </div>
                <div class="achievement-item">
                    <div class="achievement-icon">‚ö°</div>
                    <div class="achievement-title">Speed Demon</div>
                    <div class="achievement-description">Process 1TB of data</div>
                    <div class="achievement-progress">
                        <div class="achievement-progress-bar" style="width: 50%"></div>
                    </div>
                    <span class="achievement-badge silver">SILVER</span>
                </div>
                <div class="achievement-item">
                    <div class="achievement-icon">üîç</div>
                    <div class="achievement-title">Analyst Pro</div>
                    <div class="achievement-description">Run 50 security analyses</div>
                    <div class="achievement-progress">
                        <div class="achievement-progress-bar" style="width: 25%"></div>
                    </div>
                    <span class="achievement-badge bronze">BRONZE</span>
                </div>
                <div class="achievement-item">
                    <div class="achievement-icon">üéñÔ∏è</div>
                    <div class="achievement-title">Veteran User</div>
                    <div class="achievement-description">Use platform for 30 days</div>
                    <div class="achievement-progress">
                        <div class="achievement-progress-bar" style="width: 10%"></div>
                    </div>
                    <span class="achievement-badge bronze">BRONZE</span>
                </div>
            </div>
        </div>

        <!-- Encryption & Crypto Features -->
        <div class="feature-card">
            <h3><span class="status-indicator status-online"></span>üîê Advanced Encryption</h3>
            <div class="engine-achievements">
                <span class="achievement-badge legendary">21 ALGORITHMS</span>
                <span class="achievement-badge platinum">QUANTUM-READY</span>
                <span class="achievement-badge gold">AES-256</span>
                <span class="achievement-badge gold">CHACHA20</span>
                <span class="achievement-badge gold">CAMELLIA</span>
            </div>
            
            <!-- AES Algorithms -->
            <div class="algorithm-category">
                <h4>üîê AES (Advanced Encryption Standard)</h4>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="aes-256-gcm" checked>
                    <label for="aes-256-gcm">AES-256-GCM</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="aes-256-cbc">
                    <label for="aes-256-cbc">AES-256-CBC</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="aes-192-gcm">
                    <label for="aes-192-gcm">AES-192-GCM</label>
                </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="aes-192-cbc">
                        <label for="aes-192-cbc">AES-192-CBC</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="aes-128-gcm">
                    <label for="aes-128-gcm">AES-128-GCM</label>
                </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="aes-128-cbc">
                        <label for="aes-128-cbc">AES-128-CBC</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="aes-256-ctr">
                        <label for="aes-256-ctr">AES-256-CTR</label>
                    </div>
                </div>
            </div>

            <!-- ChaCha20 Algorithms -->
            <div class="algorithm-category">
                <h4>üåä ChaCha20 (Stream Cipher)</h4>
                <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="chacha20-poly1305">
                    <label for="chacha20-poly1305">ChaCha20-Poly1305</label>
                </div>
                <div class="checkbox-item">
                        <input type="checkbox" id="chacha20">
                        <label for="chacha20">ChaCha20</label>
                </div>
                </div>
            </div>

            <!-- Additional AES Variants -->
            <div class="algorithm-category">
                <h4>üîê Additional AES Variants</h4>
                <div class="checkbox-group">
                <div class="checkbox-item">
                        <input type="checkbox" id="aes-256-ctr">
                        <label for="aes-256-ctr">AES-256-CTR</label>
                </div>
                </div>
            </div>

            <!-- ARIA Algorithms -->
            <div class="algorithm-category">
                <h4>üéµ ARIA (Korean Standard)</h4>
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="aria-256-gcm">
                        <label for="aria-256-gcm">ARIA-256-GCM</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="aria-192-gcm">
                        <label for="aria-192-gcm">ARIA-192-GCM</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="aria-128-gcm">
                        <label for="aria-128-gcm">ARIA-128-GCM</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="aria-256-cbc">
                        <label for="aria-256-cbc">ARIA-256-CBC</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="aria-192-cbc">
                        <label for="aria-192-cbc">ARIA-192-CBC</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="aria-128-cbc">
                        <label for="aria-128-cbc">ARIA-128-CBC</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="aria-256-ctr">
                        <label for="aria-256-ctr">ARIA-256-CTR</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="aria-192-ctr">
                        <label for="aria-192-ctr">ARIA-192-CTR</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="aria-128-ctr">
                        <label for="aria-128-ctr">ARIA-128-CTR</label>
                    </div>
                </div>
            </div>


            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAdvancedEncryption()">Advanced Encryption Panel</button>
                <button class="btn btn-secondary" onclick="openEVCert()">EV Certificate Panel</button>
                <button class="btn btn-success" onclick="testEncryption()">Test Encryption</button>
            </div>
        </div>

        <!-- Stealth & Persistence Features -->
        <div class="feature-card">
            <h3><span class="status-indicator status-online"></span>üëª Stealth & Persistence</h3>
            <div class="engine-achievements">
                <span class="achievement-badge legendary">RING 0</span>
                <span class="achievement-badge platinum">RING 3</span>
                <span class="achievement-badge gold">STEALTH</span>
                <span class="achievement-badge silver">REGISTRY</span>
                <span class="achievement-badge bronze">BOOTKIT</span>
            </div>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="ring3-persistence" checked>
                    <label for="ring3-persistence">Ring 3 Persistence</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="ring0-persistence">
                    <label for="ring0-persistence">Ring 0 Persistence</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="registry-stealth" checked>
                    <label for="registry-stealth">Registry Stealth</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="file-hiding" checked>
                    <label for="file-hiding">Advanced File Hiding</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="service-spoofing" checked>
                    <label for="service-spoofing">Service Spoofing</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="mbr-stealth">
                    <label for="mbr-stealth">MBR Stealth</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="uefi-stealth">
                    <label for="uefi-stealth">UEFI Stealth</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="hypervisor-stealth">
                    <label for="hypervisor-stealth">Hypervisor Stealth</label>
                </div>
            </div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="configureStealth()">Configure Stealth</button>
                <button class="btn btn-warning" onclick="testPersistence()">Test Persistence</button>
            </div>
        </div>

        <!-- Payload & Stub Generation -->
        <div class="feature-card">
            <h3><span class="status-indicator status-online"></span>üéØ Payload & Stub Generation</h3>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="stub-generator" checked>
                    <label for="stub-generator">Stub Generator</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="payload-manager" checked>
                    <label for="payload-manager">Payload Manager</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="hot-patcher" checked>
                    <label for="hot-patcher">Hot Patcher</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="template-generator" checked>
                    <label for="template-generator">Template Generator</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="multi-platform" checked>
                    <label for="multi-platform">Multi-Platform Support</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="polymorphic" checked>
                    <label for="polymorphic">Polymorphic Code</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="metamorphic">
                    <label for="metamorphic">Metamorphic Code</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="anti-analysis" checked>
                    <label for="anti-analysis">Anti-Analysis</label>
                </div>
            </div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openStubGenerator()">Stub Generator Panel</button>
                <button class="btn btn-secondary" onclick="openPayloadPanel()">Payload Panel</button>
                <button class="btn btn-success" onclick="generateStub()">Generate Stub</button>
            </div>
        </div>

        <!-- Bot & Communication -->
        <div class="feature-card">
            <h3><span class="status-indicator status-online"></span>ü§ñ Bot & Communication</h3>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="irc-bot" checked>
                    <label for="irc-bot">IRC Bot Generator</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="http-bot" checked>
                    <label for="http-bot">HTTP Bot Manager</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="beaconism" checked>
                    <label for="beaconism">Beaconism DLL Sideloading</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="red-shells" checked>
                    <label for="red-shells">Red Shells Engine</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="red-killer" checked>
                    <label for="red-killer">Red Killer Panel</label>
                </div>
            </div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openIRCBot()">IRC Bot Builder</button>
                <button class="btn btn-secondary" onclick="openHTTPBot()">HTTP Bot Panel</button>
                <button class="btn btn-success" onclick="openBeaconism()">Beaconism Panel</button>
            </div>
        </div>

        <!-- Analysis & Detection -->
        <div class="feature-card">
            <h3><span class="status-indicator status-online"></span>üîç Analysis & Detection</h3>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="reverse-engineering" checked>
                    <label for="reverse-engineering">Reverse Engineering</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="malware-analysis" checked>
                    <label for="malware-analysis">Malware Analysis</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="cve-analysis" checked>
                    <label for="cve-analysis">CVE Analysis Engine</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="ai-threat-detector" checked>
                    <label for="ai-threat-detector">AI Threat Detector</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="virus-scanner" checked>
                    <label for="virus-scanner">Private Virus Scanner</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="advanced-analytics" checked>
                    <label for="advanced-analytics">Advanced Analytics</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="anti-analysis-engine" checked>
                    <label for="anti-analysis-engine">Advanced Anti-Analysis</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="digital-forensics" checked>
                    <label for="digital-forensics">Digital Forensics</label>
                </div>
            </div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openCVEAnalysis()">CVE Analysis Panel</button>
                <button class="btn btn-secondary" onclick="openHealthDashboard()">Health Dashboard</button>
                <button class="btn btn-warning" onclick="runFullScan()">Run Full Scan</button>
            </div>
        </div>

        <!-- Jotti Malware Scanner -->
        <div class="feature-card">
            <h3><span class="status-indicator status-online"></span>üõ°Ô∏è Jotti Malware Scanner</h3>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="jotti-scanner" checked>
                    <label for="jotti-scanner">Jotti Scanner</label>
                </div>
            </div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openJottiScanner()">Open Jotti Scanner</button>
                <button class="btn btn-success" onclick="scanWithJotti()">Scan Selected Files</button>
                <button class="btn btn-info" onclick="viewJottiResults()">View Results</button>
            </div>
        </div>

        <!-- File Operations -->
        <div class="feature-card">
            <h3><span class="status-indicator status-online"></span>üìÅ File Operations</h3>
            <div class="file-upload-area" id="fileUploadArea">
                <p>üì§ Click to upload file or drag and drop</p>
                <p style="font-size: 0.8rem; color: #888; margin-top: 0.5rem;">
                    Supports all file types: .exe, .dll, .xll, .lnk, .ps1, .bat, .js, .vbs, .txt, .bin, .dat, .cfg, .ini, .xml, .json, .log, .tmp, .sys, .drv, .ocx, .cpl, .scr, .com, .pif, .cmd, .msi, .cab, .zip, .rar, .7z, .pdf, .doc, .docx, .xls, .xlsx, .ppt, .pptx, .jpg, .jpeg, .png, .gif, .bmp, .tiff, .mp3, .mp4, .avi, .mkv, .wav, .flac, .mov, .wmv, .m4a, .aac, .ogg, .webm, .html, .css, .php, .asp, .jsp, .py, .rb, .pl, .sh, .ps, .reg, .inf, .cat, .cer, .crt, .pem, .p12, .pfx, .key, .csr, .der, .p7b, .p7c, .spc, .sst, .stl, .pst, .ost, .msg, .eml, .mht, .mhtml, .url, .webloc, .desktop, .app, .deb, .rpm, .dmg, .iso, .img, .vhd, .vdi, .vmdk, .ova, .ovf, .qcow2, .raw, .bin, .hex, .elf, .so, .dylib, .a, .lib, .obj, .o, .exe, .dll, .sys, .drv, .ocx, .cpl, .scr, .com, .pif, .cmd, .bat, .ps1, .vbs, .js, .jse, .wsf, .wsh, .hta, .chm, .hlp, .cnt, .gid, .fts, .ftg
                </p>
                <input type="file" id="fileInput" style="display: none;" multiple>
            </div>
            
            <!-- File Preview -->
            <div class="file-preview" id="filePreview">
                <h4>üìÑ File Preview</h4>
                <div class="file-info" id="fileInfo">
                    <!-- File information will be populated here -->
                </div>
                <div class="progress-container" id="uploadProgress" style="display: none;">
                    <div class="progress-info">
                        <span id="progressText">Uploading...</span>
                        <span id="progressPercent">0%</span>
                    </div>
                    <div class="progress-bar-enhanced">
                        <div class="progress-fill-enhanced" id="progressFill" style="width: 0%"></div>
                    </div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="processFile()">Process File</button>
                <button class="btn btn-secondary" onclick="encryptFile()">Encrypt File</button>
                <button class="btn btn-success" onclick="generateStubFromFile()">Generate Stub</button>
                <button class="btn btn-warning" onclick="clearFiles()">Clear Files</button>
            </div>
        </div>

        <!-- System Status -->
        <div class="feature-card">
            <h3><span class="status-indicator status-online"></span>‚öôÔ∏è System Status</h3>
            
            <!-- Enhanced Stats Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalEngines">48</div>
                    <div class="stat-label">Total Engines</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="loadedEngines">48</div>
                    <div class="stat-label">Loaded Engines</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="activeOperations">0</div>
                    <div class="stat-label">Active Operations</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="memoryUsage">42MB</div>
                    <div class="stat-label">Memory Usage</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="cpuUsage">15%</div>
                    <div class="stat-label">CPU Usage</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="uptime">2h 15m</div>
                    <div class="stat-label">Uptime</div>
                </div>
            </div>
            
                <div class="algorithm-list" id="algorithmList">
                    <div class="algorithm-item">
                    <span>Available Algorithms</span>
                    <span id="algorithmCount">Loading...</span>
                    </div>
                    <div class="algorithm-item">
                    <span>Encryption Operations</span>
                    <span id="encryptionOps">0</span>
                    </div>
                    <div class="algorithm-item">
                    <span>Files Processed</span>
                    <span id="filesProcessed">0</span>
                    </div>
                    <div class="algorithm-item">
                    <span>Last Activity</span>
                    <span id="lastActivity">Never</span>
                    </div>
                </div>
            
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="refreshStatus()">Refresh Status</button>
                <button class="btn btn-secondary" onclick="showLogs()">Show Logs</button>
                <button class="btn btn-warning" onclick="restartEngines()">Restart Engines</button>
                <button class="btn btn-success" onclick="exportStatus()">Export Status</button>
            </div>
        </div>

        <!-- Log Output -->
        <div class="feature-card" id="logCard" style="display: none;">
            <h3><span class="status-indicator status-online"></span>üìã System Logs</h3>
            <div class="log-output" id="logOutput">
                <div class="log-entry log-info">System initialized successfully</div>
            </div>
        </div>
    </div>

    <script>
        // Global settings object
        let userSettings = {
            maxFileSize: 1000, // Size value
            maxFileSizeUnit: 'MB', // Unit (MB, GB, TB)
            defaultAlgorithm: 'aes-256-gcm',
            progressThreshold: 10, // MB
            autoSave: true
        };

        // Function declarations to avoid hoisting issues
        
        // Get selected encryption algorithms from checkboxes
        function getSelectedAlgorithms() {
            const algorithms = [];
            
            // Map frontend checkbox IDs to backend algorithm names (only Node.js supported algorithms)
            const algorithmMapping = {
                'aes-256-gcm': 'aes-256-gcm',
                'aes-256-cbc': 'aes-256-cbc', 
                'aes-192-gcm': 'aes-192-gcm',
                'aes-192-cbc': 'aes-192-cbc',
                'aes-128-gcm': 'aes-128-gcm',
                'aes-128-cbc': 'aes-128-cbc',
                'aes-256-ctr': 'aes-256-ctr',
                'chacha20-poly1305': 'chacha20-poly1305',
                'chacha20': 'chacha20',
                'aria-256-gcm': 'aria-256-gcm',
                'aria-192-gcm': 'aria-192-gcm',
                'aria-128-gcm': 'aria-128-gcm',
                'aria-256-cbc': 'aria-256-cbc',
                'aria-192-cbc': 'aria-192-cbc',
                'aria-128-cbc': 'aria-128-cbc',
                'aria-256-ctr': 'aria-256-ctr',
                'aria-192-ctr': 'aria-192-ctr',
                'aria-128-ctr': 'aria-128-ctr'
            };
            
            Object.keys(algorithmMapping).forEach(checkboxId => {
                const checkbox = document.getElementById(checkboxId);
                if (checkbox && checkbox.checked) {
                    algorithms.push(algorithmMapping[checkboxId]);
                }
            });
            
            return algorithms;
        }
        
        // Get selected persistence options
        function getSelectedPersistence() {
            const persistence = {
                ring3: document.getElementById('ring3-persistence')?.checked || false,
                ring0: document.getElementById('ring0-persistence')?.checked || false,
                registryStealth: document.getElementById('registry-stealth')?.checked || false,
                fileHiding: document.getElementById('file-hiding')?.checked || false,
                serviceSpoofing: document.getElementById('service-spoofing')?.checked || false,
                mbrStealth: document.getElementById('mbr-stealth')?.checked || false,
                uefiStealth: document.getElementById('uefi-stealth')?.checked || false,
                hypervisorStealth: document.getElementById('hypervisor-stealth')?.checked || false
            };
            return persistence;
        }
        
        // Get selected features
        function getSelectedFeatures() {
            const features = {
                stubGenerator: document.getElementById('stub-generator')?.checked || false,
                payloadManager: document.getElementById('payload-manager')?.checked || false,
                hotPatcher: document.getElementById('hot-patcher')?.checked || false,
                templateGenerator: document.getElementById('template-generator')?.checked || false,
                multiPlatform: document.getElementById('multi-platform')?.checked || false,
                polymorphic: document.getElementById('polymorphic')?.checked || false,
                metamorphic: document.getElementById('metamorphic')?.checked || false,
                antiAnalysis: document.getElementById('anti-analysis')?.checked || false,
                ircBot: document.getElementById('irc-bot')?.checked || false,
                httpBot: document.getElementById('http-bot')?.checked || false,
                beaconism: document.getElementById('beaconism')?.checked || false,
                redShells: document.getElementById('red-shells')?.checked || false,
                redKiller: document.getElementById('red-killer')?.checked || false,
                reverseEngineering: document.getElementById('reverse-engineering')?.checked || false,
                malwareAnalysis: document.getElementById('malware-analysis')?.checked || false,
                cveAnalysis: document.getElementById('cve-analysis')?.checked || false,
                aiThreatDetector: document.getElementById('ai-threat-detector')?.checked || false,
                virusScanner: document.getElementById('virus-scanner')?.checked || false
            };
            return features;
        }
        
        function updateBatchInfo() {
            const fileInput = document.getElementById('fileInput');
            const batchCount = document.getElementById('batchCount');
            const batchSize = document.getElementById('batchSize');
            const batchInfo = document.getElementById('batchInfo');
            
            if (!fileInput) return;
            
            const files = fileInput.files;
            
            if (files && files.length > 0) {
                const totalSize = Array.from(files).reduce((sum, file) => sum + file.size, 0);
                const sizeMB = (totalSize / 1024 / 1024).toFixed(2);
                
                if (batchCount) batchCount.textContent = files.length;
                if (batchSize) batchSize.textContent = `${sizeMB} MB`;
                if (batchInfo) {
                    batchInfo.innerHTML = `
                        <div class="batch-stats">
                            <span>Files: ${files.length}</span>
                            <span>Total Size: ${sizeMB} MB</span>
                        </div>
                    `;
                }
            } else {
                if (batchCount) batchCount.textContent = '0';
                if (batchSize) batchSize.textContent = '0 MB';
                if (batchInfo) {
                    batchInfo.innerHTML = '<div class="batch-stats">No files selected</div>';
                }
            }
        }

        // Performance monitoring
        let performanceStats = {
            totalFiles: 0,
            totalTime: 0,
            totalSize: 0,
            successCount: 0,
            errorCount: 0
        };

        // Batch operations (consolidated)
        let batchMode = false;
        let selectedFiles = [];

        // Algorithm selection functions
        function selectAllAlgorithms() {
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                if (checkbox.id.includes('aes-') || checkbox.id.includes('chacha') || 
                    checkbox.id.includes('cam-') || checkbox.id.includes('aria-') || 
                    checkbox.id.includes('aria-')) {
                    checkbox.checked = true;
                }
            });
            addLog('All algorithms selected', 'success');
        }

        function deselectAllAlgorithms() {
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                if (checkbox.id.includes('aes-') || checkbox.id.includes('chacha') || 
                    checkbox.id.includes('cam-') || checkbox.id.includes('aria-') || 
                    checkbox.id.includes('aria-')) {
                    checkbox.checked = false;
                }
            });
            addLog('All algorithms deselected', 'info');
        }

        function selectAESOnly() {
            deselectAllAlgorithms();
            document.querySelectorAll('input[id^="aes-"]').forEach(checkbox => {
                checkbox.checked = true;
            });
            addLog('AES algorithms selected', 'success');
        }

        function selectModernOnly() {
            deselectAllAlgorithms();
            const modernAlgorithms = ['aes-256-gcm', 'aes-192-gcm', 'aes-128-gcm', 
                                    'chacha20-poly1305', 'cam-256-gcm', 'aria-256-gcm'];
            modernAlgorithms.forEach(id => {
                const checkbox = document.getElementById(id);
                if (checkbox) checkbox.checked = true;
            });
            addLog('Modern algorithms selected', 'success');
        }

        function selectLegacyOnly() {
            deselectAllAlgorithms();
            const legacyAlgorithms = ['aes-256-cbc', 'aes-192-cbc', 'aes-128-cbc', 
                                    'aria-256-ctr', 'aria-192-ctr', 'aria-128-ctr'];
            legacyAlgorithms.forEach(id => {
                const checkbox = document.getElementById(id);
                if (checkbox) checkbox.checked = true;
            });
            addLog('Legacy algorithms selected', 'success');
        }

        // Batch operations
        function toggleBatchMode() {
            batchMode = !batchMode;
            const batchOps = document.getElementById('batchOperations');
            const toggleBtn = document.querySelector('[onclick="toggleBatchMode()"]');
            
            if (batchMode) {
                batchOps.classList.add('show');
                toggleBtn.classList.add('active');
                addLog('Batch mode enabled', 'success');
            } else {
                batchOps.classList.remove('show');
                toggleBtn.classList.remove('active');
                clearBatch();
                addLog('Batch mode disabled', 'info');
            }
        }


        function batchEncrypt() {
            // Wait for DOM to be ready
            if (document.readyState === 'loading') {
                showNotification('Page is still loading. Please wait and try again.', 'error');
                return;
            }
            
            const fileInput = document.getElementById('fileInput');
            if (!fileInput) {
                showNotification('File input element not found! DOM may not be ready.', 'error');
                return;
            }
            
            const files = fileInput.files;
            if (files.length === 0) {
                showNotification('No files selected for batch encryption', 'warning');
                return;
            }
            
            addLog(`Starting batch encryption for ${files.length} files...`, 'info');
            processFileWithProgress(files, 'Batch encryption');
        }

        function batchGenerateStubs() {
            // Wait for DOM to be ready
            if (document.readyState === 'loading') {
                showNotification('Page is still loading. Please wait and try again.', 'error');
                return;
            }
            
            const fileInput = document.getElementById('fileInput');
            if (!fileInput) {
                showNotification('File input element not found! DOM may not be ready.', 'error');
                return;
            }
            
            const files = fileInput.files;
            if (files.length === 0) {
                showNotification('No files selected for batch stub generation', 'warning');
                return;
            }
            
            addLog(`Starting batch stub generation for ${files.length} files...`, 'info');
            processFileWithProgress(files, 'Batch stub generation');
        }

        function batchProcess() {
            // Wait for DOM to be ready
            if (document.readyState === 'loading') {
                showNotification('Page is still loading. Please wait and try again.', 'error');
                return;
            }
            
            const fileInput = document.getElementById('fileInput');
            if (!fileInput) {
                showNotification('File input element not found! DOM may not be ready.', 'error');
                return;
            }
            
            const files = fileInput.files;
            if (files.length === 0) {
                showNotification('No files selected for batch processing', 'warning');
                return;
            }
            
            addLog(`Starting batch processing for ${files.length} files...`, 'info');
            processFileWithProgress(files, 'Batch processing');
        }

        function clearBatch() {
            document.getElementById('fileInput').value = '';
            document.getElementById('filePreview').classList.remove('show');
            if (typeof updateBatchInfo === 'function') {
                updateBatchInfo();
            }
            addLog('Batch cleared', 'info');
        }

        function updatePerformanceMetrics() {
            const currentSpeed = document.getElementById('currentSpeed');
            const totalProcessed = document.getElementById('totalProcessed');
            const avgTime = document.getElementById('avgTime');
            const successRate = document.getElementById('successRate');

            if (currentSpeed && performanceStats.totalTime > 0) {
                const speed = (performanceStats.totalSize / 1024 / 1024) / (performanceStats.totalTime / 1000);
                currentSpeed.textContent = speed.toFixed(1);
            }

            if (totalProcessed) {
                totalProcessed.textContent = performanceStats.totalFiles;
            }
            
            if (avgTime && performanceStats.totalFiles > 0) {
                avgTime.textContent = (performanceStats.totalTime / performanceStats.totalFiles / 1000).toFixed(1);
            }

            if (successRate) {
                const totalOps = performanceStats.successCount + performanceStats.errorCount;
                if (totalOps > 0) {
                    successRate.textContent = Math.round((performanceStats.successCount / totalOps) * 100);
                }
            }
        }

        function recordOperation(size, duration, success) {
            performanceStats.totalFiles++;
            performanceStats.totalTime += duration;
            performanceStats.totalSize += size;
            
            if (success) {
                performanceStats.successCount++;
            } else {
                performanceStats.errorCount++;
            }
            
            updatePerformanceMetrics();
        }

        // Achievement System
        const achievementSystem = {
            achievements: {
                'crypto-master': { name: 'Crypto Master', description: 'Use all 21 encryption algorithms', progress: 21, max: 21, tier: 'legendary', icon: 'üîê' },
                'security-expert': { name: 'Security Expert', description: 'Activate all 48 security engines', progress: 48, max: 48, tier: 'platinum', icon: 'üõ°Ô∏è' },
                'precision-operator': { name: 'Precision Operator', description: 'Complete 100 operations', progress: 75, max: 100, tier: 'gold', icon: 'üéØ' },
                'speed-demon': { name: 'Speed Demon', description: 'Process 1TB of data', progress: 500, max: 1000, tier: 'silver', icon: '‚ö°' },
                'analyst-pro': { name: 'Analyst Pro', description: 'Run 50 security analyses', progress: 12, max: 50, tier: 'bronze', icon: 'üîç' },
                'veteran-user': { name: 'Veteran User', description: 'Use platform for 30 days', progress: 3, max: 30, tier: 'bronze', icon: 'üéñÔ∏è' }
            },
            
            updateAchievement: function(achievementId, progress) {
                if (this.achievements[achievementId]) {
                    this.achievements[achievementId].progress = Math.min(progress, this.achievements[achievementId].max);
                    this.saveAchievements();
                    this.updateAchievementDisplay();
                }
            },
            
            saveAchievements: function() {
                localStorage.setItem('rawrz-achievements', JSON.stringify(this.achievements));
            },
            
            loadAchievements: function() {
                const saved = localStorage.getItem('rawrz-achievements');
                if (saved) {
                    this.achievements = { ...this.achievements, ...JSON.parse(saved) };
                }
            },
            
            updateAchievementDisplay: function() {
                const grid = document.getElementById('achievementGrid');
                if (!grid) return;
                
                grid.innerHTML = '';
                Object.entries(this.achievements).forEach(([id, achievement]) => {
                    const progressPercent = (achievement.progress / achievement.max) * 100;
                    const isCompleted = achievement.progress >= achievement.max;
                    
                    const item = document.createElement('div');
                    item.className = 'achievement-item';
                    item.innerHTML = `
                        <div class="achievement-icon">${achievement.icon}</div>
                        <div class="achievement-title">${achievement.name}</div>
                        <div class="achievement-description">${achievement.description}</div>
                        <div class="achievement-progress">
                            <div class="achievement-progress-bar" style="width: ${progressPercent}%"></div>
                        </div>
                        <span class="achievement-badge ${achievement.tier}">${achievement.tier.toUpperCase()}</span>
                        ${isCompleted ? '<span class="achievement-badge legendary">COMPLETED!</span>' : ''}
                    `;
                    grid.appendChild(item);
                });
            },
            
            checkForNewAchievements: function() {
                // Check for new achievements based on user actions
                const totalOperations = parseInt(localStorage.getItem('rawrz-total-operations') || '0');
                const totalDataProcessed = parseInt(localStorage.getItem('rawrz-total-data') || '0');
                const totalAnalyses = parseInt(localStorage.getItem('rawrz-total-analyses') || '0');
                
                this.updateAchievement('precision-operator', totalOperations);
                this.updateAchievement('speed-demon', totalDataProcessed);
                this.updateAchievement('analyst-pro', totalAnalyses);
            }
        };

        // Initialize the panel (consolidated)
        document.addEventListener('DOMContentLoaded', function() {
            // Add a small delay to ensure all elements are fully loaded
            setTimeout(() => {
                refreshStatus();
                setupFileUpload();
                loadEngineStatus();
                loadSettings();
                achievementSystem.loadAchievements();
                achievementSystem.updateAchievementDisplay();
                achievementSystem.checkForNewAchievements();
                
                // Start auto-refresh if enabled (with null check)
                const autoRefreshElement = document.getElementById('autoRefresh');
                if (autoRefreshElement && autoRefreshElement.checked) {
                    startAutoRefresh();
                }
            }, 100);
        });

        // File upload functionality
        function setupFileUpload() {
            const uploadArea = document.getElementById('fileUploadArea');
            const fileInput = document.getElementById('fileInput');

            if (!uploadArea) {
                console.error('Upload area element not found! DOM may not be ready.');
                return;
            }
            
            if (!fileInput) {
                console.error('File input element not found! DOM may not be ready.');
                return;
            }

            uploadArea.addEventListener('click', () => fileInput.click());
            uploadArea.addEventListener('dragover', handleDragOver);
            uploadArea.addEventListener('dragleave', handleDragLeave);
            uploadArea.addEventListener('drop', handleDrop);
            fileInput.addEventListener('change', handleFileSelect);
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('dragover');
        }

        function handleDragLeave(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
            const files = e.dataTransfer.files;
            handleFiles(files);
        }

        function handleFileSelect(e) {
            const files = e.target.files;
            handleFiles(files);
        }

        function handleFiles(files) {
            const filePreview = document.getElementById('filePreview');
            const fileInfo = document.getElementById('fileInfo');
            const fileInput = document.getElementById('fileInput');
            
            fileInfo.innerHTML = '';
            
            // Set the files in the file input so encryptFile() can access them
            if (fileInput) {
                // Create a new DataTransfer object to set files
                const dataTransfer = new DataTransfer();
                for (let file of files) {
                    dataTransfer.items.add(file);
                }
                fileInput.files = dataTransfer.files;
            }
            
            for (let file of files) {
                addLog(`File selected: ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)`, 'info');
                
                // Create file info display with type indicator
                const fileItem = document.createElement('div');
                fileItem.className = 'file-info-item';
                const fileType = getFileType(file.name);
                const typeIndicator = getFileTypeIndicator(fileType);
                
                fileItem.innerHTML = `
                    <span class="file-info-label">
                        ${file.name}
                        <span class="file-type-indicator ${typeIndicator.class}">${typeIndicator.text}</span>
                    </span>
                    <span class="file-info-value">${(file.size / 1024 / 1024).toFixed(2)} MB</span>
                `;
                fileInfo.appendChild(fileItem);
            }
            
            filePreview.classList.add('show');
            if (typeof updateBatchInfo === 'function') {
                updateBatchInfo();
            }
        }

        // File type detection
        function getFileType(filename) {
            const ext = filename.toLowerCase().split('.').pop();
            const executableExts = ['exe', 'dll', 'sys', 'drv', 'ocx', 'cpl', 'scr', 'com', 'pif', 'cmd', 'bat', 'ps1', 'vbs', 'js', 'jse', 'wsf', 'wsh', 'hta'];
            const documentExts = ['txt', 'doc', 'docx', 'pdf', 'rtf', 'odt', 'xls', 'xlsx', 'ppt', 'pptx', 'csv', 'xml', 'json', 'html', 'css', 'php', 'asp', 'jsp'];
            const mediaExts = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'tiff', 'mp3', 'mp4', 'avi', 'mkv', 'wav', 'flac', 'mov', 'wmv', 'm4a', 'aac', 'ogg', 'webm'];
            const archiveExts = ['zip', 'rar', '7z', 'tar', 'gz', 'bz2', 'xz', 'cab', 'msi', 'deb', 'rpm', 'dmg', 'iso', 'img'];
            
            if (executableExts.includes(ext)) return 'executable';
            if (documentExts.includes(ext)) return 'document';
            if (mediaExts.includes(ext)) return 'media';
            if (archiveExts.includes(ext)) return 'archive';
            return 'other';
        }

        function getFileTypeIndicator(type) {
            const indicators = {
                executable: { class: 'file-type-executable', text: 'EXE' },
                document: { class: 'file-type-document', text: 'DOC' },
                media: { class: 'file-type-media', text: 'MEDIA' },
                archive: { class: 'file-type-archive', text: 'ARCHIVE' },
                other: { class: 'file-type-other', text: 'FILE' }
            };
            return indicators[type] || indicators.other;
        }

        // Status and engine management
        async function refreshStatus() {
            try {
                const response = await fetch('/api/rawrz-engine/status');
                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('totalEngines').textContent = data.data.modules.total;
                    document.getElementById('loadedEngines').textContent = data.data.modules.loaded;
                    document.getElementById('activeOperations').textContent = data.data.activeOperations;
                    document.getElementById('memoryUsage').textContent = `${(data.data.memory.heapUsed / 1024 / 1024).toFixed(1)} MB`;
                    
                    addLog('Status refreshed successfully', 'success');
                }
            } catch (error) {
                addLog(`Error refreshing status: ${error.message}`, 'error');
            }
        }

        // Standardized API call function
        async function apiCall(endpoint, method = 'GET', body = null) {
            try {
                const headers = {
                    'Content-Type': 'application/json'
                };
                
                const token = localStorage.getItem('authToken');
                if (token) {
                    headers.Authorization = `Bearer ${token}`;
                }
                
                const response = await fetch(endpoint, {
                    method: method,
                    headers: headers,
                    body: body ? JSON.stringify(body) : null
                });
                
                const data = await response.text();
                try {
                    return { status: response.status, data: JSON.parse(data) };
                } catch {
                    return { status: response.status, data: data };
                }
            } catch (error) {
                return { status: 500, data: { error: error.message } };
            }
        }

        async function loadEngineStatus() {
            try {
                const result = await apiCall('/api/rawrz-engine/status');
                
                if (result.status === 200 && result.data.success) {
                    const algorithms = result.data.data.config.crypto.algorithms;
                    const algorithmList = document.getElementById('algorithmList');
                    
                    // Add algorithm count
                    const algorithmCount = document.createElement('div');
                    algorithmCount.className = 'algorithm-item';
                    algorithmCount.innerHTML = `<span>Available Algorithms</span><span>${algorithms.length}</span>`;
                    algorithmList.appendChild(algorithmCount);
                    
                    addLog(`Loaded ${algorithms.length} encryption algorithms`, 'info');
                } else {
                    addLog(`Error loading engine status: ${result.data.error || 'Unknown error'}`, 'error');
                }
            } catch (error) {
                addLog(`Error loading engine status: ${error.message}`, 'error');
            }
        }

        // Panel navigation functions
        function openAdvancedEncryption() {
            window.open('/public/advanced-encryption-panel.html', '_blank');
        }

        function openEVCert() {
            window.open('/public/ev-cert-panel.html', '_blank');
        }

        function openStubGenerator() {
            window.open('/public/stub-generator-panel.html', '_blank');
        }

        function openPayloadPanel() {
            window.open('/public/payload-panel.html', '_blank');
        }

        function openIRCBot() {
            window.open('/public/irc-bot-builder.html', '_blank');
        }

        function openHTTPBot() {
            window.open('/public/http-bot-panel.html', '_blank');
        }

        function openBeaconism() {
            window.open('/public/beaconism-panel.html', '_blank');
        }

        function openCVEAnalysis() {
            window.open('/public/cve-analysis-panel.html', '_blank');
        }

        function openHealthDashboard() {
            window.open('/public/health-dashboard.html', '_blank');
        }

        // Action functions
        async function testEncryption() {
            addLog('Testing encryption algorithms...', 'info');
            try {
                const result = await apiCall('/api/health');
                if (result.status === 200 && result.data.success) {
                    addLog('Encryption test completed successfully', 'success');
                } else {
                    addLog(`Encryption test failed: ${result.data.error || 'Unknown error'}`, 'error');
                }
            } catch (error) {
                addLog(`Encryption test failed: ${error.message}`, 'error');
            }
        }

        function configureStealth() {
            addLog('Opening stealth configuration...', 'info');
            // Open stealth configuration modal or panel
        }

        function testPersistence() {
            addLog('Testing persistence mechanisms...', 'info');
            // Test persistence features
        }

        function generateStub() {
            addLog('Generating stub...', 'info');
            // Generate stub with current settings
        }

        function processFile() {
            // Wait for DOM to be ready
            if (document.readyState === 'loading') {
                addLog('Page is still loading. Please wait and try again.', 'error');
                return;
            }
            
            const fileInput = document.getElementById('fileInput');
            if (!fileInput) {
                addLog('File input element not found! DOM may not be ready.', 'error');
                return;
            }
            
            const files = fileInput.files;
            if (files.length === 0) {
                addLog('No files selected for processing', 'warning');
                return;
            }
            addLog(`Processing ${files.length} file(s)...`, 'info');
        }

        async function encryptFile() {
            // Wait for DOM to be ready
            if (document.readyState === 'loading') {
                addLog('Page is still loading. Please wait and try again.', 'error');
                return;
            }
            
            // Wait a moment for DOM elements to be available
            await new Promise(resolve => setTimeout(resolve, 100));
            
            const fileInput = document.getElementById('fileInput');
            if (!fileInput) {
                addLog('File input element not found! DOM may not be ready.', 'error');
                return;
            }
            
            const files = fileInput.files;
            if (files.length === 0) {
                addLog('No files selected for encryption', 'warning');
                return;
            }
            
            addLog(`Encrypting ${files.length} file(s)...`, 'info');
            
            for (let file of files) {
                try {
                    // Check file size using configurable limit
                    if (!checkFileSize(file, file.name)) {
                        continue;
                    }
                    
                    addLog(`Encrypting ${file.name} (${(file.size / 1024 / 1024).toFixed(2)}MB)...`, 'info');
                    
                    const formData = new FormData();
                    formData.append('file', file);
                    formData.append('certificate', 'RawrZ-EV-Certificate-Default'); // Add required certificate
                    
                    // Use selected algorithms from UI
                    const selectedAlgorithms = getSelectedAlgorithms();
                    if (selectedAlgorithms.length > 0) {
                        formData.append('algorithm', selectedAlgorithms[0]); // Use first selected algorithm
                    } else {
                        formData.append('algorithm', 'aes-256-gcm'); // Default fallback
                    }
                    
                    formData.append('extension', '.enc');
                    formData.append('format', 'base64');
                    formData.append('saveLocation', 'desktop');
                    
                    // Use selected persistence options from UI
                    const selectedPersistence = getSelectedPersistence();
                    formData.append('persistence', JSON.stringify(selectedPersistence));
                    
                    // Show progress for large files
                    showProgressIfNeeded(file.size);
                    
                    const startTime = Date.now();
                    const response = await fetch('/ev-encrypt', {
                        method: 'POST',
                        body: formData
                    });
                    const endTime = Date.now();
                    
                    let result;
                    try {
                        result = await response.json();
                    } catch (error) {
                        addLog(`Invalid response format for ${file.name}: ${error.message}`, 'error');
                        return;
                    }
                    
                    if (result.success) {
                        const duration = ((endTime - startTime) / 1000).toFixed(2);
                        const speed = (file.size / 1024 / 1024 / (duration / 1000)).toFixed(2);
                        addLog(`Successfully encrypted ${file.name} in ${duration}s (${speed} MB/s)`, 'success');
                        
                        // Handle different response structures
                        let encryptedData, algorithm, metadata;
                        
                        if (result.data && result.data.encrypted) {
                            // Full response with encrypted data
                            encryptedData = result.data.encrypted;
                            algorithm = result.data.algorithm || 'aes-256-gcm';
                            metadata = result.data.metadata || { size: file.size };
                        } else {
                            // Simple success response - create a placeholder
                            addLog(`Encryption completed for ${file.name}`, 'success');
                            addLog('File encrypted successfully - check your downloads folder', 'info');
                            return; // Exit early for simple success responses
                        }
                        
                        // Create download blob based on format
                        let blob;
                        if (result.data.format === 'base64') {
                            // Convert base64 to binary for download
                            const binaryString = atob(encryptedData);
                            const bytes = new Uint8Array(binaryString.length);
                            for (let i = 0; i < binaryString.length; i++) {
                                bytes[i] = binaryString.charCodeAt(i);
                            }
                            blob = new Blob([bytes], { type: 'application/octet-stream' });
                        } else {
                            blob = new Blob([encryptedData], { type: 'text/plain' });
                        }
                        
                        // Trigger download
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `${file.name}.enc`;
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        URL.revokeObjectURL(url);
                        
                        // Log additional metadata
                        addLog(`Algorithm: ${algorithm}, Original size: ${metadata.size} bytes, Encrypted size: ${metadata.encryptedSize} bytes`, 'info');
                        
                    } else {
                        addLog(`Encryption failed for ${file.name}: ${result.error}`, 'error');
                    }
                } catch (error) {
                    if (error.name === 'AbortError') {
                        addLog(`Encryption cancelled for ${file.name}`, 'warning');
                    } else {
                        addLog(`Error encrypting ${file.name}: ${error.message}`, 'error');
                    }
                }
            }
        }

        async function generateStubFromFile() {
            // Wait for DOM to be ready
            if (document.readyState === 'loading') {
                addLog('Page is still loading. Please wait and try again.', 'error');
                return;
            }
            
            // Wait a moment for DOM elements to be available
            await new Promise(resolve => setTimeout(resolve, 100));
            
            const fileInput = document.getElementById('fileInput');
            if (!fileInput) {
                addLog('File input element not found! DOM may not be ready.', 'error');
                return;
            }
            
            const files = fileInput.files;
            if (files.length === 0) {
                addLog('No files selected for stub generation', 'warning');
                return;
            }
            
            addLog(`Generating stub from ${files.length} file(s)...`, 'info');
            
            for (let file of files) {
                try {
                    // Check file size using configurable limit
                    if (!checkFileSize(file, file.name)) {
                        continue;
                    }
                    
                    addLog(`Generating stub for ${file.name} (${(file.size / 1024 / 1024).toFixed(2)}MB)...`, 'info');
                    
                    const formData = new FormData();
                    formData.append('file', file);
                    formData.append('stubType', 'native');
                    formData.append('framework', 'cpp');
                    formData.append('encryption', selectedAlgorithms[0] || 'aes-256-gcm');
                    formData.append('antiAnalysis', 'true');
                    formData.append('stealth', 'true');
                    
                    // Show progress for large files
                    showProgressIfNeeded(file.size);
                    
                    const startTime = Date.now();
                    const response = await fetch('/api/rawrz-engine/execute', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            engineId: 'stub-generator',
                            action: 'generateStub',
                            params: {
                                target: file.name,
                                stubType: 'cpp',
                                encryptionMethod: selectedAlgorithms[0] || 'aes-256-gcm',
                                options: {
                                    stealth: Object.entries(selectedFeatures).filter(([k,v]) => v).map(([k]) => k),
                                    antiAnalysis: Object.entries(selectedFeatures).filter(([k,v]) => v && k.includes('anti')).map(([k]) => k),
                                    mutex: selectedFeatures.mutex || false,
                                    upx: selectedFeatures.upx || false,
                                    obfuscation: selectedFeatures.obfuscation || false
                                }
                            }
                        })
                    });
                    const endTime = Date.now();
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        const duration = ((endTime - startTime) / 1000).toFixed(2);
                        const speed = (file.size / 1024 / 1024 / (duration / 1000)).toFixed(2);
                        const stubData = result.data;
                        
                        addLog(`Successfully generated stub for ${file.name} in ${duration}s (${speed} MB/s)`, 'success');
                        addLog(`Stub Details: ${stubData.stubType} with ${stubData.encryptionMethod}`, 'info');
                        addLog(`Payload Size: ${stubData.payloadSize} bytes ‚Üí Encrypted: ${stubData.encryptedSize} bytes`, 'info');
                        addLog(`Features: ${Object.keys(stubData.features).filter(k => stubData.features[k]).join(', ')}`, 'info');
                        
                        // Generate stub content for download
                        const stubContent = `// RawrZ Generated Stub - ${stubData.stubType}
// Target: ${stubData.target}
// Encryption: ${stubData.encryptionMethod}
// Generated: ${stubData.timestamp}
// ID: ${stubData.id}

#include <iostream>
#include <windows.h>
#include <string>

class RawrZStub {
private:
    std::string target = "${stubData.target}";
    std::string encryption = "${stubData.encryptionMethod}";
    
public:
    void execute() {
        std::cout << "RawrZ Stub executing..." << std::endl;
        std::cout << "Target: " << target << std::endl;
        std::cout << "Encryption: " << encryption << std::endl;
        
        // Anti-analysis features
        ${Object.keys(stubData.features).filter(k => stubData.features[k]).map(feature => 
            `// ${feature}: Enabled`
        ).join('\n        ')}
        
        // Stub implementation here
    }
};

int main() {
    RawrZStub stub;
    stub.execute();
    return 0;
}`;
                        
                        // Trigger download
                        const blob = new Blob([stubContent], { type: 'text/plain' });
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = stubData.outputPath || `${file.name}_stub.cpp`;
                        a.click();
                        URL.revokeObjectURL(url);
                    } else {
                        addLog(`Stub generation failed for ${file.name}: ${result.error}`, 'error');
                    }
                } catch (error) {
                    if (error.name === 'AbortError') {
                        addLog(`Stub generation cancelled for ${file.name}`, 'warning');
                    } else {
                        addLog(`Error generating stub for ${file.name}: ${error.message}`, 'error');
                    }
                }
            }
        }

        async function runFullScan() {
            addLog('Starting full system scan...', 'info');
            
            try {
                const response = await fetch('/api/rawrz-engine/status');
                const result = await response.json();
                
                if (result.success) {
                    addLog(`System Status: ${result.status}`, 'success');
                    addLog(`Engines Available: ${result.engines?.length || 0}`, 'info');
                    addLog(`Memory Usage: ${result.memory?.used || 'N/A'}`, 'info');
                } else {
                    addLog(`Scan failed: ${result.error}`, 'error');
                }
            } catch (error) {
                addLog(`Error during scan: ${error.message}`, 'error');
            }
        }

        async function encryptWithEVCertificate() {
            // Wait for DOM to be ready
            if (document.readyState === 'loading') {
                addLog('Page is still loading. Please wait and try again.', 'error');
                return;
            }
            
            // Wait a moment for DOM elements to be available
            await new Promise(resolve => setTimeout(resolve, 100));
            
            const fileInput = document.getElementById('fileInput');
            if (!fileInput) {
                addLog('File input element not found! DOM may not be ready.', 'error');
                return;
            }
            
            const files = fileInput.files;
            if (files.length === 0) {
                addLog('No files selected for EV certificate encryption', 'warning');
                return;
            }
            
            addLog(`Encrypting with EV Certificate: ${files.length} file(s)...`, 'info');
            
            for (let file of files) {
                try {
                    // Check file size using configurable limit
                    if (!checkFileSize(file, file.name)) {
                        continue;
                    }
                    
                    addLog(`EV Certificate encrypting ${file.name} (${(file.size / 1024 / 1024).toFixed(2)}MB)...`, 'info');
                    
                    const formData = new FormData();
                    formData.append('file', file);
                    formData.append('certificate', 'microsoft');
                    formData.append('algorithm', selectedAlgorithms[0] || 'aes-256-gcm');
                    formData.append('format', 'base64');
                    formData.append('extension', '.enc');
                    
                    // Show progress for large files
                    showProgressIfNeeded(file.size);
                    
                    const startTime = Date.now();
                    const response = await fetch('/ev-encrypt', {
                        method: 'POST',
                        body: formData
                    });
                    const endTime = Date.now();
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        const duration = ((endTime - startTime) / 1000).toFixed(2);
                        const speed = (file.size / 1024 / 1024 / (duration / 1000)).toFixed(2);
                        addLog(`Successfully EV encrypted ${file.name} in ${duration}s (${speed} MB/s)`, 'success');
                        
                        // Trigger download
                        const blob = new Blob([result.data.encrypted], { type: 'text/plain' });
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `${file.name}_ev.enc`;
                        a.click();
                        URL.revokeObjectURL(url);
                    } else {
                        addLog(`EV encryption failed for ${file.name}: ${result.error}`, 'error');
                    }
                } catch (error) {
                    if (error.name === 'AbortError') {
                        addLog(`EV encryption cancelled for ${file.name}`, 'warning');
                    } else {
                        addLog(`Error EV encrypting ${file.name}: ${error.message}`, 'error');
                    }
                }
            }
        }

        async function generateAdvancedPayload() {
            // Wait for DOM to be ready
            if (document.readyState === 'loading') {
                addLog('Page is still loading. Please wait and try again.', 'error');
                return;
            }
            
            // Wait a moment for DOM elements to be available
            await new Promise(resolve => setTimeout(resolve, 100));
            
            const fileInput = document.getElementById('fileInput');
            if (!fileInput) {
                addLog('File input element not found! DOM may not be ready.', 'error');
                return;
            }
            
            const files = fileInput.files;
            if (files.length === 0) {
                addLog('No files selected for advanced payload generation', 'warning');
                return;
            }
            
            addLog(`Generating advanced payload: ${files.length} file(s)...`, 'info');
            
            for (let file of files) {
                try {
                    const formData = new FormData();
                    formData.append('file', file);
                    formData.append('type', 'beaconism');
                    formData.append('platform', 'windows');
                    formData.append('function', 'reverse_shell');
                    formData.append('host', '127.0.0.1');
                    formData.append('port', '4444');
                    formData.append('evasion', 'true');
                    formData.append('beaconism', 'true');
                    
                    addLog(`Generating advanced payload for ${file.name}...`, 'info');
                    
                    const response = await fetch('/api/rawrz-engine/execute', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            engineId: 'payload-manager',
                            action: 'managePayload',
                            params: {
                                action: 'generate',
                                payloadData: {
                                    file: { name: file.name, size: file.size },
                                    payloads: ['basic-payload', 'advanced-payload'],
                                    injectionPoints: ['beginning', 'middle', 'end']
                                },
                                options: {
                                    stealthFeatures: Object.entries(selectedFeatures).filter(([k,v]) => v && ['polymorphic', 'metamorphic', 'packing'].includes(k)).map(([k]) => k),
                                    antiAnalysisFeatures: Object.entries(selectedFeatures).filter(([k,v]) => v && k.includes('anti')).map(([k]) => k)
                                }
                            }
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        const payloadData = result.data;
                        addLog(`Successfully generated advanced payload for ${file.name}`, 'success');
                        addLog(`Payload Type: ${payloadData.action || 'Advanced Payload'}`, 'info');
                        addLog(`Payload Data: ${JSON.stringify(payloadData.payloadData, null, 2)}`, 'info');
                        
                        // Generate payload content for download
                        const payloadContent = `// RawrZ Generated Advanced Payload
// Target: ${file.name}
// Generated: ${new Date().toISOString()}
// Action: ${payloadData.action || 'generate'}

${JSON.stringify(payloadData, null, 2)}

// RawrZ Payload Implementation
// This payload is generated by the RawrZ Security Platform
// Features: Anti-debug, Anti-VM, Stealth communication, Encrypted data transmission

class RawrZPayload {
    constructor() {
        this.serverUrl = '${payloadData.serverUrl || 'https://localhost:3000'}';
        this.encryptionKey = '${payloadData.encryptionKey || 'defaultkey'}';
        this.isRunning = true;
        this.stealthMode = true;
    }
    
    // Anti-debugging protection
    isDebuggerPresent() {
        return false; // Implemented in actual payload
    }
    
    // Anti-VM detection
    isVirtualMachine() {
        return false; // Implemented in actual payload
    }
    
    // Encrypted communication
    encryptData(data) {
        // Encryption implementation would be here
        return btoa(data); // Base64 for demo
    }
    
    // Main payload execution
    execute() {
        if (this.isDebuggerPresent() || this.isVirtualMachine()) {
            return; // Exit if detected
        }
        
        // Main payload logic
        this.sendHeartbeat();
        this.startCommunication();
    }
    
    // Send heartbeat to server
    sendHeartbeat() {
        const heartbeat = {
            id: '${payloadData.id || 'payload-001'}',
            status: 'alive',
            timestamp: Date.now()
        };
        
        // Send encrypted heartbeat
        const encrypted = this.encryptData(JSON.stringify(heartbeat));
        // Implementation would send to server
    }
    
    // Start main communication loop
    startCommunication() {
        // Main communication implementation
        console.log('RawrZ Payload active and communicating');
    }
}

// Execute payload
const payload = new RawrZPayload();
payload.execute();`;
                        
                        // Trigger download
                        const blob = new Blob([payloadContent], { type: 'text/plain' });
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `${file.name}_payload.exe`;
                        a.click();
                        URL.revokeObjectURL(url);
                    } else {
                        addLog(`Advanced payload generation failed for ${file.name}: ${result.error}`, 'error');
                    }
                } catch (error) {
                    addLog(`Error generating advanced payload for ${file.name}: ${error.message}`, 'error');
                }
            }
        }

        function showLogs() {
            const logCard = document.getElementById('logCard');
            logCard.style.display = logCard.style.display === 'none' ? 'block' : 'none';
        }

        function restartEngines() {
            addLog('Restarting engines...', 'warning');
            // Restart engine system
        }

        // Logging function
        function addLog(message, type = 'info') {
            const logOutput = document.getElementById('logOutput');
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${type}`;
            logEntry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logOutput.appendChild(logEntry);
            logOutput.scrollTop = logOutput.scrollHeight;
        }

        // Enhanced UI Functions
        function showNotification(message, type = 'info', duration = 3000) {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => document.body.removeChild(notification), 300);
            }, duration);
        }

        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        function toggleTheme() {
            const themeToggle = document.querySelector('.theme-toggle');
            const isDark = document.body.classList.contains('light-theme');
            
            if (isDark) {
                document.body.classList.remove('light-theme');
                themeToggle.textContent = 'üåô';
                showNotification('Switched to dark theme', 'success');
            } else {
                document.body.classList.add('light-theme');
                themeToggle.textContent = '‚òÄÔ∏è';
                showNotification('Switched to light theme', 'success');
            }
        }

        function showSystemInfo() {
            showModal('systemInfoModal');
        }

        function showSettings() {
            showModal('settingsModal');
        }

        function showHelp() {
            showModal('helpModal');
        }

        function toggleSettings() {
            const settingsPanel = document.getElementById('settingsPanel');
            if (settingsPanel) {
                const isVisible = settingsPanel.style.display !== 'none';
                settingsPanel.style.display = isVisible ? 'none' : 'block';
                addLog(`Settings panel ${isVisible ? 'hidden' : 'shown'}`, 'info');
            }
        }

        function checkFileSize(file, filename) {
            const maxSize = userSettings.maxFileSize;
            const unit = userSettings.maxFileSizeUnit;
            
            // Convert file size to the same unit as the limit
            let fileSizeInUnit;
            switch (unit) {
                case 'KB':
                    fileSizeInUnit = file.size / 1024;
                    break;
                case 'MB':
                    fileSizeInUnit = file.size / (1024 * 1024);
                    break;
                case 'GB':
                    fileSizeInUnit = file.size / (1024 * 1024 * 1024);
                    break;
                case 'TB':
                    fileSizeInUnit = file.size / (1024 * 1024 * 1024 * 1024);
                    break;
                default:
                    fileSizeInUnit = file.size / (1024 * 1024); // Default to MB
            }
            
            if (fileSizeInUnit > maxSize) {
                addLog(`File ${filename} (${fileSizeInUnit.toFixed(2)}${unit}) exceeds maximum size limit (${maxSize}${unit})`, 'error');
                return false;
            }
            
            return true;
        }

        function showProgressIfNeeded(fileSize) {
            const maxSizeForProgress = 100 * 1024 * 1024; // 100MB - WIDE OPEN
            if (fileSize > maxSizeForProgress) {
                addLog('Large file detected - showing progress...', 'info');
                // You can add progress bar UI here if needed
            }
        }

        function clearFiles() {
            const fileInput = document.getElementById('fileInput');
            const filePreview = document.getElementById('filePreview');
            
            fileInput.value = '';
            filePreview.classList.remove('show');
            addLog('Files cleared', 'info');
            showNotification('Files cleared successfully', 'success');
        }

        function exportStatus() {
            const statusData = {
                timestamp: new Date().toISOString(),
                engines: {
                    total: document.getElementById('totalEngines').textContent,
                    loaded: document.getElementById('loadedEngines').textContent
                },
                memory: document.getElementById('memoryUsage').textContent,
                uptime: document.getElementById('uptime').textContent
            };
            
            const blob = new Blob([JSON.stringify(statusData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `rawrz-status-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showNotification('Status exported successfully', 'success');
        }

        function saveSettings() {
            const settings = {
                autoRefresh: document.getElementById('autoRefresh').checked,
                notifications: document.getElementById('notifications').checked,
                darkMode: document.getElementById('darkMode').checked,
                soundEffects: document.getElementById('soundEffects').checked
            };
            
            localStorage.setItem('rawrzSettings', JSON.stringify(settings));
            showNotification('Settings saved successfully', 'success');
            closeModal('settingsModal');
        }

        function resetSettings() {
            localStorage.removeItem('rawrzSettings');
            document.getElementById('autoRefresh').checked = true;
            document.getElementById('notifications').checked = true;
            document.getElementById('darkMode').checked = true;
            document.getElementById('soundEffects').checked = false;
            showNotification('Settings reset to default', 'info');
        }

        function loadSettings() {
            const settings = JSON.parse(localStorage.getItem('rawrzSettings') || '{}');
            
            if (settings.autoRefresh !== undefined) document.getElementById('autoRefresh').checked = settings.autoRefresh;
            if (settings.notifications !== undefined) document.getElementById('notifications').checked = settings.notifications;
            if (settings.darkMode !== undefined) document.getElementById('darkMode').checked = settings.darkMode;
            if (settings.soundEffects !== undefined) document.getElementById('soundEffects').checked = settings.soundEffects;
        }

        // Enhanced file processing with progress
        async function processFileWithProgress(files, operation) {
            const uploadProgress = document.getElementById('uploadProgress');
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            const progressPercent = document.getElementById('progressPercent');
            
            uploadProgress.style.display = 'block';
            
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const progress = ((i + 1) / files.length) * 100;
                
                progressFill.style.width = `${progress}%`;
                progressPercent.textContent = `${Math.round(progress)}%`;
                progressText.textContent = `Processing ${file.name}...`;
                
                // Simulate processing time
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                addLog(`${operation} completed for ${file.name}`, 'success');
            }
            
            uploadProgress.style.display = 'none';
            showNotification(`${operation} completed for ${files.length} file(s)`, 'success');
        }

        // Enhanced file processing functions
        async function processFile() {
            // Wait for DOM to be ready
            if (document.readyState === 'loading') {
                showNotification('Page is still loading. Please wait and try again.', 'error');
                return;
            }
            
            // Wait a moment for DOM elements to be available
            await new Promise(resolve => setTimeout(resolve, 100));
            
            const fileInput = document.getElementById('fileInput');
            if (!fileInput) {
                showNotification('File input element not found! DOM may not be ready.', 'error');
                return;
            }
            
            const files = fileInput.files;
            if (files.length === 0) {
                showNotification('No files selected for processing', 'warning');
                return;
            }
            
            await processFileWithProgress(files, 'File processing');
        }

        // Consolidated encryptFile function (duplicate removed)

        async function generateStubFromFile() {
            // Wait for DOM to be ready
            if (document.readyState === 'loading') {
                showNotification('Page is still loading. Please wait and try again.', 'error');
                return;
            }
            
            // Wait a moment for DOM elements to be available
            await new Promise(resolve => setTimeout(resolve, 100));
            
            const fileInput = document.getElementById('fileInput');
            if (!fileInput) {
                showNotification('File input element not found! DOM may not be ready.', 'error');
                return;
            }
            
            const files = fileInput.files;
            if (files.length === 0) {
                showNotification('No files selected for stub generation', 'warning');
                return;
            }
            
            await processFileWithProgress(files, 'Stub generation');
        }

        // Jotti Scanner Functions
        function openJottiScanner() {
            addLog('Opening Jotti Scanner panel...', 'info');
            // Open Jotti scanner in new window
            window.open('https://virusscan.jotti.org', '_blank');
        }

        async function scanWithJotti() {
            const files = getSelectedFiles();
            if (!files || files.length === 0) {
                showNotification('No files selected for Jotti scanning', 'warning');
                return;
            }

            addLog(`Starting Jotti scan for ${files.length} file(s)...`, 'info');
            
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                addLog(`Scanning ${file.name} (${(file.size / 1024 / 1024).toFixed(2)}MB) with Jotti...`, 'info');
                
                try {
                    const formData = new FormData();
                    formData.append('file', file);
                    
                    const response = await fetch('/api/rawrz-engine/execute', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            engineId: 'jotti-scanner',
                            action: 'scanFile',
                            params: {
                                filePath: file.name,
                                options: {
                                    batch: true,
                                    detailed: true
                                }
                            }
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        const scanData = result.data;
                        addLog(`‚úÖ Jotti scan completed for ${file.name}`, 'success');
                        addLog(`üìä Results: ${scanData.cleanScanners}/${scanData.totalScanners} scanners clean`, 'info');
                        
                        if (scanData.flaggedScanners > 0) {
                            addLog(`‚ö†Ô∏è ${scanData.flaggedScanners} scanners flagged the file`, 'warning');
                        }
                        
                        // Display detailed results
                        displayJottiResults(scanData, file.name);
                    } else {
                        addLog(`‚ùå Jotti scan failed for ${file.name}: ${result.error}`, 'error');
                    }
                } catch (error) {
                    addLog(`‚ùå Error scanning ${file.name} with Jotti: ${error.message}`, 'error');
                }
            }
        }

        function displayJottiResults(scanData, fileName) {
            const resultsHtml = `
                <div class="jotti-results" style="background: rgba(15, 21, 48, 0.9); border: 1px solid #263056; border-radius: 8px; padding: 1rem; margin: 1rem 0;">
                    <h4>üõ°Ô∏è Jotti Scan Results - ${fileName}</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1rem 0;">
                        <div>
                            <strong>üìä Summary:</strong><br>
                            Status: <span style="color: ${scanData.status === 'clean' ? '#4CAF50' : '#FF9800'}">${scanData.summary.overall}</span><br>
                            Confidence: ${scanData.summary.confidence}<br>
                            Clean Scanners: ${scanData.cleanScanners}/${scanData.totalScanners}<br>
                            File Size: ${scanData.fileSize}<br>
                            MD5: <code>${scanData.md5}</code><br>
                            SHA1: <code>${scanData.sha1}</code>
                        </div>
                        <div>
                            <strong>üîç Scanner Results:</strong><br>
                            ${scanData.scanners.map(scanner => 
                                `${scanner.icon} ${scanner.name}: <span style="color: ${scanner.status === 'CLEAN' ? '#4CAF50' : '#FF9800'}">${scanner.status}</span>`
                            ).join('<br>')}
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <strong>üí° Recommendation:</strong> ${scanData.summary.recommendation}
                    </div>
                    <div style="margin-top: 1rem;">
                        <a href="${scanData.jottiUrl}" target="_blank" class="btn btn-primary" style="padding: 0.5rem 1rem; text-decoration: none; display: inline-block;">
                            üîó View on Jotti Website
                        </a>
                    </div>
                </div>
            `;
            
            // Add results to log
            const logEntry = document.createElement('div');
            logEntry.innerHTML = resultsHtml;
            document.getElementById('logContainer').appendChild(logEntry);
            
            // Scroll to results
            logEntry.scrollIntoView({ behavior: 'smooth' });
        }

        function viewJottiResults() {
            addLog('Fetching Jotti scan history...', 'info');
            
            fetch('/api/rawrz-engine/execute', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    engineId: 'jotti-scanner',
                    action: 'getAllScanResults',
                    params: {}
                })
            })
            .then(response => response.json())
            .then(result => {
                if (result.success && result.data.length > 0) {
                    addLog(`üìã Found ${result.data.length} Jotti scan results`, 'info');
                    result.data.forEach(scan => {
                        displayJottiResults(scan.results, scan.fileName);
                    });
                } else {
                    addLog('üìã No Jotti scan results found', 'info');
                }
            })
            .catch(error => {
                addLog(`‚ùå Error fetching Jotti results: ${error.message}`, 'error');
            });
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey) {
                switch(e.key) {
                    case 'u':
                        e.preventDefault();
                        document.getElementById('fileInput').click();
                        break;
                    case 'e':
                        e.preventDefault();
                        encryptFile();
                        break;
                    case 's':
                        e.preventDefault();
                        generateStubFromFile();
                        break;
                }
            } else if (e.key === 'F5') {
                e.preventDefault();
                refreshStatus();
            }
        });

        // Close modals when clicking outside
        window.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal')) {
                e.target.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        });

        // Auto-refresh functionality
        let autoRefreshInterval;
        function startAutoRefresh() {
            if (autoRefreshInterval) clearInterval(autoRefreshInterval);
            autoRefreshInterval = setInterval(refreshStatus, 30000); // Refresh every 30 seconds
        }

        function stopAutoRefresh() {
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
                autoRefreshInterval = null;
            }
        }

        // Duplicate DOMContentLoaded listener removed - functionality consolidated above






    </script>
</body>
</html>