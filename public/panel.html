<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RawrZ Security Platform - Advanced Panel</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #0c0f1a 0%, #1a1f2e 100%);
            color: #e6e9ef; 
            min-height: 100vh;
        }
        .header { 
            background: linear-gradient(90deg, #1a1f2e 0%, #2d3748 100%);
            padding: 1rem 2rem; 
            border-bottom: 2px solid #4a5568;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        .header h1 { 
            color: #68d391; 
            font-size: 1.8rem; 
            font-weight: 600;
            text-shadow: 0 0 10px rgba(104, 211, 145, 0.3);
        }
        .header .subtitle { 
            color: #a0aec0; 
            font-size: 0.9rem; 
            margin-top: 0.25rem;
        }
        .container { 
            max-width: 1400px; 
            margin: 0 auto; 
            padding: 2rem; 
        }
        .grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); 
            gap: 1.5rem; 
            margin-bottom: 2rem;
        }
        .card { 
            background: linear-gradient(145deg, #1a202c 0%, #2d3748 100%);
            border: 1px solid #4a5568; 
            border-radius: 12px; 
            padding: 1.5rem; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .card:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        .card h3 { 
            color: #68d391; 
            margin-bottom: 1rem; 
            font-size: 1.1rem;
            border-bottom: 1px solid #4a5568;
            padding-bottom: 0.5rem;
        }
        .form-group { 
            margin-bottom: 1rem; 
        }
        .form-group label { 
            display: block; 
            margin-bottom: 0.5rem; 
            color: #cbd5e0; 
            font-weight: 500;
        }
        input, select, textarea, button { 
            width: 100%; 
            padding: 0.75rem; 
            border: 1px solid #4a5568; 
            border-radius: 8px; 
            background: #2d3748; 
            color: #e6e9ef; 
            font-size: 0.9rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        input:focus, select:focus, textarea:focus { 
            outline: none; 
            border-color: #68d391; 
            box-shadow: 0 0 0 3px rgba(104, 211, 145, 0.1);
        }
        button { 
            background: linear-gradient(135deg, #68d391 0%, #48bb78 100%);
            border: none; 
            color: #1a202c; 
            font-weight: 600; 
            cursor: pointer; 
            transition: all 0.2s;
            margin-top: 0.5rem;
        }
        button:hover { 
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(104, 211, 145, 0.3);
        }
        button:disabled { 
            background: #4a5568; 
            cursor: not-allowed; 
            transform: none;
        }
        .row { 
            display: flex; 
            gap: 0.5rem; 
            flex-wrap: wrap; 
        }
        .row input, .row select, .row button { 
            flex: 1; 
            min-width: 120px; 
        }
        .output { 
            background: #0c0f1a; 
            border: 1px solid #2d3748; 
            border-radius: 8px; 
            padding: 1rem; 
            margin-top: 1rem; 
            max-height: 400px; 
            overflow-y: auto; 
            font-family: 'Courier New', monospace; 
            font-size: 0.85rem;
            white-space: pre-wrap;
            word-break: break-all;
        }
        .status { 
            padding: 0.5rem 1rem; 
            border-radius: 6px; 
            margin: 0.5rem 0; 
            font-weight: 500;
        }
        .status.success { background: rgba(104, 211, 145, 0.2); color: #68d391; border: 1px solid #68d391; }
        .status.error { background: rgba(245, 101, 101, 0.2); color: #f56565; border: 1px solid #f56565; }
        .status.info { background: rgba(66, 153, 225, 0.2); color: #4299e1; border: 1px solid #4299e1; }
        .auth-section { 
            background: linear-gradient(145deg, #2d3748 0%, #4a5568 100%);
            border: 2px solid #68d391;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        .tabs { 
            display: flex; 
            border-bottom: 1px solid #4a5568; 
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        .tab { 
            padding: 0.75rem 1.5rem; 
            background: #2d3748; 
            border: none; 
            color: #a0aec0; 
            cursor: pointer; 
            border-radius: 8px 8px 0 0;
            margin-right: 0.25rem;
            transition: all 0.2s;
            margin-bottom: 0.25rem;
        }
        .tab.active { 
            background: #68d391; 
            color: #1a202c; 
        }
        .tab-content { 
            display: none; 
        }
        .tab-content.active { 
            display: block; 
        }
        .file-list { 
            max-height: 200px; 
            overflow-y: auto; 
            border: 1px solid #4a5568; 
            border-radius: 6px; 
            padding: 0.5rem;
        }
        .file-item { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: 0.5rem; 
            border-bottom: 1px solid #2d3748;
        }
        .file-item:last-child { 
            border-bottom: none; 
        }
        .file-name { 
            color: #e6e9ef; 
            font-family: monospace; 
        }
        .file-size { 
            color: #a0aec0; 
            font-size: 0.8rem; 
        }
        .loading { 
            display: inline-block; 
            width: 20px; 
            height: 20px; 
            border: 2px solid #4a5568; 
            border-radius: 50%; 
            border-top-color: #68d391; 
            animation: spin 1s ease-in-out infinite; 
        }
        @keyframes spin { 
            to { transform: rotate(360deg); } 
        }
        .feature-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 1rem; 
        }
        .feature-card { 
            background: #1a202c; 
            border: 1px solid #4a5568; 
            border-radius: 8px; 
            padding: 1rem; 
            text-align: center;
            transition: all 0.2s;
        }
        .feature-card:hover { 
            border-color: #68d391; 
            background: #2d3748;
        }
        .feature-card h4 { 
            color: #68d391; 
            margin-bottom: 0.5rem;
        }
        .feature-card p { 
            color: #a0aec0; 
            font-size: 0.85rem;
        }
        
        /* File Upload Styles */
        .file-upload-section {
            background: linear-gradient(145deg, #1a202c 0%, #2d3748 100%);
            border: 1px solid #4a5568;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .upload-zone {
            border: 2px dashed #4a5568;
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            transition: all 0.3s ease;
            cursor: pointer;
            margin-bottom: 1.5rem;
        }
        
        .upload-zone:hover {
            border-color: #68d391;
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            transform: translateY(-2px);
        }
        
        .upload-zone.dragover {
            border-color: #68d391;
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            box-shadow: 0 0 20px rgba(104, 211, 145, 0.3);
        }
        
        .upload-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }
        
        .upload-icon {
            font-size: 3rem;
            opacity: 0.7;
        }
        
        .url-upload-section {
            margin-bottom: 1.5rem;
        }
        
        .uploaded-files {
            background: #1a202c;
            border: 1px solid #4a5568;
            border-radius: 8px;
            padding: 1rem;
        }
        
        .file-list {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: linear-gradient(145deg, #2d3748 0%, #1a202c 100%);
            border: 1px solid #4a5568;
            border-radius: 12px;
            margin-bottom: 0.75rem;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        
        .file-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, #68d391 0%, #48bb78 100%);
            transition: width 0.3s ease;
        }
        
        .file-item:hover {
            background: linear-gradient(145deg, #4a5568 0%, #2d3748 100%);
            border-color: #68d391;
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(104, 211, 145, 0.2);
        }
        
        .file-item:hover::before {
            width: 6px;
        }
        
        .file-item.selected {
            border-color: #68d391;
            background: linear-gradient(145deg, #2d3748 0%, #1a202c 100%);
            box-shadow: 0 0 0 2px rgba(104, 211, 145, 0.3);
        }
        
        .file-info {
            display: flex;
            flex-direction: column;
            flex: 1;
            gap: 0.25rem;
        }
        
        .file-name {
            font-weight: 600;
            color: #e2e8f0;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .file-size {
            font-size: 0.8rem;
            color: #a0aec0;
            font-weight: 500;
        }
        
        .file-algorithm {
            font-size: 0.75rem;
            color: #68d391;
            background: rgba(104, 211, 145, 0.1);
            padding: 0.125rem 0.375rem;
            border-radius: 4px;
            display: inline-block;
            margin-top: 0.25rem;
        }
        
        .file-type {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* File Type Icons */
        .file-icon {
            width: 16px;
            height: 16px;
            margin-right: 0.5rem;
            opacity: 0.8;
        }
        
        .file-icon.encrypted {
            background: linear-gradient(45deg, #f6ad55, #ed8936);
            border-radius: 3px;
            position: relative;
        }
        
        .file-icon.encrypted::after {
            content: '🔒';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 8px;
        }
        
        .file-icon.decrypted {
            background: linear-gradient(45deg, #ed64a6, #d53f8c);
            border-radius: 3px;
            position: relative;
        }
        
        .file-icon.decrypted::after {
            content: '🔓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 8px;
        }
        
        .file-icon.analyzed {
            background: linear-gradient(45deg, #9f7aea, #805ad5);
            border-radius: 3px;
            position: relative;
        }
        
        .file-icon.analyzed::after {
            content: '🔍';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 8px;
        }
        
        .file-icon.scanned {
            background: linear-gradient(45deg, #f56565, #e53e3e);
            border-radius: 3px;
            position: relative;
        }
        
        .file-icon.scanned::after {
            content: '🛡️';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 8px;
        }
        
        .file-icon.default {
            background: linear-gradient(45deg, #4a5568, #2d3748);
            border-radius: 3px;
            position: relative;
        }
        
        .file-icon.default::after {
            content: '📄';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 8px;
        }
        
        /* Enhanced file list container */
        .file-list {
            max-height: 300px;
            overflow-y: auto;
            padding: 0.5rem;
            background: rgba(26, 32, 44, 0.3);
            border-radius: 8px;
            border: 1px solid rgba(74, 85, 104, 0.3);
        }
        
        .file-list::-webkit-scrollbar {
            width: 6px;
        }
        
        .file-list::-webkit-scrollbar-track {
            background: rgba(26, 32, 44, 0.5);
            border-radius: 3px;
        }
        
        .file-list::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #68d391, #48bb78);
            border-radius: 3px;
        }
        
        .file-list::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #48bb78, #38a169);
        }
        
        .file-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .file-actions button {
            padding: 0.25rem 0.5rem;
            font-size: 0.8rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .btn-select {
            background: #68d391;
            color: #1a202c;
        }
        
        .btn-select:hover {
            background: #5cb885;
        }
        
        .btn-delete {
            background: #e53e3e;
            color: white;
        }
        
        .btn-delete:hover {
            background: #c53030;
        }
        
        /* Enhanced File Action Buttons */
        .file-actions {
            display: flex;
            gap: 0.25rem;
            flex-wrap: wrap;
        }
        
        .file-actions button {
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            color: white;
            font-weight: 500;
            min-width: 60px;
        }
        
        .file-actions button:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        /* Modal Styles */
        .modal {
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: linear-gradient(145deg, #1a202c 0%, #2d3748 100%);
            border: 1px solid #4a5568;
            border-radius: 12px;
            padding: 0;
            max-width: 80%;
            max-height: 80%;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        
        .modal-header {
            background: linear-gradient(90deg, #2d3748 0%, #4a5568 100%);
            padding: 1rem;
            border-bottom: 1px solid #4a5568;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h3 {
            color: #68d391;
            margin: 0;
        }
        
        .close {
            color: #a0aec0;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.2s;
        }
        
        .close:hover {
            color: #f56565;
        }
        
        .modal-body {
            padding: 1.5rem;
            max-height: 60vh;
            overflow-y: auto;
        }
        
        .file-info {
            margin-bottom: 1rem;
            padding: 1rem;
            background: #2d3748;
            border-radius: 8px;
            border: 1px solid #4a5568;
        }
        
        .file-info p {
            margin: 0.5rem 0;
            color: #e2e8f0;
        }
        
        .file-content {
            margin-top: 1rem;
        }
        
        .file-content h4 {
            color: #68d391;
            margin-bottom: 0.5rem;
        }
        
        /* Save System Styles */
        .save-section {
            background: #1a202c;
            border: 1px solid #4a5568;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }
        
        .save-options {
            display: flex;
            gap: 1rem;
            margin-top: 0.5rem;
        }
        
        .save-options label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: #a0aec0;
            cursor: pointer;
        }
        
        .save-options input[type="checkbox"] {
            accent-color: #68d391;
        }
        
        .download-link {
            display: inline-block;
            padding: 0.5rem 1rem;
            background: #68d391;
            color: #1a202c;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 600;
            margin-top: 0.5rem;
            transition: background 0.2s;
        }
        
        .download-link:hover {
            background: #5cb885;
        }
        
        /* CLI Styles */
        .cli-container {
            background: #0c0f1a;
            border: 1px solid #2d3748;
            border-radius: 8px;
            padding: 1rem;
            font-family: 'Courier New', monospace;
            min-height: 400px;
        }
        
        .cli-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #2d3748;
        }
        
        .cli-prompt {
            color: #68d391;
            font-weight: bold;
        }
        
        .cli-controls {
            display: flex;
            gap: 0.5rem;
        }
        
        .cli-btn {
            padding: 0.25rem 0.5rem;
            background: #2d3748;
            color: #e6e9ef;
            border: 1px solid #4a5568;
            border-radius: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .cli-btn:hover {
            background: #4a5568;
        }
        
        .cli-output {
            background: #0c0f1a;
            border: 1px solid #2d3748;
            border-radius: 4px;
            padding: 1rem;
            min-height: 250px;
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 1rem;
        }
        
        .cli-line {
            margin-bottom: 0.5rem;
            display: flex;
            align-items: flex-start;
        }
        
        .cli-text {
            color: #e6e9ef;
            margin-left: 0.5rem;
            white-space: pre-wrap;
        }
        
        .cli-input-container {
            display: flex;
            gap: 0.5rem;
        }
        
        .cli-input {
            flex: 1;
            background: #1a202c;
            border: 1px solid #4a5568;
            border-radius: 4px;
            padding: 0.5rem;
            color: #e6e9ef;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }
        
        .cli-input:focus {
            outline: none;
            border-color: #68d391;
        }
        
        .cli-execute {
            background: #68d391;
            color: #1a202c;
            border: none;
            border-radius: 4px;
            padding: 0.5rem 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .cli-execute:hover {
            background: #5cb885;
        }
        
        .quick-commands {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }
        
        .command-group {
            background: #1a202c;
            border: 1px solid #4a5568;
            border-radius: 8px;
            padding: 1rem;
        }
        
        .command-group h4 {
            color: #68d391;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        
        .quick-cmd {
            display: block;
            width: 100%;
            margin-bottom: 0.5rem;
            padding: 0.5rem;
            background: #2d3748;
            color: #e6e9ef;
            border: 1px solid #4a5568;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
            font-size: 0.8rem;
        }
        
        .quick-cmd:hover {
            background: #4a5568;
        }
        
        .cli-history {
            background: #1a202c;
            border: 1px solid #4a5568;
            border-radius: 8px;
            padding: 1rem;
            max-height: 200px;
            overflow-y: auto;
            margin-bottom: 1rem;
        }
        
        .custom-commands {
            margin-top: 1rem;
        }
        
        .add-command-form {
            background: #1a202c;
            border: 1px solid #4a5568;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .add-command-form .form-group {
            margin-bottom: 0.75rem;
        }
        
        .add-command-form label {
            display: block;
            margin-bottom: 0.25rem;
            color: #cbd5e0;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .add-command-form input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #4a5568;
            border-radius: 6px;
            background: #2d3748;
            color: #e6e9ef;
            font-size: 0.85rem;
        }
        
        .add-command-form input:focus {
            outline: none;
            border-color: #68d391;
            box-shadow: 0 0 0 2px rgba(104, 211, 145, 0.1);
        }
        
        .add-cmd-btn {
            background: linear-gradient(135deg, #68d391 0%, #48bb78 100%);
            border: none;
            color: #1a202c;
            font-weight: 600;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }
        
        .add-cmd-btn:hover {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            transform: translateY(-1px);
        }
        
        .custom-commands-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .custom-command-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #1a202c;
            border: 1px solid #4a5568;
            border-radius: 6px;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            transition: all 0.2s;
        }
        
        .custom-command-item:hover {
            background: #2d3748;
            border-color: #68d391;
        }
        
        .custom-command-info {
            flex: 1;
        }
        
        .custom-command-name {
            color: #68d391;
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
        }
        
        .custom-command-text {
            color: #a0aec0;
            font-size: 0.8rem;
            font-family: monospace;
        }
        
        .custom-command-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .custom-command-btn {
            padding: 0.25rem 0.5rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .custom-command-execute {
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            color: white;
        }
        
        .custom-command-execute:hover {
            background: linear-gradient(135deg, #3182ce 0%, #2c5282 100%);
        }
        
        .custom-command-delete {
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
            color: white;
        }
        
        .custom-command-delete:hover {
            background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
        }
        
        .history-item {
            display: flex;
            gap: 1rem;
            margin-bottom: 0.5rem;
            padding: 0.25rem;
            border-bottom: 1px solid #2d3748;
        }
        
        .history-time {
            color: #a0aec0;
            font-size: 0.8rem;
            min-width: 120px;
        }
        
        .history-command {
            color: #68d391;
            font-weight: bold;
            min-width: 100px;
        }
        
        .history-result {
            color: #e6e9ef;
            flex: 1;
        }
        
        .history-controls {
            display: flex;
            gap: 0.5rem;
        }
        
        .history-btn {
            padding: 0.5rem 1rem;
            background: #2d3748;
            color: #e6e9ef;
            border: 1px solid #4a5568;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .history-btn:hover {
            background: #4a5568;
        }
        
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal-content {
            background: linear-gradient(145deg, #1a202c 0%, #2d3748 100%);
            border: 1px solid #4a5568;
            border-radius: 12px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        .modal-content h3 {
            color: #68d391;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        
        .modal-content p {
            color: #cbd5e0;
            margin-bottom: 1.5rem;
        }
        
        .modal-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .modal-actions button {
            flex: 1;
            margin: 0;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #68d391 0%, #48bb78 100%);
            color: #1a202c;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
            color: #e6e9ef;
        }
        
        /* Connection Status Styles */
        .status.connected {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .status.error {
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .status.warning {
            background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        /* OpenSSL Toggle Switch Styles */
        .toggle-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #4a5568;
            transition: .4s;
            border-radius: 34px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: #68d391;
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        
        .status-text {
            font-size: 0.9rem;
            font-weight: 500;
            color: #e6e9ef;
        }
        
        .algorithm-info {
            background: rgba(104, 211, 145, 0.1);
            border: 1px solid rgba(104, 211, 145, 0.3);
            border-radius: 6px;
            padding: 0.75rem;
            margin-top: 0.5rem;
            font-size: 0.85rem;
        }
        
        .algorithm-info.openssl {
            background: rgba(104, 211, 145, 0.1);
            border-color: rgba(104, 211, 145, 0.3);
        }
        
        .algorithm-info.custom {
            background: rgba(237, 137, 54, 0.1);
            border-color: rgba(237, 137, 54, 0.3);
        }
        
        /* Slider Styles */
        .slider-container {
            position: relative;
            margin: 1rem 0;
        }
        
        .slider {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #4a5568;
            outline: none;
            opacity: 0.7;
            transition: opacity .2s;
        }
        
        .slider:hover {
            opacity: 1;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #68d391;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
        
        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #68d391;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
        
        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 0.5rem;
            font-size: 0.8rem;
            color: #a0aec0;
        }
        
        .slider-value {
            position: absolute;
            top: -2rem;
            right: 0;
            background: rgba(104, 211, 145, 0.2);
            color: #68d391;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        /* Checkbox Grid Styles */
        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.75rem;
            margin-top: 0.5rem;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 6px;
            transition: background-color 0.2s;
        }
        
        .checkbox-item:hover {
            background: rgba(104, 211, 145, 0.1);
        }
        
        .checkbox-item input[type="checkbox"] {
            display: none;
        }
        
        .checkmark {
            width: 20px;
            height: 20px;
            border: 2px solid #4a5568;
            border-radius: 4px;
            margin-right: 0.75rem;
            position: relative;
            transition: all 0.2s;
        }
        
        .checkbox-item input[type="checkbox"]:checked + .checkmark {
            background: #68d391;
            border-color: #68d391;
        }
        
        .checkbox-item input[type="checkbox"]:checked + .checkmark::after {
            content: '';
            position: absolute;
            left: 6px;
            top: 2px;
            width: 6px;
            height: 10px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }
        
        /* Platform Selector Styles */
        .platform-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        /* Scan Type Selector Styles */
        .scan-type-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .scan-option {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 0.5rem;
            border: 2px solid #4a5568;
            border-radius: 6px;
            transition: all 0.2s;
            text-align: center;
        }
        
        .scan-option:hover {
            border-color: #68d391;
            background: rgba(104, 211, 145, 0.1);
        }
        
        .scan-option input[type="radio"] {
            display: none;
        }
        
        .scan-option input[type="radio"]:checked + .scan-label {
            color: #68d391;
            font-weight: 600;
        }
        
        .scan-option:has(input[type="radio"]:checked) {
            border-color: #68d391;
            background: rgba(104, 211, 145, 0.2);
        }
        
        .scan-label {
            width: 100%;
            font-size: 0.85rem;
            transition: all 0.2s;
        }
        
        .platform-option {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 0.75rem;
            border: 2px solid #4a5568;
            border-radius: 8px;
            transition: all 0.2s;
            text-align: center;
        }
        
        .platform-option:hover {
            border-color: #68d391;
            background: rgba(104, 211, 145, 0.1);
        }
        
        .platform-option input[type="radio"] {
            display: none;
        }
        
        .platform-option input[type="radio"]:checked + .platform-label {
            color: #68d391;
            font-weight: 600;
        }
        
        .platform-option:has(input[type="radio"]:checked) {
            border-color: #68d391;
            background: rgba(104, 211, 145, 0.2);
        }
        
        .platform-label {
            width: 100%;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        
        /* Enhanced Form Controls */
        .form-group select {
            background: #2d3748;
            border: 1px solid #4a5568;
            color: #e6e9ef;
            padding: 0.5rem;
            border-radius: 6px;
            font-size: 0.9rem;
        }
        
        .form-group select:focus {
            outline: none;
            border-color: #68d391;
            box-shadow: 0 0 0 2px rgba(104, 211, 145, 0.2);
        }
        
        .form-group select option {
            background: #2d3748;
            color: #e6e9ef;
        }
        
        /* Interactive Button Enhancements */
        button {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.3s, height 0.3s;
        }
        
        button:hover::before {
            width: 300px;
            height: 300px;
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        /* Status Indicators */
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .status-indicator.enabled {
            background: rgba(104, 211, 145, 0.2);
            color: #68d391;
        }
        
        .status-indicator.disabled {
            background: rgba(237, 137, 54, 0.2);
            color: #ed8936;
        }
        
        .status-indicator::before {
            content: '';
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: currentColor;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .checkbox-grid {
                grid-template-columns: 1fr;
            }
            
            .platform-selector {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .slider-labels {
                font-size: 0.7rem;
            }
        }

        /* OpenSSL Management Styles */
        .status-info, .test-results, .performance-info, .report-info {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }

        .status-info h4, .test-results h4, .performance-info h4, .report-info h4 {
            color: #495057;
            margin-top: 0;
            margin-bottom: 15px;
            border-bottom: 2px solid #007bff;
            padding-bottom: 5px;
        }

        .status-info p, .performance-info p, .report-info p {
            margin: 8px 0;
            color: #6c757d;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        .results-table th, .results-table td {
            border: 1px solid #dee2e6;
            padding: 8px 12px;
            text-align: left;
        }

        .results-table th {
            background-color: #e9ecef;
            font-weight: 600;
            color: #495057;
        }

        .results-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .results-table tr:hover {
            background-color: #e3f2fd;
        }

        .performance-info ul, .report-info ol {
            margin: 10px 0;
            padding-left: 20px;
        }

        .performance-info li, .report-info li {
            margin: 5px 0;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>RawrZ Security Platform</h1>
        <div class="subtitle">Advanced Security Tools & Analysis Suite - 102+ Features</div>
    </div>

    <div class="container">
        <!-- Authentication Section -->
        <div class="auth-section">
            <h3>Authentication</h3>
            <div class="row">
                <input type="password" id="authToken" placeholder="Enter auth token (optional)" />
                <button onclick="saveToken(this)">Save Token</button>
                <button onclick="checkHealth(this)">Test Connection</button>
                <button onclick="testJavaScript()">Test JavaScript</button>
                <button onclick="testAllHandlers()">Test All Handlers</button>
                <button onclick="testAllCheckboxes()">Test Checkboxes</button>
            </div>
            <div id="connectionStatus"></div>
        </div>

        <!-- File Upload System -->
        <div class="file-upload-section">
            <h3>File Upload & Management</h3>
            <div class="upload-zone" id="uploadZone">
                <div class="upload-content">
                    <div class="upload-icon">[INFO]</div>
                    <h4>Drag & Drop Files Here</h4>
                    <p>Or click to browse files</p>
                    <input type="file" id="fileInput" multiple style="display: none;" />
                    <button onclick="browseFiles(this)">Browse Files</button>
                </div>
            </div>
            
            <div class="url-upload-section">
                <h4>Upload from URL</h4>
                <div class="row">
                    <input type="url" id="urlInput" placeholder="Enter file URL (http/https)" style="flex: 1;" />
                    <button onclick="uploadFromUrl(this)">Download & Upload</button>
                </div>
            </div>
            
            <div class="uploaded-files">
                <h4>Uploaded Files</h4>
                <div class="file-list" id="fileList"></div>
            </div>
            
            <div class="save-section">
                <h4>Save Results</h4>
                <div class="row">
                    <input type="text" id="saveFileName" placeholder="Enter filename (without extension)" style="flex: 1;" />
                    <select id="saveFileType">
                        <option value="txt">Text File (.txt)</option>
                        <option value="json">JSON File (.json)</option>
                        <option value="enc">Encrypted File (.enc)</option>
                        <option value="exe">Executable (.exe)</option>
                        <option value="bin">Binary File (.bin)</option>
                        <option value="log">Log File (.log)</option>
                        <option value="csv">CSV File (.csv)</option>
                        <option value="xml">XML File (.xml)</option>
                    </select>
                    <button onclick="saveCurrentResult(this)">Save Result</button>
                </div>
                <div class="save-options">
                    <label><input type="checkbox" id="includeTimestamp" checked> Include timestamp</label>
                    <label><input type="checkbox" id="includeMetadata" checked> Include metadata</label>
                </div>
            </div>
        </div>

        <!-- Main Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="showTab('crypto', this)">Cryptography</button>
            <button class="tab" onclick="showTab('stub', this)">Stub Generation</button>
            <button class="tab" onclick="showTab('network', this)">Network Tools</button>
            <button class="tab" onclick="showTab('system', this)">System Info</button>
            <button class="tab" onclick="showTab('files', this)">File Operations</button>
            <button class="tab" onclick="showTab('analysis', this)">Analysis Tools</button>
            <button class="tab" onclick="showTab('utilities', this)">Utilities</button>
            <button class="tab" onclick="showTab('advanced', this)">Advanced Features</button>
            <button class="tab" onclick="showTab('openssl', this)">OpenSSL Management</button>
            <button class="tab" onclick="showTab('irc-bot', this)">IRC Bot Builder</button>
            <button class="tab" onclick="showTab('http-bot', this)">HTTP Bot Panel</button>
            <button class="tab" onclick="showTab('bot-manager', this)">Bot Manager</button>
            <button class="tab" onclick="showTab('payload-manager', this)">Payload Manager</button>
            <button class="tab" onclick="showTab('anti-analysis', this)">Anti-Analysis</button>
            <button class="tab" onclick="showTab('stealth', this)">Stealth Engine</button>
            <button class="tab" onclick="showTab('fud', this)">FUD Engine</button>
            <button class="tab" onclick="showTab('forensics', this)">Digital Forensics</button>
            <button class="tab" onclick="showTab('reverse', this)">Reverse Engineering</button>
            <button class="tab" onclick="showTab('hot-patch', this)">Hot Patchers</button>
            <button class="tab" onclick="showTab('native-compile', this)">Native Compiler</button>
            <button class="tab" onclick="showTab('red-killer', this)">Red Killer</button>
            <button class="tab" onclick="showTab('red-shells', this)">Red Shells</button>
            <button class="tab" onclick="showTab('beaconism', this)">Beaconism DLL</button>
            <button class="tab" onclick="showTab('mutex', this)">Mutex Engine</button>
            <button class="tab" onclick="showTab('polymorphic', this)">Polymorphic Engine</button>
            <button class="tab" onclick="showTab('compression', this)">Compression Engine</button>
            <button class="tab" onclick="showTab('mobile', this)">Mobile Tools</button>
            <button class="tab" onclick="showTab('backup', this)">Backup System</button>
            <button class="tab" onclick="showTab('implementation', this)">Implementation Checker</button>
            <button class="tab" onclick="showTab('cli', this)">Embedded CLI</button>
        </div>

        <!-- Cryptography Tab -->
        <div id="crypto" class="tab-content active">
            <div class="grid">
                <!-- Encryption -->
                <div class="card">
                    <h3>Encryption</h3>
                    It seems there might be an issue with the stub generation. Let me test the anti-analysis feature:                    
                    <!-- OpenSSL Toggle Controls -->
                    <div class="form-group">
                        <label>OpenSSL Mode</label>
                        <div class="toggle-container">
                            <label class="toggle-switch">
                                <input type="checkbox" id="opensslToggle" checked>
                                <span class="toggle-slider"></span>
                            </label>
                            <span id="opensslStatus" class="status-text">OpenSSL Mode: Enabled</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Custom Algorithms</label>
                        <div class="toggle-container">
                            <label class="toggle-switch">
                                <input type="checkbox" id="customAlgorithmsToggle">
                                <span class="toggle-slider"></span>
                            </label>
                            <span id="customAlgorithmsStatus" class="status-text">Custom Algorithms: Disabled</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Algorithm Filter</label>
                        <select id="algorithmFilter">
                            <option value="all">All Algorithms</option>
                            <option value="openssl">OpenSSL Only</option>
                            <option value="custom">Custom Only</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Algorithm</label>
                        <select id="encAlgo">
                            <option value="aes256">AES-256-GCM</option>
                            <option value="aes192">AES-192-GCM</option>
                            <option value="aes128">AES-128-GCM</option>
                            <option value="aes256cbc">AES-256-CBC</option>
                            <option value="aes192cbc">AES-192-CBC</option>
                            <option value="aes128cbc">AES-128-CBC</option>
                            <option value="chacha20">ChaCha20</option>
                            <option value="blowfish">Blowfish</option>
                            <option value="cam">CAM</option>
                            <option value="cam-256-cbc">CAM-256-CBC</option>
                            <option value="cam-192-cbc">CAM-192-CBC</option>
                            <option value="cam-128-cbc">CAM-128-CBC</option>
                            <option value="cam-256-ctr">CAM-256-CTR</option>
                            <option value="cam-192-ctr">CAM-192-CTR</option>
                            <option value="cam-128-ctr">CAM-128-CTR</option>
                            <option value="cam-256-gcm">CAM-256-GCM</option>
                            <option value="cam-192-gcm">CAM-192-GCM</option>
                            <option value="cam-128-gcm">CAM-128-GCM</option>
                            <option value="aria-256-gcm">ARIA-256-GCM</option>
                            <option value="aria-192-gcm">ARIA-192-GCM</option>
                            <option value="aria-128-gcm">ARIA-128-GCM</option>
                            <option value="rsa-4096">RSA-4096</option>
                            <option value="triple">Triple DES</option>
                            <option value="hybrid">Hybrid Encryption</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Input (text or file:filename)</label>
                        <textarea id="encInput" rows="3" placeholder="Enter text to encrypt or file:filename"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Output Extension</label>
                        <select id="encExtension">
                            <option value=".enc">.enc (JSON)</option>
                            <option value=".exe">.exe (Executable)</option>
                            <option value=".dll">.dll (Library)</option>
                            <option value=".ps1">.ps1 (PowerShell)</option>
                            <option value=".bat">.bat (Batch)</option>
                            <option value=".js">.js (JavaScript)</option>
                        </select>
                    </div>
                    <button onclick="runEncrypt(this)">Encrypt</button>
                </div>

                <!-- Decryption -->
                <div class="card">
                    <h3>Decryption</h3>
                    <div class="form-group">
                        <label>Algorithm</label>
                        <select id="decAlgo">
                            <option value="aes256">AES-256-GCM</option>
                            <option value="aes192">AES-192-GCM</option>
                            <option value="aes128">AES-128-GCM</option>
                            <option value="aes256cbc">AES-256-CBC</option>
                            <option value="aes192cbc">AES-192-CBC</option>
                            <option value="aes128cbc">AES-128-CBC</option>
                            <option value="chacha20">ChaCha20</option>
                            <option value="blowfish">Blowfish</option>
                            <option value="cam">CAM</option>
                            <option value="cam-256-cbc">CAM-256-CBC</option>
                            <option value="cam-192-cbc">CAM-192-CBC</option>
                            <option value="cam-128-cbc">CAM-128-CBC</option>
                            <option value="cam-256-ctr">CAM-256-CTR</option>
                            <option value="cam-192-ctr">CAM-192-CTR</option>
                            <option value="cam-128-ctr">CAM-128-CTR</option>
                            <option value="cam-256-gcm">CAM-256-GCM</option>
                            <option value="cam-192-gcm">CAM-192-GCM</option>
                            <option value="cam-128-gcm">CAM-128-GCM</option>
                            <option value="aria-256-gcm">ARIA-256-GCM</option>
                            <option value="aria-192-gcm">ARIA-192-GCM</option>
                            <option value="aria-128-gcm">ARIA-128-GCM</option>
                            <option value="rsa-4096">RSA-4096</option>
                            <option value="triple">Triple DES</option>
                            <option value="hybrid">Hybrid Encryption</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Encrypted Data</label>
                        <textarea id="decInput" rows="3" placeholder="Enter encrypted data or file:filename"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Key (optional - auto from metadata)</label>
                        <input type="text" id="decKey" placeholder="Base64 key" />
                    </div>
                    <div class="form-group">
                        <label>IV (optional - auto from metadata)</label>
                        <input type="text" id="decIv" placeholder="Base64 IV" />
                    </div>
                    <button onclick="runDecrypt(this)">Decrypt</button>
                </div>

                <!-- Key Generation -->
                <div class="card">
                    <h3>Key Generation</h3>
                    <div class="form-group">
                        <label>Algorithm</label>
                        <select id="keyAlgo">
                            <option value="aes256">AES-256</option>
                            <option value="aes192">AES-192</option>
                            <option value="aes128">AES-128</option>
                            <option value="rsa">RSA-4096</option>
                            <option value="cam">CAM</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Key Length (bits)</label>
                        <input type="number" id="keyLength" value="256" min="128" max="4096" />
                    </div>
                    <div class="row">
                        <button onclick="runKeygen(this)">Generate Key</button>
                        <button onclick="runRandom(this)">Random Bytes</button>
                    </div>
                </div>

                <!-- Hashing -->
                <div class="card">
                    <h3>Hashing</h3>
                    <div class="form-group">
                        <label>Algorithm</label>
                        <select id="hashAlgo">
                            <option value="sha256">SHA-256</option>
                            <option value="sha512">SHA-512</option>
                            <option value="sha1">SHA-1</option>
                            <option value="md5">MD5</option>
                            <option value="blake2b">BLAKE2b</option>
                            <option value="blake2s">BLAKE2s</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Input</label>
                        <textarea id="hashInput" rows="3" placeholder="Enter text to hash"></textarea>
                    </div>
                    <div class="row">
                        <button onclick="runHash(this)">Hash</button>
                        <button onclick="runUUID(this)">Generate UUID</button>
                        <button onclick="runPassword(this)">Generate Password</button>
                    </div>
                </div>

                <!-- Encoding/Decoding -->
                <div class="card">
                    <h3>Encoding & Decoding</h3>
                    <div class="form-group">
                        <label>Input</label>
                        <textarea id="encodeInput" rows="3" placeholder="Enter text to encode/decode"></textarea>
                    </div>
                    <div class="row">
                        <button onclick="runBase64Encode(this)">Base64 Encode</button>
                        <button onclick="runBase64Decode(this)">Base64 Decode</button>
                    </div>
                    <div class="row">
                        <button onclick="runHexEncode(this)">Hex Encode</button>
                        <button onclick="runHexDecode(this)">Hex Decode</button>
                    </div>
                    <div class="row">
                        <button onclick="runUrlEncode(this)">URL Encode</button>
                        <button onclick="runUrlDecode(this)">URL Decode</button>
                    </div>
                </div>

                <!-- Digital Signatures -->
                <div class="card">
                    <h3>Digital Signatures</h3>
                    <div class="form-group">
                        <label>Input to Sign</label>
                        <textarea id="signInput" rows="2" placeholder="Enter data to sign"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Private Key (optional)</label>
                        <textarea id="signPrivateKey" rows="2" placeholder="PEM private key"></textarea>
                    </div>
                    <div class="row">
                        <button onclick="runSign(this)">Sign Data</button>
                        <button onclick="runVerify(this)">Verify Signature</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stub Generation Tab -->
        <div id="stub" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h3>Stub Generation</h3>
                    <div class="form-group">
                        <label>Target File</label>
                        <input type="text" id="stubTarget" placeholder="file:filename or /path/to/file" />
                    </div>
                    <div class="form-group">
                        <label>Stub Type</label>
                        <select id="stubType">
                            <option value="native">Native (C++/Assembly)</option>
                            <option value="dotnet">.NET (C#)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Framework</label>
                        <select id="stubFramework">
                            <option value="cpp">C++</option>
                            <option value="asm">Assembly</option>
                            <option value="powershell">PowerShell</option>
                            <option value="python">Python</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Encryption</label>
                        <select id="stubEncryption">
                            <option value="aes256">AES-256-GCM</option>
                            <option value="aes192">AES-192-GCM</option>
                            <option value="aes128">AES-128-GCM</option>
                            <option value="aes256cbc">AES-256-CBC</option>
                            <option value="aes192cbc">AES-192-CBC</option>
                            <option value="aes128cbc">AES-128-CBC</option>
                            <option value="chacha20">ChaCha20</option>
                            <option value="blowfish">Blowfish</option>
                            <option value="cam">CAM</option>
                            <option value="cam-256-cbc">CAM-256-CBC</option>
                            <option value="cam-192-cbc">CAM-192-CBC</option>
                            <option value="cam-128-cbc">CAM-128-CBC</option>
                            <option value="cam-256-ctr">CAM-256-CTR</option>
                            <option value="cam-192-ctr">CAM-192-CTR</option>
                            <option value="cam-128-ctr">CAM-128-CTR</option>
                            <option value="cam-256-gcm">CAM-256-GCM</option>
                            <option value="cam-192-gcm">CAM-192-GCM</option>
                            <option value="cam-128-gcm">CAM-128-GCM</option>
                            <option value="aria-256-gcm">ARIA-256-GCM</option>
                            <option value="aria-192-gcm">ARIA-192-GCM</option>
                            <option value="aria-128-gcm">ARIA-128-GCM</option>
                            <option value="rsa-4096">RSA-4096</option>
                            <option value="triple">Triple DES</option>
                            <option value="hybrid">Hybrid Encryption</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Output Options</label>
                        <div class="row">
                            <input type="text" id="stubOutput" placeholder="output.exe (optional)" />
                            <input type="text" id="stubAttach" placeholder="attach:target.exe (optional)" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Anti-Analysis</label>
                        <div class="row">
                            <label><input type="checkbox" id="stubAntiDebug" checked /> Anti-Debug</label>
                            <label><input type="checkbox" id="stubAntiVM" checked /> Anti-VM</label>
                            <label><input type="checkbox" id="stubAntiSandbox" checked /> Anti-Sandbox</label>
                        </div>
                    </div>
                    <button onclick="runStub(this)">Generate Stub</button>
                </div>

                <div class="card">
                    <h3>Advanced Stub Options</h3>
                    <div class="form-group">
                        <label>Polymorphic Engine</label>
                        <select id="stubPolymorphic">
                            <option value="none">None</option>
                            <option value="basic">Basic</option>
                            <option value="advanced">Advanced</option>
                            <option value="extreme">Extreme</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Stealth Level</label>
                        <select id="stubStealth">
                            <option value="low">Low</option>
                            <option value="medium">Medium</option>
                            <option value="high">High</option>
                            <option value="maximum">Maximum</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Compression</label>
                        <select id="stubCompression">
                            <option value="none">None</option>
                            <option value="gzip">GZIP</option>
                            <option value="brotli">Brotli</option>
                            <option value="lz4">LZ4</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Additional Features</label>
                        <div class="row">
                            <label><input type="checkbox" id="stubHotPatch" /> Hot Patching</label>
                            <label><input type="checkbox" id="stubMemoryProtect" /> Memory Protection</label>
                        </div>
                        <div class="row">
                            <label><input type="checkbox" id="stubObfuscation" /> Code Obfuscation</label>
                            <label><input type="checkbox" id="stubPacking" /> Executable Packing</label>
                        </div>
                    </div>
                    <button onclick="runAdvancedStub(this)">Generate Advanced Stub</button>
                </div>
            </div>
        </div>

        <!-- Network Tools Tab -->
        <div id="network" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h3>Network Diagnostics</h3>
                    <div class="form-group">
                        <label>Host/IP Address</label>
                        <input type="text" id="networkHost" placeholder="example.com or 192.168.1.1" />
                    </div>
                    <div class="row">
                        <button onclick="runPing(this)">Ping</button>
                        <button onclick="runDns(this)">DNS Lookup</button>
                        <button onclick="runTraceroute(this)">Traceroute</button>
                        <button onclick="runWhois(this)">WHOIS</button>
                    </div>
                </div>

                <div class="card">
                    <h3>Port Scanning</h3>
                    <div class="form-group">
                        <label>Target Host</label>
                        <input type="text" id="scanHost" placeholder="192.168.1.1" />
                    </div>
                    
                    <!-- Port Range with Sliders -->
                    <div class="form-group">
                        <label>Port Range</label>
                        <div class="slider-container">
                            <input type="range" id="scanStartPortSlider" min="1" max="65535" value="1" class="slider">
                            <div class="slider-labels">
                                <span>1</span>
                                <span>16384</span>
                                <span>32768</span>
                                <span>49152</span>
                                <span>65535</span>
                    </div>
                            <span id="startPortValue" class="slider-value">1</span>
                        </div>
                        <div class="slider-container">
                            <input type="range" id="scanEndPortSlider" min="1" max="65535" value="1000" class="slider">
                            <div class="slider-labels">
                                <span>1</span>
                                <span>16384</span>
                                <span>32768</span>
                                <span>49152</span>
                                <span>65535</span>
                            </div>
                            <span id="endPortValue" class="slider-value">1000</span>
                        </div>
                    </div>
                    
                    <!-- Scan Type with Radio Buttons -->
                    <div class="form-group">
                        <label>Scan Type</label>
                        <div class="scan-type-selector">
                            <label class="scan-option">
                                <input type="radio" name="scanType" value="tcp" checked>
                                <span class="scan-label">TCP</span>
                            </label>
                            <label class="scan-option">
                                <input type="radio" name="scanType" value="udp">
                                <span class="scan-label">UDP</span>
                            </label>
                            <label class="scan-option">
                                <input type="radio" name="scanType" value="syn">
                                <span class="scan-label">SYN</span>
                            </label>
                            <label class="scan-option">
                                <input type="radio" name="scanType" value="ack">
                                <span class="scan-label">ACK</span>
                            </label>
                    </div>
                    </div>
                    
                    <!-- Scan Options with Checkboxes -->
                    <div class="form-group">
                        <label>Scan Options</label>
                        <div class="checkbox-grid">
                            <label class="checkbox-item">
                                <input type="checkbox" id="scanVerbose" />
                                <span class="checkmark"></span>
                                Verbose Output
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" id="scanStealth" />
                                <span class="checkmark"></span>
                                Stealth Mode
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" id="scanServiceDetection" />
                                <span class="checkmark"></span>
                                Service Detection
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" id="scanOSDetection" />
                                <span class="checkmark"></span>
                                OS Detection
                            </label>
                        </div>
                    </div>
                    
                    <!-- Scan Speed with Slider -->
                    <div class="form-group">
                        <label>Scan Speed</label>
                        <div class="slider-container">
                            <input type="range" id="scanSpeedSlider" min="1" max="5" value="3" class="slider">
                            <div class="slider-labels">
                                <span>Slow</span>
                                <span>Normal</span>
                                <span>Fast</span>
                                <span>Aggressive</span>
                                <span>Insane</span>
                            </div>
                            <span id="scanSpeedValue" class="slider-value">Fast</span>
                        </div>
                    </div>
                    
                    <button onclick="runPortScan(this)">Scan Ports</button>
                </div>

                <div class="card">
                    <h3>Network Analysis</h3>
                    <div class="form-group">
                        <label>Target</label>
                        <input type="text" id="networkTarget" placeholder="IP, domain, or network range" />
                    </div>
                    <div class="row">
                        <button onclick="runNetworkScan(this)">Network Scan</button>
                        <button onclick="runServiceDetection(this)">Service Detection</button>
                        <button onclick="runVulnerabilityScan(this)">Vulnerability Scan</button>
                    </div>
                </div>

                <div class="card">
                    <h3>Traffic Analysis</h3>
                    <div class="form-group">
                        <label>Interface</label>
                        <select id="networkInterface">
                            <option value="any">Any Interface</option>
                            <option value="eth0">Ethernet 0</option>
                            <option value="wlan0">Wireless 0</option>
                        </select>
                    </div>
                    <div class="row">
                        <button onclick="runPacketCapture(this)">Packet Capture</button>
                        <button onclick="runTrafficAnalysis(this)">Traffic Analysis</button>
                        <button onclick="runProtocolAnalysis(this)">Protocol Analysis</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- System Info Tab -->
        <div id="system" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h3>System Information</h3>
                    <div class="row">
                        <button onclick="runSysInfo(this)">Get System Info</button>
                        <button onclick="runProcesses(this)">List Processes</button>
                        <button onclick="runTime(this)">Get Time</button>
                    </div>
                </div>

                <div class="card">
                    <h3>Memory Management</h3>
                    <div class="row">
                        <button onclick="runMemoryInfo(this)">Memory Info</button>
                        <button onclick="runGarbageCollect(this)">Garbage Collect</button>
                        <button onclick="runMemoryCleanup(this)">Memory Cleanup</button>
                    </div>
                </div>

                <div class="card">
                    <h3>Performance Monitoring</h3>
                    <div class="row">
                        <button onclick="runCpuUsage(this)">CPU Usage</button>
                        <button onclick="runDiskUsage(this)">Disk Usage</button>
                        <button onclick="runNetworkStats(this)">Network Stats</button>
                    </div>
                </div>

                <div class="card">
                    <h3>Security Status</h3>
                    <div class="row">
                        <button onclick="runSecurityScan(this)">Security Scan</button>
                        <button onclick="runThreatDetection(this)">Threat Detection</button>
                        <button onclick="runVulnerabilityCheck(this)">Vulnerability Check</button>
                    </div>
                    <div class="row" style="margin-top: 10px;">
                        <select id="securityScanTarget" style="flex: 1; margin-right: 10px;">
                            <option value="localhost">Local System</option>
                            <option value="uploaded">Uploaded File</option>
                        </select>
                        <select id="securityScanFile" style="flex: 1; margin-right: 10px;" disabled>
                            <option value="">Select uploaded file...</option>
                        </select>
                        <button onclick="refreshSecurityFileList()">Refresh Files</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- File Operations Tab -->
        <div id="files" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h3>File Management</h3>
                    <div class="form-group">
                        <label>File Operations</label>
                        <select id="fileOp">
                            <option value="list">List Files</option>
                            <option value="read">Read File</option>
                            <option value="write">Write File</option>
                            <option value="copy">Copy File</option>
                            <option value="move">Move File</option>
                            <option value="delete">Delete File</option>
                            <option value="upload">Upload File</option>
                            <option value="download">Download File</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Input File</label>
                        <input type="text" id="fileInput" placeholder="filename or path" />
                    </div>
                    <div class="form-group">
                        <label>Output File (for copy/move/write)</label>
                        <input type="text" id="fileOutput" placeholder="output filename" />
                    </div>
                    <div class="form-group">
                        <label>File Content (for write)</label>
                        <textarea id="fileContent" rows="3" placeholder="File content"></textarea>
                    </div>
                    <button onclick="runFileOps(this)">Execute</button>
                    <button onclick="listFiles()">List Uploads</button>
                </div>

                <div class="card">
                    <h3>Uploaded Files</h3>
                    <div id="fileList" class="file-list"></div>
                </div>

                <div class="card">
                    <h3>File Analysis</h3>
                    <div class="form-group">
                        <label>File to Analyze</label>
                        <input type="text" id="fileAnalyze" placeholder="filename or path" />
                    </div>
                    <div class="row">
                        <button onclick="runFileAnalysis(this)">Analyze File</button>
                        <button onclick="runFileHash(this)">Calculate Hash</button>
                        <button onclick="runFileSignature(this)">Check Signature</button>
                    </div>
                </div>

                <div class="card">
                    <h3>Backup & Recovery</h3>
                    <div class="form-group">
                        <label>Backup Source</label>
                        <input type="text" id="backupSource" placeholder="file or directory" />
                    </div>
                    <div class="form-group">
                        <label>Backup Destination</label>
                        <input type="text" id="backupDest" placeholder="backup location" />
                    </div>
                    <div class="row">
                        <button onclick="runBackup(this)">Create Backup</button>
                        <button onclick="runRestore(this)">Restore Backup</button>
                        <button onclick="runBackupList(this)">List Backups</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analysis Tools Tab -->
        <div id="analysis" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h3>File Analysis</h3>
                    <div class="form-group">
                        <label>File to Analyze</label>
                        <input type="text" id="analyzeFile" placeholder="filename or path" />
                    </div>
                    <div class="form-group">
                        <label>Analysis Type</label>
                        <select id="analysisType">
                            <option value="basic">Basic Analysis</option>
                            <option value="deep">Deep Analysis</option>
                            <option value="malware">Malware Analysis</option>
                            <option value="forensic">Forensic Analysis</option>
                        </select>
                    </div>
                    <button onclick="runAnalyze(this)">Analyze File</button>
                </div>

                <div class="card">
                    <h3>Data Validation</h3>
                    <div class="form-group">
                        <label>Input to Validate</label>
                        <input type="text" id="validateInput" placeholder="Enter data to validate" />
                    </div>
                    <div class="form-group">
                        <label>Validation Type</label>
                        <select id="validateType">
                            <option value="email">Email</option>
                            <option value="url">URL</option>
                            <option value="ip">IP Address</option>
                            <option value="json">JSON</option>
                            <option value="uuid">UUID</option>
                            <option value="creditcard">Credit Card</option>
                            <option value="phone">Phone Number</option>
                        </select>
                    </div>
                    <button onclick="runValidate(this)">Validate</button>
                </div>

                <div class="card">
                    <h3>Malware Analysis</h3>
                    <div class="form-group">
                        <label>Sample File</label>
                        <input type="text" id="malwareFile" placeholder="malware sample path" />
                    </div>
                    <div class="row">
                        <button onclick="runMalwareScan(this)">Scan for Malware</button>
                        <button onclick="runBehaviorAnalysis(this)">Behavior Analysis</button>
                        <button onclick="runSignatureCheck(this)">Signature Check</button>
                    </div>
                </div>

                <div class="card">
                    <h3>Digital Forensics</h3>
                    <div class="form-group">
                        <label>Target</label>
                        <input type="text" id="forensicsTarget" placeholder="file, disk, or memory dump" />
                    </div>
                    <div class="row">
                        <button onclick="runForensicsScan(this)">Forensics Scan</button>
                        <button onclick="runDataRecovery(this)">Data Recovery</button>
                        <button onclick="runTimelineAnalysis(this)">Timeline Analysis</button>
                    </div>
                </div>

                <div class="card">
                    <h3>Reverse Engineering</h3>
                    <div class="form-group">
                        <label>Binary File</label>
                        <input type="text" id="reverseFile" placeholder="executable or binary file" />
                    </div>
                    <div class="row">
                        <button onclick="runDisassembly(this)">Disassemble</button>
                        <button onclick="runDecompilation(this)">Decompile</button>
                        <button onclick="runStringExtraction(this)">Extract Strings</button>
                    </div>
                </div>

                <div class="card">
                    <h3>Memory Analysis</h3>
                    <div class="form-group">
                        <label>Memory Dump</label>
                        <input type="text" id="memoryDump" placeholder="memory dump file" />
                    </div>
                    <div class="row">
                        <button onclick="runMemoryAnalysis(this)">Analyze Memory</button>
                        <button onclick="runProcessDump(this)">Process Dump</button>
                        <button onclick="runHeapAnalysis(this)">Heap Analysis</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Utilities Tab -->
        <div id="utilities" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h3>Text Operations</h3>
                    <div class="form-group">
                        <label>Text Input</label>
                        <textarea id="textInput" rows="3" placeholder="Enter text to process"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Operation</label>
                        <select id="textOp">
                            <option value="uppercase">Uppercase</option>
                            <option value="lowercase">Lowercase</option>
                            <option value="reverse">Reverse</option>
                            <option value="wordcount">Word Count</option>
                            <option value="charcount">Character Count</option>
                            <option value="linescount">Line Count</option>
                            <option value="trim">Trim Whitespace</option>
                            <option value="replace">Find & Replace</option>
                        </select>
                    </div>
                    <button onclick="runTextOps(this)">Process Text</button>
                </div>

                <div class="card">
                    <h3>Mathematical Operations</h3>
                    <div class="form-group">
                        <label>Expression</label>
                        <input type="text" id="mathExpression" placeholder="2 + 2 * 3" />
                    </div>
                    <div class="row">
                        <button onclick="runMath(this)">Calculate</button>
                        <button onclick="runRandomMath(this)">Random Math</button>
                    </div>
                </div>

                <div class="card">
                    <h3>CLI Command</h3>
                    <div class="form-group">
                        <label>RawrZ Command</label>
                        <input type="text" id="cliCommand" placeholder="help, encrypt aes256 'hello', etc." />
                    </div>
                    <button onclick="runCLI(this)">Execute CLI</button>
                </div>

                <div class="card">
                    <h3>Data Conversion</h3>
                    <div class="form-group">
                        <label>Input Data</label>
                        <textarea id="convertInput" rows="3" placeholder="Enter data to convert"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Conversion Type</label>
                        <select id="convertType">
                            <option value="json2yaml">JSON to YAML</option>
                            <option value="yaml2json">YAML to JSON</option>
                            <option value="xml2json">XML to JSON</option>
                            <option value="json2xml">JSON to XML</option>
                            <option value="csv2json">CSV to JSON</option>
                            <option value="json2csv">JSON to CSV</option>
                        </select>
                    </div>
                    <button onclick="runDataConversion(this)">Convert</button>
                </div>

                <div class="card">
                    <h3>Compression Tools</h3>
                    <div class="form-group">
                        <label>Input Data</label>
                        <textarea id="compressInput" rows="3" placeholder="Enter data to compress"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Compression Algorithm</label>
                        <select id="compressAlgo">
                            <option value="gzip">GZIP</option>
                            <option value="brotli">Brotli</option>
                            <option value="lz4">LZ4</option>
                            <option value="zstd">Zstandard</option>
                        </select>
                    </div>
                    <div class="row">
                        <button onclick="runCompress(this)">Compress</button>
                        <button onclick="runDecompress(this)">Decompress</button>
                    </div>
                </div>

                <div class="card">
                    <h3>QR Code & Barcode</h3>
                    <div class="form-group">
                        <label>Text to Encode</label>
                        <input type="text" id="qrInput" placeholder="Enter text for QR code" />
                    </div>
                    <div class="row">
                        <button onclick="runQRGenerate(this)">Generate QR Code</button>
                        <button onclick="runBarcodeGenerate(this)">Generate Barcode</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Advanced Features Tab -->
        <div id="advanced" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h3>Advanced Cryptography</h3>
                    <div class="form-group">
                        <label>Input Data</label>
                        <textarea id="advancedCryptoInput" rows="3" placeholder="Enter data for advanced crypto"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Operation</label>
                        <select id="advancedCryptoOp">
                            <option value="encrypt">Encrypt</option>
                            <option value="decrypt">Decrypt</option>
                            <option value="hybrid">Hybrid Encryption</option>
                            <option value="quantum">Quantum-Safe</option>
                        </select>
                    </div>
                    <button onclick="runAdvancedCrypto(this)">Execute</button>
                </div>

                <div class="card">
                    <h3>Stealth Engine</h3>
                    <div class="form-group">
                        <label>Target</label>
                        <input type="text" id="stealthTarget" placeholder="file or process" />
                    </div>
                    <div class="form-group">
                        <label>Stealth Level</label>
                        <select id="stealthLevel">
                            <option value="basic">Basic</option>
                            <option value="advanced">Advanced</option>
                            <option value="maximum">Maximum</option>
                        </select>
                    </div>
                    <div class="row">
                        <button onclick="runStealthMode(this)">Enable Stealth</button>
                        <button onclick="runAntiDetection(this)">Anti-Detection</button>
                    </div>
                </div>

                <div class="card">
                    <h3>Polymorphic Engine</h3>
                    <div class="form-group">
                        <label>Code Input</label>
                        <textarea id="polyInput" rows="3" placeholder="Enter code to polymorph"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Polymorphic Level</label>
                        <select id="polyLevel">
                            <option value="basic">Basic</option>
                            <option value="advanced">Advanced</option>
                            <option value="extreme">Extreme</option>
                        </select>
                    </div>
                    <button onclick="runPolymorphic(this)">Generate Polymorphic Code</button>
                </div>

                <div class="card">
                    <h3>Mutex Engine</h3>
                    <div class="form-group">
                        <label>Language</label>
                        <select id="mutexLanguage">
                            <option value="cpp">C++</option>
                            <option value="csharp">C#</option>
                            <option value="python">Python</option>
                            <option value="javascript">JavaScript</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Mutex Pattern</label>
                        <select id="mutexPattern">
                            <option value="standard">Standard</option>
                            <option value="stealth">Stealth</option>
                            <option value="random">Random</option>
                            <option value="anti-analysis">Anti-Analysis</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-item">
                            <input type="checkbox" id="mutexStealth" />
                            <span class="checkmark"></span>
                            Stealth Mode
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" id="mutexAntiAnalysis" />
                            <span class="checkmark"></span>
                            Anti-Analysis
                        </label>
                    </div>
                    <button onclick="generateMutex(this)">Generate Mutex Code</button>
                </div>

                <div class="card">
                    <h3>UPX Packing</h3>
                    <div class="form-group">
                        <label>Executable Path</label>
                        <input type="text" id="upxExecutablePath" placeholder="C:\path\to\executable.exe" />
                    </div>
                    <div class="form-group">
                        <label>Packing Method</label>
                        <select id="upxMethod">
                            <option value="upx">UPX</option>
                            <option value="mpress">MPRESS</option>
                            <option value="aspack">ASPACK</option>
                            <option value="fsg">FSG</option>
                            <option value="pecompact">PECompact</option>
                        </select>
                    </div>
                    <div class="row">
                        <button onclick="packExecutable(this)">Pack Executable</button>
                        <button onclick="checkPackingStatus(this)">Check Status</button>
                    </div>
                </div>

                <div class="card">
                    <h3>FUD Checker with Jotti Scanner</h3>
                    <div class="form-group">
                        <label>File to Scan</label>
                        <input type="text" id="jottiFilePath" placeholder="C:\path\to\file.exe" />
                        <button onclick="browseJottiFile()" class="browse-btn">Browse</button>
                    </div>
                    <div class="form-group">
                        <label>Scan Options</label>
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" id="jottiDetailedResults" checked />
                                <span class="checkmark"></span>
                                Detailed Results
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" id="jottiIncludeSummary" checked />
                                <span class="checkmark"></span>
                                Include Summary
                            </label>
                        </div>
                    </div>
                    <div class="row">
                        <button onclick="scanWithJotti(this)">Scan with Jotti</button>
                        <button onclick="getJottiInfo(this)">Scanner Info</button>
                    </div>
                    <div id="jottiResults" class="results-section" style="display: none;">
                        <h4>Scan Results</h4>
                        <div id="jottiResultsContent"></div>
                    </div>
                </div>

                <div class="card">
                    <h3>CLI Scan Methods</h3>
                    <div class="form-group">
                        <label>Scan Type</label>
                        <select id="cliScanType">
                            <option value="analyze">File Analysis</option>
                            <option value="portscan">Port Scan</option>
                            <option value="netscan">Network Scan</option>
                            <option value="vulnscan">Vulnerability Scan</option>
                            <option value="sigcheck">Signature Check</option>
                            <option value="forensics">Forensics Scan</option>
                            <option value="malware">Malware Scan</option>
                            <option value="vulncheck">Vulnerability Check</option>
                            <option value="appanalyze">App Analysis</option>
                            <option value="device">Device Forensics</option>
                            <option value="behavior">Behavior Analysis</option>
                            <option value="timeline">Timeline Analysis</option>
                            <option value="disasm">Disassembly</option>
                            <option value="strings">String Extraction</option>
                            <option value="memanalysis">Memory Analysis</option>
                            <option value="procdump">Process Dump</option>
                            <option value="service">Service Detection</option>
                            <option value="packet">Packet Capture</option>
                            <option value="traffic">Traffic Analysis</option>
                            <option value="protocol">Protocol Analysis</option>
                            <option value="threat">Threat Detection</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Target</label>
                        <input type="text" id="cliScanTarget" placeholder="Enter target (file, host, IP, etc.)" />
                    </div>
                    <div class="form-group" id="cliScanOptions" style="display: none;">
                        <label>Additional Options</label>
                        <input type="text" id="cliScanOptionsInput" placeholder="Additional parameters (optional)" />
                    </div>
                    <div class="row">
                        <button onclick="runCliScan(this)">Run CLI Scan</button>
                        <button onclick="getCliScanHelp(this)">Get Help</button>
                        <button onclick="clearCliScanResults(this)">Clear Results</button>
                    </div>
                    <div id="cliScanResults" class="results-section" style="display: none;">
                        <h4>CLI Scan Results</h4>
                        <div id="cliScanResultsContent"></div>
                    </div>
                </div>

                <div class="card">
                    <h3>Private Virus Scanner</h3>
                    <div class="form-group">
                        <label>File to Scan</label>
                        <input type="text" id="privateScannerPath" placeholder="C:\path\to\file.exe" />
                        <button onclick="browsePrivateScannerFile()" class="browse-btn">Browse</button>
                    </div>
                    <div class="form-group">
                        <label>Scanning Engines</label>
                        <div class="checkbox-group">
                            <label class="checkbox-item">
                                <input type="checkbox" id="privateScannerClamAV" checked />
                                <span class="checkmark"></span>
                                ClamAV
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" id="privateScannerDefender" checked />
                                <span class="checkmark"></span>
                                Windows Defender
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" id="privateScannerYARA" checked />
                                <span class="checkmark"></span>
                                YARA Rules
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" id="privateScannerML" checked />
                                <span class="checkmark"></span>
                                Machine Learning
                            </label>
                            <label class="checkbox-item">
                                <input type="checkbox" id="privateScannerHeuristic" checked />
                                <span class="checkmark"></span>
                                Heuristic Analysis
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Scan Priority</label>
                        <select id="privateScannerPriority">
                            <option value="normal">Normal</option>
                            <option value="high">High</option>
                            <option value="low">Low</option>
                        </select>
                    </div>
                    <div class="row">
                        <button onclick="scanWithPrivateScanner(this)">Scan File</button>
                        <button onclick="queuePrivateScanner(this)">Queue Scan</button>
                        <button onclick="getPrivateScannerStats(this)">Scanner Stats</button>
                        <button onclick="getPrivateScannerEngines(this)">Engine Status</button>
                        <button onclick="getPrivateScannerQueue(this)">Queue Status</button>
                    </div>
                    <div id="privateScannerResults" class="results-section" style="display: none;">
                        <h4>Scan Results</h4>
                        <div id="privateScannerResultsContent"></div>
                    </div>
                </div>

                <div class="card">
                    <h3>Hot Patching</h3>
                    <div class="form-group">
                        <label>Target Process</label>
                        <input type="text" id="patchTarget" placeholder="process name or PID" />
                    </div>
                    <div class="form-group">
                        <label>Patch Code</label>
                        <textarea id="patchCode" rows="3" placeholder="Enter patch code"></textarea>
                    </div>
                    <div class="row">
                        <button onclick="runHotPatch(this)">Apply Hot Patch</button>
                        <button onclick="runPatchRollback(this)">Rollback Patch</button>
                    </div>
                </div>

                <div class="card">
                    <h3>Mobile Security Tools</h3>
                    <div class="form-group">
                        <label>Mobile Target</label>
                        <input type="text" id="mobileTarget" placeholder="APK, IPA, or device" />
                    </div>
                    <div class="row">
                        <button onclick="runMobileScan(this)">Mobile Scan</button>
                        <button onclick="runAppAnalysis(this)">App Analysis</button>
                        <button onclick="runDeviceForensics(this)">Device Forensics</button>
                    </div>
                </div>

                <div class="card">
                    <h3>API Status Monitor</h3>
                    <div class="row">
                        <button onclick="runAPIStatus(this)">Check API Status</button>
                        <button onclick="runHealthCheck(this)">Health Check</button>
                        <button onclick="runPerformanceMonitor(this)">Performance Monitor</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bot Manager Tab -->
        <div id="bot-manager" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h3>Bot Manager</h3>
                    <p style="color: #a0aec0; margin-bottom: 1rem;">
                        Advanced bot management system with embedded mIRC client, HTTP bot builder, and real-time connection monitoring.
                    </p>
                    <div class="form-group">
                        <button onclick="window.open('/bot-manager', '_blank')" style="background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);">
                            Open Bot Manager
                        </button>
                    </div>
                </div>

                <div class="card">
                    <h3>Quick Bot Generation</h3>
                    <div class="form-group">
                        <label>Bot Type</label>
                        <select id="quickBotType">
                            <option value="http">HTTP Bot</option>
                            <option value="irc">IRC Bot</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Bot Name</label>
                        <input type="text" id="quickBotName" placeholder="QuickBot" value="QuickBot">
                    </div>
                    <div class="form-group">
                        <label>Language</label>
                        <select id="quickBotLanguage">
                            <option value="cpp">C++</option>
                            <option value="python">Python</option>
                            <option value="javascript">JavaScript</option>
                            <option value="swift">Swift (iOS)</option>
                            <option value="kotlin">Kotlin (Android)</option>
                            <option value="java">Java (Cross-platform)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <button onclick="quickGenerateBot()">Quick Generate</button>
                    </div>
                </div>

                <div class="card">
                    <h3>Bot Monitoring</h3>
                    <div class="form-group">
                        <button onclick="getBotStatus()">Check Bot Status</button>
                    </div>
                    <div class="form-group">
                        <button onclick="refreshBotConnections()">Refresh Connections</button>
                    </div>
                    <div class="form-group">
                        <button onclick="testBotCommunication()">Test Communication</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- IRC Bot Builder Tab -->
        <div id="irc-bot" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h3>IRC Bot Builder</h3>
                    <p style="color: #a0aec0; margin-bottom: 1rem;">
                        Advanced IRC bot generation and management platform. Create custom IRC bots with various features and programming languages.
                    </p>
                    <div class="form-group">
                        <button onclick="window.open('/irc-bot-builder', '_blank')" style="background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);">
                            Open IRC Bot Builder
                        </button>
                    </div>
                </div>

                <div class="card">
                    <h3>Quick Bot Generation</h3>
                    <div class="form-group">
                        <label>Bot Name</label>
                        <input type="text" id="advancedBotName" placeholder="MyBot" value="QuickBot">
                    </div>
                    <div class="form-group">
                        <label>IRC Server</label>
                        <input type="text" id="quickIrcServer" placeholder="irc.rizon.net" value="irc.rizon.net">
                    </div>
                    <div class="form-group">
                        <label>Language</label>
                        <select id="quickBotLanguage">
                            <option value="cpp">C++</option>
                            <option value="python">Python</option>
                            <option value="javascript">JavaScript</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <button onclick="quickGenerateIRCBot()">Quick Generate</button>
                    </div>
                </div>

                <div class="card">
                    <h3>Bot Management</h3>
                    <div class="form-group">
                        <button onclick="getBotTemplates()">Load Templates</button>
                    </div>
                    <div class="form-group">
                        <button onclick="getBotFeatures()">Get Features</button>
                    </div>
                    <div class="form-group">
                        <button onclick="testBotConnection()">Test Connection</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- OpenSSL Management Tab -->
        <div id="openssl" class="tab-content">
            <div class="grid">
                <!-- Status Section -->
                <div class="card">
                    <h3>System Status</h3>
                    <div class="form-group">
                        <button onclick="getOpenSSLStatus(this)">Get Status</button>
                    </div>
                    <div id="openssl-status-display" class="status-display"></div>
                </div>

                <!-- Configuration Section -->
                <div class="card">
                    <h3>Configuration</h3>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="opensslToggleConfig" checked>
                            OpenSSL Mode
                        </label>
                        <div id="opensslStatusConfig" class="status-text">OpenSSL Mode: Enabled</div>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="customAlgorithmsToggleConfig" checked>
                            Custom Algorithms
                        </label>
                        <div id="customAlgorithmsStatusConfig" class="status-text">Custom Algorithms: Enabled</div>
                    </div>
                    <div class="form-group">
                        <button onclick="updateOpenSSLConfig(this)">Update Configuration</button>
                        <button onclick="updateOpenSSLUI()" style="margin-left: 10px; background: #4a5568;">Force UI Update</button>
                    </div>
                </div>

                <!-- Presets Section -->
                <div class="card">
                    <h3>Configuration Presets</h3>
                    <div class="form-group">
                        <label for="openssl-preset">Preset:</label>
                        <select id="openssl-preset">
                            <option value="high-security">High Security</option>
                            <option value="compatibility">Compatibility</option>
                            <option value="performance">Performance</option>
                            <option value="experimental">Experimental</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <button onclick="applyOpenSSLPreset(this)">Apply Preset</button>
                    </div>
                </div>

                <!-- Algorithm Testing Section -->
                <div class="card">
                    <h3>Algorithm Testing</h3>
                    <div class="form-group">
                        <label for="test-algorithm">Algorithm:</label>
                        <input type="text" id="test-algorithm" placeholder="e.g., aes-256-gcm" value="aes-256-gcm">
                    </div>
                    <div class="form-group">
                        <label for="test-data">Test Data:</label>
                        <textarea id="test-data" rows="3" placeholder="Test data for encryption">Hello, RawrZ OpenSSL!</textarea>
                    </div>
                    <div class="form-group">
                        <button onclick="testOpenSSLAlgorithm(this)">Test Algorithm</button>
                    </div>
                    <div id="openssl-test-results" class="status-display"></div>
                </div>

                <!-- Performance Section -->
                <div class="card">
                    <h3>Performance</h3>
                    <div class="form-group">
                        <button onclick="getOpenSSLPerformance(this)">Get Performance Stats</button>
                    </div>
                    <div class="form-group">
                        <button onclick="resetOpenSSLPerformance(this)">Reset Performance Data</button>
                    </div>
                    <div id="openssl-performance-display" class="status-display"></div>
                </div>

                <!-- Report Section -->
                <div class="card">
                    <h3>Reports</h3>
                    <div class="form-group">
                        <button onclick="generateOpenSSLReport(this)">Generate Report</button>
                    </div>
                    <div id="openssl-report-display" class="status-display"></div>
                </div>
            </div>
        </div>

        <!-- Payload Manager Tab -->
        <div id="payload-manager" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h3>Payload Manager</h3>
                    <p style="color: #a0aec0; margin-bottom: 1rem;">
                        Dynamic payload configuration and management system. Create, edit, and manage payloads without manually editing source code.
                    </p>
                    <div class="form-group">
                        <button onclick="window.open('/payload-panel', '_blank')" style="background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);">
                            Open Payload Manager
                        </button>
                    </div>
                </div>

                <div class="card">
                    <h3>Quick Payload Actions</h3>
                    <div class="form-group">
                        <label>Payload Type</label>
                        <select id="quickPayloadType">
                            <option value="beaconism">Beaconism DLL</option>
                            <option value="red-shell">Red Shell</option>
                            <option value="hot-patch">Hot Patch</option>
                            <option value="stub-generator">Stub Generator</option>
                            <option value="irc-bot">IRC Bot</option>
                            <option value="http-bot">HTTP Bot</option>
                            <option value="crypto">Crypto</option>
                            <option value="network">Network</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Payload Name</label>
                        <input type="text" id="quickPayloadName" placeholder="Enter payload name">
                    </div>
                    <div class="form-group">
                        <button onclick="quickCreatePayload(this)">Create Payload</button>
                    </div>
                    <div id="payload-status-display" class="status-display"></div>
                </div>

                <div class="card">
                    <h3>Payload Statistics</h3>
                    <div class="form-group">
                        <button onclick="loadPayloadStats(this)">Refresh Stats</button>
                    </div>
                    <div id="payload-stats-display" class="status-display"></div>
                </div>

                <div class="card">
                    <h3>CLI Access</h3>
                    <p style="color: #a0aec0; margin-bottom: 1rem;">
                        Access the payload manager via command line interface.
                    </p>
                    <div class="form-group">
                        <button onclick="openPayloadCLI(this)" style="background: linear-gradient(135deg, #38a169 0%, #2f855a 100%);">
                            Open Payload CLI
                        </button>
                    </div>
                    <div class="form-group">
                        <label>CLI Commands</label>
                        <div style="background: #1a202c; padding: 1rem; border-radius: 8px; font-family: monospace; font-size: 0.9rem; color: #a0aec0;">
                            npm run payload-cli<br>
                            npm run payloads<br>
                            node cli/payload-cli.js
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Embedded CLI Tab -->
        <div id="cli" class="tab-content">
            <div class="grid">
                <div class="card" style="grid-column: 1 / -1;">
                    <h3>RawrZ CLI Terminal</h3>
                    <div class="cli-container">
                        <div class="cli-header">
                            <span class="cli-prompt">RawrZ@Security:~$</span>
                            <div class="cli-controls">
                                <button onclick="clearCLI()" class="cli-btn">Clear</button>
                                <button onclick="showCLIHelp()" class="cli-btn">Help</button>
                                <button onclick="toggleCLIHistory()" class="cli-btn">History</button>
                            </div>
                        </div>
                        <div class="cli-terminal" id="cliTerminal" contenteditable="true" spellcheck="false">
                            <div class="cli-line">
                                <span class="cli-prompt">RawrZ@Security:~$</span>
                                <span class="cli-text">RawrZ Security Platform - Interactive CLI</span>
                            </div>
                            <div class="cli-line">
                                <span class="cli-prompt">RawrZ@Security:~$</span>
                                <span class="cli-text">Type commands directly or use quick commands below</span>
                            </div>
                            <div class="cli-line">
                                <span class="cli-prompt">RawrZ@Security:~$</span>
                                <span class="cli-cursor" id="cliCursor">_</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>Quick Commands</h3>
                    <div class="quick-commands">
                        <div class="command-group">
                            <h4>Crypto Operations</h4>
                            <button onclick="executeQuickCommand('encrypt aes256 Hello World')" class="quick-cmd">Encrypt Text</button>
                            <button onclick="executeQuickCommand('hash test sha256')" class="quick-cmd">Hash Text</button>
                            <button onclick="executeQuickCommand('keygen aes256')" class="quick-cmd">Generate Key</button>
                            <button onclick="executeQuickCommand('uuid')" class="quick-cmd">Generate UUID</button>
                        </div>
                        
                        <div class="command-group">
                            <h4>System Info</h4>
                            <button onclick="executeQuickCommand('sysinfo')" class="quick-cmd">System Info</button>
                            <button onclick="executeQuickCommand('processes')" class="quick-cmd">List Processes</button>
                            <button onclick="executeQuickCommand('files')" class="quick-cmd">List Files</button>
                        </div>
                        
                        <div class="command-group">
                            <h4>Network Tools</h4>
                            <button onclick="executeQuickCommand('ping google.com')" class="quick-cmd">Ping Google</button>
                            <button onclick="executeQuickCommand('dns google.com')" class="quick-cmd">DNS Lookup</button>
                            <button onclick="executeQuickCommand('portscan localhost 80 443')" class="quick-cmd">Port Scan</button>
                        </div>
                        
                        <div class="command-group">
                            <h4>File Operations</h4>
                            <button onclick="executeQuickCommand('analyze C:/Windows/calc.exe')" class="quick-cmd">Analyze File</button>
                            <button onclick="executeQuickCommand('base64encode Hello World')" class="quick-cmd">Base64 Encode</button>
                            <button onclick="executeQuickCommand('validate user@example.com email')" class="quick-cmd">Validate Email</button>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>Custom Quick Commands</h3>
                    <div class="custom-commands">
                        <div class="add-command-form">
                            <div class="form-group">
                                <label>Command Name:</label>
                                <input type="text" id="customCommandName" placeholder="e.g., My Custom Command">
                            </div>
                            <div class="form-group">
                                <label>Command:</label>
                                <input type="text" id="customCommandText" placeholder="e.g., encrypt aes256 MySecret">
                            </div>
                            <button onclick="addCustomCommand()" class="add-cmd-btn">Add Command</button>
                        </div>
                        
                        <div class="custom-commands-list" id="customCommandsList">
                            <!-- Custom commands will be loaded here -->
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>Available Commands</h3>
                    <div class="command-help" id="commandHelp">
                        <div class="help-section">
                            <h4>Crypto Operations</h4>
                            <div class="help-command">encrypt &lt;algorithm&gt; &lt;text&gt;</div>
                            <div class="help-command">hash &lt;text&gt; &lt;algorithm&gt;</div>
                            <div class="help-command">keygen &lt;algorithm&gt;</div>
                            <div class="help-command">uuid</div>
                        </div>
                        
                        <div class="help-section">
                            <h4>System Info</h4>
                            <div class="help-command">sysinfo</div>
                            <div class="help-command">processes</div>
                            <div class="help-command">files [path]</div>
                        </div>
                        
                        <div class="help-section">
                            <h4>Network Tools</h4>
                            <div class="help-command">ping &lt;host&gt;</div>
                            <div class="help-command">dns &lt;domain&gt;</div>
                            <div class="help-command">portscan &lt;host&gt; &lt;ports&gt;</div>
                        </div>
                        
                        <div class="help-section">
                            <h4>File Operations</h4>
                            <div class="help-command">analyze &lt;filepath&gt;</div>
                            <div class="help-command">base64encode &lt;text&gt;</div>
                            <div class="help-command">validate &lt;value&gt; &lt;type&gt;</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>CLI History & Logs</h3>
                    <div class="cli-history" id="cliHistory">
                        <div class="history-item">
                            <span class="history-time">[2025-09-16 21:00:00]</span>
                            <span class="history-command">help</span>
                            <span class="history-result">Available commands displayed</span>
                        </div>
                    </div>
                    <div class="history-controls">
                        <button onclick="exportCLIHistory()" class="history-btn">Export History</button>
                        <button onclick="clearCLIHistory()" class="history-btn">Clear History</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Output Section -->
        <div class="card">
            <h3>Output</h3>
            <div id="output" class="output">Ready. Select a feature and click a button to get started.</div>
        </div>
    </div>

<script>
        // Global variables
        let authToken = localStorage.getItem('authToken') || '';
        window.uploadedFiles = [];
        let opensslConfig = {
            useOpenSSL: true,
            allowCustomAlgorithms: false,
            availableAlgorithms: [],
            opensslAlgorithms: [],
            customAlgorithms: []
        };
        
        // OpenSSL Management Functions
        async function initializeOpenSSLManager() {
            try {
                console.log('Initializing OpenSSL Manager...');
                
                // Load current configuration
                const configResponse = await api('/openssl/config');
                console.log('Config response:', configResponse);
                
                if (configResponse.success) {
                    const result = configResponse.result;
                    console.log('Config result:', result);
                    
                    // Map backend fields to frontend config
                    opensslConfig.useOpenSSL = result.enabled;
                    opensslConfig.allowCustomAlgorithms = result.customAlgorithms;
                    opensslConfig.autoFallback = result.autoFallback || true;
                    
                    console.log('Mapped config:', opensslConfig);
                    updateOpenSSLUI();
                }
                
                // Load available algorithms
                await loadAvailableAlgorithms();
                
                // Set up event listeners
                setupOpenSSLEventListeners();
                
                console.log('OpenSSL Manager initialized successfully');
            } catch (error) {
                console.error('Failed to initialize OpenSSL Manager:', error);
            }
        }
        
        function setupOpenSSLEventListeners() {
            console.log('Setting up OpenSSL event listeners...');
            
            // OpenSSL toggle
            const opensslToggle = document.getElementById('opensslToggle');
            console.log('OpenSSL toggle element found:', !!opensslToggle);
            
            if (opensslToggle) {
                // Add click event listener for debugging
                opensslToggle.addEventListener('click', (e) => {
                    console.log('OpenSSL checkbox CLICKED!');
                });
                
                opensslToggle.addEventListener('change', async (e) => {
                    console.log('OpenSSL checkbox CHANGED! New state:', e.target.checked);
                    
                    // Update local config immediately
                    opensslConfig.useOpenSSL = e.target.checked;
                    
                    // Update all status texts immediately
                    const opensslStatus = document.getElementById('opensslStatus');
                    const opensslStatusConfig = document.getElementById('opensslStatusConfig');
                    
                    if (opensslStatus) {
                        opensslStatus.textContent = `OpenSSL Mode: ${e.target.checked ? 'Enabled' : 'Disabled'}`;
                        opensslStatus.style.color = e.target.checked ? '#68d391' : '#a0aec0';
                        console.log('Updated OpenSSL status text to:', opensslStatus.textContent);
                    }
                    if (opensslStatusConfig) {
                        opensslStatusConfig.textContent = `OpenSSL Mode: ${e.target.checked ? 'Enabled' : 'Disabled'}`;
                        opensslStatusConfig.style.color = e.target.checked ? '#68d391' : '#a0aec0';
                    }
                    
                    // Sync config section checkbox
                    const opensslToggleConfig = document.getElementById('opensslToggleConfig');
                    if (opensslToggleConfig) {
                        opensslToggleConfig.checked = e.target.checked;
                    }
                    
                    console.log('OpenSSL checkbox changed to:', e.target.checked);
                    await toggleOpenSSLMode(e.target.checked);
                });
                console.log('OpenSSL event listener added successfully');
            } else {
                console.error('OpenSSL toggle element not found!');
            }
            
            // Custom algorithms toggle
            const customToggle = document.getElementById('customAlgorithmsToggle');
            console.log('Custom toggle element found:', !!customToggle);
            
            if (customToggle) {
                // Add click event listener for debugging
                customToggle.addEventListener('click', (e) => {
                    console.log('Custom Algorithms checkbox CLICKED!');
                });
                
                customToggle.addEventListener('change', async (e) => {
                    console.log('Custom Algorithms checkbox CHANGED! New state:', e.target.checked);
                    
                    // Update local config immediately
                    opensslConfig.allowCustomAlgorithms = e.target.checked;
                    
                    // Update all status texts immediately
                    const customStatus = document.getElementById('customAlgorithmsStatus');
                    const customStatusConfig = document.getElementById('customAlgorithmsStatusConfig');
                    
                    if (customStatus) {
                        customStatus.textContent = `Custom Algorithms: ${e.target.checked ? 'Enabled' : 'Disabled'}`;
                        customStatus.style.color = e.target.checked ? '#68d391' : '#a0aec0';
                        console.log('Updated Custom status text to:', customStatus.textContent);
                    }
                    if (customStatusConfig) {
                        customStatusConfig.textContent = `Custom Algorithms: ${e.target.checked ? 'Enabled' : 'Disabled'}`;
                        customStatusConfig.style.color = e.target.checked ? '#68d391' : '#a0aec0';
                    }
                    
                    // Sync config section checkbox
                    const customToggleConfig = document.getElementById('customAlgorithmsToggleConfig');
                    if (customToggleConfig) {
                        customToggleConfig.checked = e.target.checked;
                    }
                    
                    console.log('Custom Algorithms checkbox changed to:', e.target.checked);
                    await toggleCustomAlgorithms(e.target.checked);
                });
                console.log('Custom event listener added successfully');
            } else {
                console.error('Custom toggle element not found!');
            }
            
            // Configuration section OpenSSL toggle
            const opensslToggleConfig = document.getElementById('opensslToggleConfig');
            console.log('OpenSSL config toggle element found:', !!opensslToggleConfig);
            
            if (opensslToggleConfig) {
                opensslToggleConfig.addEventListener('change', async (e) => {
                    console.log('OpenSSL config checkbox CHANGED! New state:', e.target.checked);
                    
                    // Update local config immediately
                    opensslConfig.useOpenSSL = e.target.checked;
                    
                    // Update all status texts immediately
                    const opensslStatus = document.getElementById('opensslStatus');
                    const opensslStatusConfig = document.getElementById('opensslStatusConfig');
                    
                    if (opensslStatus) {
                        opensslStatus.textContent = `OpenSSL Mode: ${e.target.checked ? 'Enabled' : 'Disabled'}`;
                        opensslStatus.style.color = e.target.checked ? '#68d391' : '#a0aec0';
                    }
                    if (opensslStatusConfig) {
                        opensslStatusConfig.textContent = `OpenSSL Mode: ${e.target.checked ? 'Enabled' : 'Disabled'}`;
                        opensslStatusConfig.style.color = e.target.checked ? '#68d391' : '#a0aec0';
                    }
                    
                    // Sync main section checkbox
                    const opensslToggle = document.getElementById('opensslToggle');
                    if (opensslToggle) {
                        opensslToggle.checked = e.target.checked;
                    }
                    
                    console.log('OpenSSL config checkbox changed to:', e.target.checked);
                    await toggleOpenSSLMode(e.target.checked);
                });
                console.log('OpenSSL config event listener added successfully');
            }
            
            // Configuration section Custom algorithms toggle
            const customToggleConfig = document.getElementById('customAlgorithmsToggleConfig');
            console.log('Custom config toggle element found:', !!customToggleConfig);
            
            if (customToggleConfig) {
                customToggleConfig.addEventListener('change', async (e) => {
                    console.log('Custom config checkbox CHANGED! New state:', e.target.checked);
                    
                    // Update local config immediately
                    opensslConfig.allowCustomAlgorithms = e.target.checked;
                    
                    // Update all status texts immediately
                    const customStatus = document.getElementById('customAlgorithmsStatus');
                    const customStatusConfig = document.getElementById('customAlgorithmsStatusConfig');
                    
                    if (customStatus) {
                        customStatus.textContent = `Custom Algorithms: ${e.target.checked ? 'Enabled' : 'Disabled'}`;
                        customStatus.style.color = e.target.checked ? '#68d391' : '#a0aec0';
                    }
                    if (customStatusConfig) {
                        customStatusConfig.textContent = `Custom Algorithms: ${e.target.checked ? 'Enabled' : 'Disabled'}`;
                        customStatusConfig.style.color = e.target.checked ? '#68d391' : '#a0aec0';
                    }
                    
                    // Sync main section checkbox
                    const customToggle = document.getElementById('customAlgorithmsToggle');
                    if (customToggle) {
                        customToggle.checked = e.target.checked;
                    }
                    
                    console.log('Custom config checkbox changed to:', e.target.checked);
                    await toggleCustomAlgorithms(e.target.checked);
                });
                console.log('Custom config event listener added successfully');
            }
            
            // Algorithm filter
            const algorithmFilter = document.getElementById('algorithmFilter');
            if (algorithmFilter) {
                algorithmFilter.addEventListener('change', (e) => {
                    filterAlgorithms(e.target.value);
                });
            }
        }
        
        async function toggleOpenSSLMode(enabled) {
            const opensslToggle = document.getElementById('opensslToggle');
            if (opensslToggle) {
                opensslToggle.disabled = true; // Prevent multiple clicks
            }
            
            try {
                const response = await api('/openssl/toggle-openssl', 'POST', { enabled }, 3);
                
                if (response.success && response.result && response.result.success) {
                    // Local config already updated in event listener
                    showStatus(`OpenSSL mode ${enabled ? 'enabled' : 'disabled'}`, 'success');
                } else {
                    showStatus('Failed to toggle OpenSSL mode', 'error');
                    // Revert checkbox state and status text on failure
                    if (opensslToggle) {
                        opensslToggle.checked = opensslConfig.useOpenSSL;
                    }
                    const opensslStatus = document.getElementById('opensslStatus');
                    if (opensslStatus) {
                        opensslStatus.textContent = `OpenSSL Mode: ${opensslConfig.useOpenSSL ? 'Enabled' : 'Disabled'}`;
                        opensslStatus.style.color = opensslConfig.useOpenSSL ? '#68d391' : '#a0aec0';
                    }
                }
            } catch (error) {
                console.error('Error toggling OpenSSL mode:', error);
                showStatus('Error toggling OpenSSL mode', 'error');
                // Revert checkbox state and status text on error
                if (opensslToggle) {
                    opensslToggle.checked = opensslConfig.useOpenSSL;
                }
                const opensslStatus = document.getElementById('opensslStatus');
                if (opensslStatus) {
                    opensslStatus.textContent = `OpenSSL Mode: ${opensslConfig.useOpenSSL ? 'Enabled' : 'Disabled'}`;
                    opensslStatus.style.color = opensslConfig.useOpenSSL ? '#68d391' : '#a0aec0';
                }
            } finally {
                if (opensslToggle) {
                    opensslToggle.disabled = false; // Re-enable checkbox
                }
            }
        }
        
        async function toggleCustomAlgorithms(enabled) {
            const customToggle = document.getElementById('customAlgorithmsToggle');
            if (customToggle) {
                customToggle.disabled = true; // Prevent multiple clicks
            }
            
            try {
                const response = await api('/openssl/toggle-custom', 'POST', { enabled }, 3);
                
                if (response.success && response.result && response.result.success) {
                    // Update local config immediately
                    opensslConfig.allowCustomAlgorithms = enabled;
                    showStatus(`Custom algorithms ${enabled ? 'enabled' : 'disabled'}`, 'success');
                } else {
                    showStatus('Failed to toggle custom algorithms', 'error');
                    // Revert checkbox state and status text on failure
                    if (customToggle) {
                        customToggle.checked = opensslConfig.allowCustomAlgorithms;
                    }
                    const customStatus = document.getElementById('customAlgorithmsStatus');
                    if (customStatus) {
                        customStatus.textContent = `Custom Algorithms: ${opensslConfig.allowCustomAlgorithms ? 'Enabled' : 'Disabled'}`;
                        customStatus.style.color = opensslConfig.allowCustomAlgorithms ? '#68d391' : '#a0aec0';
                    }
                }
            } catch (error) {
                console.error('Error toggling custom algorithms:', error);
                showStatus('Error toggling custom algorithms', 'error');
                // Revert checkbox state and status text on error
                if (customToggle) {
                    customToggle.checked = opensslConfig.allowCustomAlgorithms;
                }
                const customStatus = document.getElementById('customAlgorithmsStatus');
                if (customStatus) {
                    customStatus.textContent = `Custom Algorithms: ${opensslConfig.allowCustomAlgorithms ? 'Enabled' : 'Disabled'}`;
                    customStatus.style.color = opensslConfig.allowCustomAlgorithms ? '#68d391' : '#a0aec0';
                }
            } finally {
                if (customToggle) {
                    customToggle.disabled = false; // Re-enable checkbox
                }
            }
        }
        
        async function refreshOpenSSLConfig() {
            try {
                const configResponse = await api('/openssl/config');
                if (configResponse.success) {
                    const result = configResponse.result;
                    // Map backend fields to frontend config
                    opensslConfig.useOpenSSL = result.enabled || result.opensslMode || (result.mode === 'openssl');
                    opensslConfig.allowCustomAlgorithms = result.customAlgorithms || false;
                    opensslConfig.autoFallback = result.autoFallback || true;
                    updateOpenSSLUI();
                    await loadAvailableAlgorithms();
                }
            } catch (error) {
                console.error('Error refreshing OpenSSL config:', error);
            }
        }
        
        async function loadAvailableAlgorithms() {
            try {
                // Load all algorithms
                const allResponse = await api('/openssl/algorithms');
                if (allResponse.data && allResponse.data.success) {
                    opensslConfig.availableAlgorithms = allResponse.data.result;
                }
                
                // Load OpenSSL algorithms
                const opensslResponse = await api('/openssl/openssl-algorithms');
                if (opensslResponse.data && opensslResponse.data.success) {
                    opensslConfig.opensslAlgorithms = opensslResponse.data.result;
                }
                
                // Load custom algorithms
                const customResponse = await api('/openssl/custom-algorithms');
                if (customResponse.data && customResponse.data.success) {
                    opensslConfig.customAlgorithms = customResponse.data.result;
                }
                
                updateAlgorithmDropdown();
            } catch (error) {
                console.error('Error loading algorithms:', error);
            }
        }
        
        function updateAlgorithmDropdown() {
            const algorithmSelect = document.getElementById('encAlgo');
            if (!algorithmSelect) return;
            
            // Clear existing options
            algorithmSelect.innerHTML = '';
            
            // Add algorithms based on current filter
            const filter = document.getElementById('algorithmFilter')?.value || 'all';
            let algorithmsToShow = [];
            
            switch (filter) {
                case 'openssl':
                    algorithmsToShow = opensslConfig.opensslAlgorithms;
                    break;
                case 'custom':
                    algorithmsToShow = opensslConfig.customAlgorithms;
                    break;
                default:
                    algorithmsToShow = opensslConfig.availableAlgorithms;
            }
            
            // Add options
            algorithmsToShow.forEach(algorithm => {
                const option = document.createElement('option');
                option.value = algorithm;
                option.textContent = algorithm.toUpperCase().replace(/-/g, ' ');
                algorithmSelect.appendChild(option);
            });
            
            // Add algorithm info
            addAlgorithmInfo();
        }
        
        function filterAlgorithms(filter) {
            updateAlgorithmDropdown();
        }
        
        function addAlgorithmInfo() {
            const algorithmSelect = document.getElementById('encAlgo');
            if (!algorithmSelect) return;
            
            // Remove existing info
            const existingInfo = document.querySelector('.algorithm-info');
            if (existingInfo) {
                existingInfo.remove();
            }
            
            const selectedAlgorithm = algorithmSelect.value;
            if (!selectedAlgorithm) return;
            
            const isOpenSSL = opensslConfig.opensslAlgorithms.includes(selectedAlgorithm);
            const isCustom = opensslConfig.customAlgorithms.includes(selectedAlgorithm);
            
            const infoDiv = document.createElement('div');
            infoDiv.className = `algorithm-info ${isOpenSSL ? 'openssl' : 'custom'}`;
            
            let infoText = '';
            if (isOpenSSL) {
                infoText = `[INFO] OpenSSL Compatible - Native support, high performance`;
            } else if (isCustom) {
                infoText = `Custom Implementation - May have compatibility limitations`;
            } else {
                infoText = `? Unknown Algorithm Type`;
            }
            
            infoDiv.textContent = infoText;
            algorithmSelect.parentNode.appendChild(infoDiv);
        }
        
        function updateOpenSSLUI() {
            console.log('updateOpenSSLUI called with config:', opensslConfig);
            
            // Update main encryption section elements
            const opensslToggle = document.getElementById('opensslToggle');
            const customToggle = document.getElementById('customAlgorithmsToggle');
            const opensslStatus = document.getElementById('opensslStatus');
            const customStatus = document.getElementById('customAlgorithmsStatus');
            
            // Update configuration section elements
            const opensslToggleConfig = document.getElementById('opensslToggleConfig');
            const customToggleConfig = document.getElementById('customAlgorithmsToggleConfig');
            const opensslStatusConfig = document.getElementById('opensslStatusConfig');
            const customStatusConfig = document.getElementById('customAlgorithmsStatusConfig');
            
            console.log('Elements found:', {
                opensslToggle: !!opensslToggle,
                customToggle: !!customToggle,
                opensslStatus: !!opensslStatus,
                customStatus: !!customStatus,
                opensslToggleConfig: !!opensslToggleConfig,
                customToggleConfig: !!customToggleConfig,
                opensslStatusConfig: !!opensslStatusConfig,
                customStatusConfig: !!customStatusConfig
            });
            
            // Update main section
            if (opensslToggle) {
                opensslToggle.checked = opensslConfig.useOpenSSL;
                console.log('Set opensslToggle.checked to:', opensslConfig.useOpenSSL);
            }
            if (customToggle) {
                customToggle.checked = opensslConfig.allowCustomAlgorithms;
                console.log('Set customToggle.checked to:', opensslConfig.allowCustomAlgorithms);
            }
            if (opensslStatus) {
                opensslStatus.textContent = `OpenSSL Mode: ${opensslConfig.useOpenSSL ? 'Enabled' : 'Disabled'}`;
                opensslStatus.style.color = opensslConfig.useOpenSSL ? '#68d391' : '#a0aec0';
                console.log('Updated opensslStatus text to:', opensslStatus.textContent);
            }
            if (customStatus) {
                customStatus.textContent = `Custom Algorithms: ${opensslConfig.allowCustomAlgorithms ? 'Enabled' : 'Disabled'}`;
                customStatus.style.color = opensslConfig.allowCustomAlgorithms ? '#68d391' : '#a0aec0';
                console.log('Updated customStatus text to:', customStatus.textContent);
            }
            
            // Update config section
            if (opensslToggleConfig) {
                opensslToggleConfig.checked = opensslConfig.useOpenSSL;
                console.log('Set opensslToggleConfig.checked to:', opensslConfig.useOpenSSL);
            }
            if (customToggleConfig) {
                customToggleConfig.checked = opensslConfig.allowCustomAlgorithms;
                console.log('Set customToggleConfig.checked to:', opensslConfig.allowCustomAlgorithms);
            }
            if (opensslStatusConfig) {
                opensslStatusConfig.textContent = `OpenSSL Mode: ${opensslConfig.useOpenSSL ? 'Enabled' : 'Disabled'}`;
                opensslStatusConfig.style.color = opensslConfig.useOpenSSL ? '#68d391' : '#a0aec0';
                console.log('Updated opensslStatusConfig text to:', opensslStatusConfig.textContent);
            }
            if (customStatusConfig) {
                customStatusConfig.textContent = `Custom Algorithms: ${opensslConfig.allowCustomAlgorithms ? 'Enabled' : 'Disabled'}`;
                customStatusConfig.style.color = opensslConfig.allowCustomAlgorithms ? '#68d391' : '#a0aec0';
                console.log('Updated customStatusConfig text to:', customStatusConfig.textContent);
            }
        }
        
        function syncStatusWithCheckboxes() {
            console.log('Syncing status text with checkbox states...');
            
            const opensslToggle = document.getElementById('opensslToggle');
            const customToggle = document.getElementById('customAlgorithmsToggle');
            const opensslStatus = document.getElementById('opensslStatus');
            const customStatus = document.getElementById('customAlgorithmsStatus');
            
            if (opensslToggle && opensslStatus) {
                const isEnabled = opensslToggle.checked;
                opensslStatus.textContent = `OpenSSL Mode: ${isEnabled ? 'Enabled' : 'Disabled'}`;
                opensslStatus.style.color = isEnabled ? '#68d391' : '#a0aec0';
                console.log('Updated OpenSSL status to:', opensslStatus.textContent);
            }
            
            if (customToggle && customStatus) {
                const isEnabled = customToggle.checked;
                customStatus.textContent = `Custom Algorithms: ${isEnabled ? 'Enabled' : 'Disabled'}`;
                customStatus.style.color = isEnabled ? '#68d391' : '#a0aec0';
                console.log('Updated Custom status to:', customStatus.textContent);
            }
        }
        
        function testCheckboxClickability() {
            console.log('Testing checkbox clickability...');
            
            const opensslToggle = document.getElementById('opensslToggle');
            const customToggle = document.getElementById('customAlgorithmsToggle');
            
            if (opensslToggle) {
                console.log('OpenSSL checkbox properties:', {
                    disabled: opensslToggle.disabled,
                    readonly: opensslToggle.readOnly,
                    style: opensslToggle.style.cssText,
                    pointerEvents: window.getComputedStyle(opensslToggle).pointerEvents,
                    zIndex: window.getComputedStyle(opensslToggle).zIndex
                });
                
                // Try to manually trigger a click
                opensslToggle.click();
                console.log('Manually triggered OpenSSL checkbox click');
            }
            
            if (customToggle) {
                console.log('Custom checkbox properties:', {
                    disabled: customToggle.disabled,
                    readonly: customToggle.readOnly,
                    style: customToggle.style.cssText,
                    pointerEvents: window.getComputedStyle(customToggle).pointerEvents,
                    zIndex: window.getComputedStyle(customToggle).zIndex
                });
                
                // Try to manually trigger a click
                customToggle.click();
                console.log('Manually triggered Custom checkbox click');
            }
        }
        
        // Interactive Controls Management
        function initializeInteractiveControls() {
            // Initialize sliders
            initializeSliders();
            
            // Initialize toggles
            initializeToggles();
            
            // Initialize checkboxes
            initializeCheckboxes();
            
            // Initialize platform selector
            initializePlatformSelector();
            
            console.log('Interactive controls initialized');
        }
        
        function initializeSliders() {
            // Polymorphic Engine Slider
            const polymorphicSlider = document.getElementById('stubPolymorphicSlider');
            const polymorphicValue = document.getElementById('polymorphicValue');
            if (polymorphicSlider && polymorphicValue) {
                const labels = ['None', 'Basic', 'Advanced', 'Extreme'];
                polymorphicSlider.addEventListener('input', (e) => {
                    const value = parseInt(e.target.value);
                    polymorphicValue.textContent = labels[value];
                });
            }
            
            // Stealth Level Slider
            const stealthSlider = document.getElementById('stubStealthSlider');
            const stealthValue = document.getElementById('stealthValue');
            if (stealthSlider && stealthValue) {
                const labels = ['Low', 'Medium', 'High', 'Maximum'];
                stealthSlider.addEventListener('input', (e) => {
                    const value = parseInt(e.target.value);
                    stealthValue.textContent = labels[value];
                });
            }
            
            // Obfuscation Level Slider
            const obfuscationSlider = document.getElementById('stubObfuscationSlider');
            const obfuscationValue = document.getElementById('obfuscationValue');
            if (obfuscationSlider && obfuscationValue) {
                const labels = ['None', 'Basic', 'Intermediate', 'Advanced', 'Extreme'];
                obfuscationSlider.addEventListener('input', (e) => {
                    const value = parseInt(e.target.value);
                    obfuscationValue.textContent = labels[value];
                });
            }
            
            // Port Range Sliders
            const startPortSlider = document.getElementById('scanStartPortSlider');
            const startPortValue = document.getElementById('startPortValue');
            if (startPortSlider && startPortValue) {
                startPortSlider.addEventListener('input', (e) => {
                    startPortValue.textContent = e.target.value;
                });
            }
            
            const endPortSlider = document.getElementById('scanEndPortSlider');
            const endPortValue = document.getElementById('endPortValue');
            if (endPortSlider && endPortValue) {
                endPortSlider.addEventListener('input', (e) => {
                    endPortValue.textContent = e.target.value;
                });
            }
            
            // Scan Speed Slider
            const scanSpeedSlider = document.getElementById('scanSpeedSlider');
            const scanSpeedValue = document.getElementById('scanSpeedValue');
            if (scanSpeedSlider && scanSpeedValue) {
                const labels = ['Slow', 'Normal', 'Fast', 'Aggressive', 'Insane'];
                scanSpeedSlider.addEventListener('input', (e) => {
                    const value = parseInt(e.target.value) - 1;
                    scanSpeedValue.textContent = labels[value];
                });
            }
        }
        
        function initializeToggles() {
            // Compression Toggle
            const compressionToggle = document.getElementById('stubCompressionToggle');
            const compressionStatus = document.getElementById('compressionStatus');
            const compressionSelect = document.getElementById('stubCompression');
            
            if (compressionToggle && compressionStatus && compressionSelect) {
                compressionToggle.addEventListener('change', (e) => {
                    const enabled = e.target.checked;
                    compressionStatus.textContent = `Compression: ${enabled ? 'Enabled' : 'Disabled'}`;
                    compressionSelect.disabled = !enabled;
                    compressionSelect.style.opacity = enabled ? '1' : '0.5';
                });
                
                // Initialize state
                compressionSelect.disabled = !compressionToggle.checked;
                compressionSelect.style.opacity = compressionToggle.checked ? '1' : '0.5';
            }
            
            // Packing Toggle
            const packingToggle = document.getElementById('stubPackingToggle');
            const packingStatus = document.getElementById('packingStatus');
            const packingSelect = document.getElementById('stubPackingMethod');
            
            if (packingToggle && packingStatus && packingSelect) {
                packingToggle.addEventListener('change', (e) => {
                    const enabled = e.target.checked;
                    packingStatus.textContent = `Packing: ${enabled ? 'Enabled' : 'Disabled'}`;
                    packingSelect.disabled = !enabled;
                    packingSelect.style.opacity = enabled ? '1' : '0.5';
                });
                
                // Initialize state
                packingSelect.disabled = !packingToggle.checked;
                packingSelect.style.opacity = packingToggle.checked ? '1' : '0.5';
            }
        }
        
        function initializeCheckboxes() {
            // Add visual feedback for checkboxes
            const checkboxes = document.querySelectorAll('.checkbox-item input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', (e) => {
                    const item = e.target.closest('.checkbox-item');
                    if (e.target.checked) {
                        item.style.background = 'rgba(104, 211, 145, 0.1)';
                    } else {
                        item.style.background = '';
                    }
                });
            });
        }
        
        function initializePlatformSelector() {
            // Add visual feedback for platform selection
            const platformOptions = document.querySelectorAll('.platform-option input[type="radio"]');
            platformOptions.forEach(radio => {
                radio.addEventListener('change', (e) => {
                    // Remove active class from all options
                    document.querySelectorAll('.platform-option').forEach(option => {
                        option.classList.remove('active');
                    });
                    
                    // Add active class to selected option
                    const selectedOption = e.target.closest('.platform-option');
                    selectedOption.classList.add('active');
                });
            });
        }
        
        // Get all stub options for advanced stub generation
        function getAdvancedStubOptions() {
            const polymorphicSlider = document.getElementById('stubPolymorphicSlider');
            const stealthSlider = document.getElementById('stubStealthSlider');
            const obfuscationSlider = document.getElementById('stubObfuscationSlider');
            const compressionToggle = document.getElementById('stubCompressionToggle');
            const compressionSelect = document.getElementById('stubCompression');
            const packingToggle = document.getElementById('stubPackingToggle');
            const packingSelect = document.getElementById('stubPackingMethod');
            
            const polymorphicLabels = ['none', 'basic', 'advanced', 'extreme'];
            const stealthLabels = ['low', 'medium', 'high', 'maximum'];
            const obfuscationLabels = ['none', 'basic', 'intermediate', 'advanced', 'extreme'];
            
            const options = {
                // Slider values
                polymorphic: polymorphicLabels[parseInt(polymorphicSlider?.value || 0)],
                stealth: stealthLabels[parseInt(stealthSlider?.value || 1)],
                obfuscation: obfuscationLabels[parseInt(obfuscationSlider?.value || 0)],
                
                // Toggle values
                compression: compressionToggle?.checked ? compressionSelect?.value || 'gzip' : 'none',
                packing: packingToggle?.checked ? packingSelect?.value || 'upx' : 'none',
                
                // Checkbox values
                hotPatch: document.getElementById('stubHotPatch')?.checked || false,
                memoryProtect: document.getElementById('stubMemoryProtect')?.checked || false,
                selfModifying: document.getElementById('stubSelfModifying')?.checked || false,
                encryptedStrings: document.getElementById('stubEncryptedStrings')?.checked || false,
                controlFlowFlattening: document.getElementById('stubControlFlowFlattening')?.checked || false,
                deadCodeInjection: document.getElementById('stubDeadCodeInjection')?.checked || false,
                
                // Platform selection
                target: document.querySelector('input[name="targetPlatform"]:checked')?.value || 'windows'
            };
            
            return options;
        }
        
        // Enhanced stub generation with all options
        async function runAdvancedStub(button) {
            const target = document.getElementById('stubTarget')?.value;
            if (!target) {
                showNotification('Please enter a target', 'error');
                return;
            }
            
            const options = getAdvancedStubOptions();
            
            // Show loading state
            button.disabled = true;
            button.textContent = 'Generating...';
            
            try {
                const result = await api('/stub', 'POST', { target, options });
                
                if (result.success) {
                    showNotification('Advanced stub generated successfully!', 'success');
                    showStatus(`Advanced Stub Generated:
Target: ${target}
Polymorphic: ${options.polymorphic}
Stealth: ${options.stealth}
Obfuscation: ${options.obfuscation}
Compression: ${options.compression}
Packing: ${options.packing}
Platform: ${options.target}
Features: ${Object.entries(options).filter(([k,v]) => typeof v === 'boolean' && v).map(([k]) => k).join(', ') || 'None'}`, 'success');
                } else {
                    showNotification('Failed to generate advanced stub', 'error');
                }
            } catch (error) {
                console.error('Advanced stub generation error:', error);
                showNotification('Error generating advanced stub', 'error');
            } finally {
                button.disabled = false;
                button.textContent = 'Generate Advanced Stub';
            }
        }
        
        // Get port scan options
        function getPortScanOptions() {
            const startPortSlider = document.getElementById('scanStartPortSlider');
            const endPortSlider = document.getElementById('scanEndPortSlider');
            const scanSpeedSlider = document.getElementById('scanSpeedSlider');
            
            const speedLabels = ['slow', 'normal', 'fast', 'aggressive', 'insane'];
            
            const options = {
                startPort: parseInt(startPortSlider?.value || 1),
                endPort: parseInt(endPortSlider?.value || 1000),
                scanType: document.querySelector('input[name="scanType"]:checked')?.value || 'tcp',
                speed: speedLabels[parseInt(scanSpeedSlider?.value || 3) - 1],
                verbose: document.getElementById('scanVerbose')?.checked || false,
                stealth: document.getElementById('scanStealth')?.checked || false,
                serviceDetection: document.getElementById('scanServiceDetection')?.checked || false,
                osDetection: document.getElementById('scanOSDetection')?.checked || false
            };
            
            return options;
        }
        
        // Enhanced port scan with all options
        async function runPortScan(button) {
            const host = document.getElementById('scanHost')?.value;
            if (!host) {
                showNotification('Please enter a target host', 'error');
                return;
            }
            
            const options = getPortScanOptions();
            
            // Show loading state
            button.disabled = true;
            button.textContent = 'Scanning...';
            
            try {
                const result = await api('/portscan', 'POST', { 
                    host, 
                    startPort: options.startPort, 
                    endPort: options.endPort,
                    ...options 
                });
                
                if (result.success) {
                    showNotification('Port scan completed successfully!', 'success');
                    showStatus(`Port Scan Results:
Host: ${host}
Port Range: ${options.startPort}-${options.endPort}
Scan Type: ${options.scanType.toUpperCase()}
Speed: ${options.speed}
Options: ${Object.entries(options).filter(([k,v]) => typeof v === 'boolean' && v).map(([k]) => k).join(', ') || 'None'}
Results: ${JSON.stringify(result.result, null, 2)}`, 'success');
                } else {
                    showNotification('Port scan failed', 'error');
                }
            } catch (error) {
                console.error('Port scan error:', error);
                showNotification('Error during port scan', 'error');
            } finally {
                button.disabled = false;
                button.textContent = 'Scan Ports';
            }
        }
        
        // File Upload System
        function initializeFileUpload() {
            const uploadZone = document.getElementById('uploadZone');
            const fileInput = document.getElementById('fileInput');
            
            // Drag and drop events
            uploadZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadZone.classList.add('dragover');
            });
            
            uploadZone.addEventListener('dragleave', (e) => {
                e.preventDefault();
                uploadZone.classList.remove('dragover');
            });
            
            uploadZone.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadZone.classList.remove('dragover');
                const files = Array.from(e.dataTransfer.files);
                handleFiles(files);
            });
            
            // Click to browse - but not when clicking the browse button
            uploadZone.addEventListener('click', (e) => {
                // Don't trigger if clicking the browse button
                if (e.target.tagName === 'BUTTON' || e.target.closest('button')) {
                    return;
                }
                fileInput.click();
            });
            
            // File input change
            fileInput.addEventListener('change', (e) => {
                const files = Array.from(e.target.files);
                handleFiles(files);
            });
        }
        
        function browseFiles(button) {
            // Prevent double-click by disabling button temporarily
            button.disabled = true;
            setTimeout(() => button.disabled = false, 1000);
            
            // Create file input with improved path handling
            const input = document.createElement('input');
            input.type = 'file';
            input.multiple = true;
            input.accept = '.exe,.dll,.sys,.scr,.com,.bat,.cmd,.ps1,.js,.vbs,.txt,.pdf,.doc,.docx,.zip,.rar';
            input.onchange = function(e) {
                const files = Array.from(e.target.files);
                files.forEach(file => {
                    // Use the full path if available, otherwise use the name
                    const filePath = file.path || file.webkitRelativePath || file.name;
                    showStatus(`File selected: ${filePath}`, 'info');
                });
                handleFiles(files);
            };
            input.click();
        }
        
        function handleFiles(files) {
            files.forEach(file => {
                // Use the full path if available, otherwise use the name
                const filePath = file.path || file.webkitRelativePath || file.name;
                const fileData = {
                    id: Date.now() + Math.random(),
                    name: file.name,
                    size: file.size,
                    type: file.type,
                    file: file,
                    path: filePath,
                    uploaded: false
                };
                
                window.uploadedFiles.push(fileData);
                displayFile(fileData);
                
                // Show save location dialog after file selection
                showSaveLocationDialog(fileData);
            });
        }
        
        function showSaveLocationDialog(fileData) {
            // Create a modal dialog for save location
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.innerHTML = `
                <div class="modal-content">
                    <h3>File Selected: ${fileData.name}</h3>
                    <p>Choose where to save the processed file:</p>
                    <div class="form-group">
                        <label>Save Location:</label>
                        <input type="text" id="saveLocation" placeholder="Enter save location or leave blank for default" />
                    </div>
                    <div class="form-group">
                        <label>File Name (optional):</label>
                        <input type="text" id="saveFileName" placeholder="Enter custom filename or leave blank for auto-generated" />
                    </div>
                    <div class="modal-actions">
                        <button onclick="confirmSaveLocation('${fileData.id}')" class="btn-primary">Continue</button>
                        <button onclick="cancelSaveLocation()" class="btn-secondary">Cancel</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Focus on the save location input
            setTimeout(() => {
                document.getElementById('saveLocation').focus();
            }, 100);
        }
        
        function confirmSaveLocation(fileId) {
            const fileData = window.uploadedFiles.find(f => f.id == fileId);
            if (fileData) {
                const saveLocation = document.getElementById('saveLocation').value.trim();
                const saveFileName = document.getElementById('saveFileName').value.trim();
                
                // Store save preferences
                fileData.saveLocation = saveLocation || 'uploads/';
                fileData.saveFileName = saveFileName || fileData.name;
                
                showStatus(`File "${fileData.name}" ready for processing. Select it and choose an operation.`, 'success');
            }
            
            // Remove modal
            const modal = document.querySelector('.modal-overlay');
            if (modal) {
                modal.remove();
            }
        }
        
        function cancelSaveLocation() {
            // Remove modal
            const modal = document.querySelector('.modal-overlay');
            if (modal) {
                modal.remove();
            }
            showStatus('File selection cancelled.', 'info');
        }
        
        function displayFile(fileData) {
            const fileList = document.getElementById('fileList');
            const fileItem = document.createElement('div');
            fileItem.className = 'file-item';
            fileItem.id = `file-${fileData.id}`;
            
            // Determine file type and available actions
            const fileType = fileData.type || 'unknown';
            const isEncrypted = fileType === 'encrypted';
            const isDecrypted = fileType === 'decrypted';
            
            // Build action buttons based on file type
            let actionButtons = `
                <button class="btn-select" onclick="selectFile('${fileData.id}')">Select</button>
                <button class="btn-view" onclick="viewFile('${fileData.id}')" style="background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);">View</button>
                <button class="btn-download" onclick="downloadFile('${fileData.id}')" style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);">Download</button>
            `;
            
            // Add encryption/decryption buttons based on file type
            if (!isEncrypted) {
                actionButtons += `<button class="btn-encrypt" onclick="encryptFile('${fileData.id}')" style="background: linear-gradient(135deg, #f6ad55 0%, #ed8936 100%);">Encrypt</button>`;
            }
            
            if (isEncrypted) {
                actionButtons += `<button class="btn-decrypt" onclick="decryptFile('${fileData.id}')" style="background: linear-gradient(135deg, #ed64a6 0%, #d53f8c 100%);">Decrypt</button>`;
            }
            
            // Add analysis and scan buttons
            actionButtons += `
                <button class="btn-analyze" onclick="analyzeFile('${fileData.id}')" style="background: linear-gradient(135deg, #9f7aea 0%, #805ad5 100%);">Analyze</button>
                <button class="btn-scan" onclick="scanFile('${fileData.id}')" style="background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);">Scan</button>
                <button class="btn-delete" onclick="removeFile('${fileData.id}')" style="background: linear-gradient(135deg, #a0aec0 0%, #718096 100%);">Delete</button>
            `;
            
            // Add file type indicator and icon
            const typeIndicator = fileType !== 'unknown' ? `<span class="file-type" style="background: ${getTypeColor(fileType)}; color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.7rem; margin-left: 8px;">${fileType.toUpperCase()}</span>` : '';
            const fileIcon = `<div class="file-icon ${fileType !== 'unknown' ? fileType : 'default'}"></div>`;
            
            fileItem.innerHTML = `
                <div class="file-info">
                    <div class="file-name">${fileIcon}${fileData.name}${typeIndicator}</div>
                    <div class="file-size">${formatFileSize(fileData.size)}</div>
                    ${fileData.algorithm ? `<div class="file-algorithm">Algorithm: ${fileData.algorithm}</div>` : ''}
                </div>
                <div class="file-actions" style="display: flex; gap: 4px; flex-wrap: wrap;">
                    ${actionButtons}
                </div>
            `;
            
            fileList.appendChild(fileItem);
        }
        
        function getTypeColor(type) {
            switch(type) {
                case 'encrypted': return '#f6ad55';
                case 'decrypted': return '#ed64a6';
                case 'analyzed': return '#9f7aea';
                case 'scanned': return '#f56565';
                default: return '#4a5568';
            }
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        function selectFile(fileId) {
            const fileData = window.uploadedFiles.find(f => f.id == fileId);
            if (fileData) {
                // Set as selected file for operations
                window.selectedFile = fileData;
                showStatus(`Selected file: ${fileData.name}`, 'success');
                
                // Update UI to show selected file
                document.querySelectorAll('.file-item').forEach(item => {
                    item.classList.remove('selected');
                });
                document.getElementById(`file-${fileId}`).classList.add('selected');
            }
        }
        
        function removeFile(fileId) {
            window.uploadedFiles = window.uploadedFiles.filter(f => f.id != fileId);
            const fileElement = document.getElementById(`file-${fileId}`);
            if (fileElement) {
                fileElement.remove();
            }
            if (window.selectedFile && window.selectedFile.id == fileId) {
                window.selectedFile = null;
            }
        }
        
        async function encryptFile(fileId) {
            const fileData = window.uploadedFiles.find(f => f.id == fileId);
            if (!fileData) {
                showStatus('File not found', 'error');
                return;
            }
            
            // Show encryption options dialog
            const algorithm = prompt('Select encryption algorithm:\n1. AES-256-GCM\n2. AES-256-CBC\n3. ChaCha20\n4. Camellia-256\n5. Blowfish\n6. ARIA-256\n\nEnter number (1-6) or algorithm name:', '1');
            if (!algorithm) return;
            
            let selectedAlgo = 'aes256';
            switch(algorithm) {
                case '1': selectedAlgo = 'aes256'; break;
                case '2': selectedAlgo = 'aes256cbc'; break;
                case '3': selectedAlgo = 'chacha20'; break;
                case '4': selectedAlgo = 'cam-256-cbc'; break;
                case '5': selectedAlgo = 'blowfish'; break;
                case '6': selectedAlgo = 'aria-256'; break;
                default: selectedAlgo = algorithm.toLowerCase();
            }
            
            try {
                showStatus(`Encrypting ${fileData.name} with ${selectedAlgo}...`, 'info');
                
                const response = await fetch('/encrypt-file', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token')
                    },
                    body: JSON.stringify({
                        file: fileData.name,
                        algorithm: selectedAlgo,
                        data: fileData.data
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // Create encrypted file entry
                    const encryptedFileData = {
                        id: Date.now() + Math.random(),
                        name: fileData.name.replace(/\.[^/.]+$/, '') + '_encrypted.enc',
                        size: result.encryptedData ? result.encryptedData.length : fileData.size,
                        data: result.encryptedData || 'encrypted_data_placeholder',
                        type: 'encrypted',
                        originalFile: fileData.name,
                        algorithm: selectedAlgo,
                        timestamp: new Date().toISOString()
                    };
                    
                    window.uploadedFiles.push(encryptedFileData);
                    displayFile(encryptedFileData);
                    
                    showStatus(`File encrypted successfully: ${encryptedFileData.name}`, 'success');
                    showOutput(result);
                } else {
                    showStatus(`Encryption failed: ${result.error}`, 'error');
                }
            } catch (error) {
                showStatus(`Encryption error: ${error.message}`, 'error');
                console.error('Encryption error:', error);
            }
        }
        
        async function decryptFile(fileId) {
            const fileData = window.uploadedFiles.find(f => f.id == fileId);
            if (!fileData) {
                showStatus('File not found', 'error');
                return;
            }
            
            if (fileData.type !== 'encrypted') {
                showStatus('File is not encrypted', 'error');
                return;
            }
            
            const algorithm = fileData.algorithm || prompt('Enter decryption algorithm:', 'aes256');
            if (!algorithm) return;
            
            try {
                showStatus(`Decrypting ${fileData.name}...`, 'info');
                
                const response = await fetch('/decrypt-file', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token')
                    },
                    body: JSON.stringify({
                        file: fileData.name,
                        algorithm: algorithm,
                        data: fileData.data
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // Create decrypted file entry
                    const decryptedFileData = {
                        id: Date.now() + Math.random(),
                        name: fileData.name.replace('_encrypted.enc', '_decrypted.txt'),
                        size: result.decryptedData ? result.decryptedData.length : fileData.size,
                        data: result.decryptedData || 'decrypted_data_placeholder',
                        type: 'decrypted',
                        originalFile: fileData.name,
                        algorithm: algorithm,
                        timestamp: new Date().toISOString()
                    };
                    
                    window.uploadedFiles.push(decryptedFileData);
                    displayFile(decryptedFileData);
                    
                    showStatus(`File decrypted successfully: ${decryptedFileData.name}`, 'success');
                    showOutput(result);
                } else {
                    showStatus(`Decryption failed: ${result.error}`, 'error');
                }
            } catch (error) {
                showStatus(`Decryption error: ${error.message}`, 'error');
                console.error('Decryption error:', error);
            }
        }
        
        async function analyzeFile(fileId) {
            const fileData = window.uploadedFiles.find(f => f.id == fileId);
            if (!fileData) {
                showStatus('File not found', 'error');
                return;
            }
            
            try {
                showStatus(`Analyzing ${fileData.name}...`, 'info');
                
                const response = await fetch('/file-analysis', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token')
                    },
                    body: JSON.stringify({
                        filepath: fileData.name,
                        data: fileData.data
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showStatus(`File analysis completed: ${fileData.name}`, 'success');
                    showOutput(result.result);
                } else {
                    showStatus(`Analysis failed: ${result.error}`, 'error');
                }
            } catch (error) {
                showStatus(`Analysis error: ${error.message}`, 'error');
                console.error('Analysis error:', error);
            }
        }
        
        async function scanFile(fileId) {
            const fileData = window.uploadedFiles.find(f => f.id == fileId);
            if (!fileData) {
                showStatus('File not found', 'error');
                return;
            }
            
            try {
                showStatus(`Scanning ${fileData.name} for malware...`, 'info');
                
                const response = await fetch('/api/security/malware-scan', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token')
                    },
                    body: JSON.stringify({
                        file: fileData.name,
                        data: fileData.data
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showStatus(`Scan completed: ${fileData.name}`, 'success');
                    showOutput(result.result);
                } else {
                    showStatus(`Scan failed: ${result.error}`, 'error');
                }
            } catch (error) {
                showStatus(`Scan error: ${error.message}`, 'error');
                console.error('Scan error:', error);
            }
        }
        
        function downloadFile(fileId) {
            const fileData = window.uploadedFiles.find(f => f.id == fileId);
            if (!fileData) {
                showStatus('File not found', 'error');
                return;
            }
            
            try {
                const blob = new Blob([fileData.data], { type: 'application/octet-stream' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = fileData.name;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showStatus(`File downloaded: ${fileData.name}`, 'success');
            } catch (error) {
                showStatus(`Download error: ${error.message}`, 'error');
                console.error('Download error:', error);
            }
        }
        
        function viewFile(fileId) {
            const fileData = window.uploadedFiles.find(f => f.id == fileId);
            if (!fileData) {
                showStatus('File not found', 'error');
                return;
            }
            
            // Create a modal to view file content
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>File Viewer: ${fileData.name}</h3>
                        <span class="close" onclick="this.parentElement.parentElement.parentElement.remove()">&times;</span>
                    </div>
                    <div class="modal-body">
                        <div class="file-info">
                            <p><strong>Name:</strong> ${fileData.name}</p>
                            <p><strong>Size:</strong> ${formatFileSize(fileData.size)}</p>
                            <p><strong>Type:</strong> ${fileData.type || 'unknown'}</p>
                            <p><strong>Uploaded:</strong> ${new Date(fileData.timestamp).toLocaleString()}</p>
                        </div>
                        <div class="file-content">
                            <h4>Content Preview:</h4>
                            <pre style="background: #1a202c; padding: 1rem; border-radius: 6px; max-height: 400px; overflow-y: auto; white-space: pre-wrap; word-wrap: break-word;">${fileData.data.substring(0, 1000)}${fileData.data.length > 1000 ? '\n\n... (truncated, use download to see full content)' : ''}</pre>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        async function uploadFromUrl(button) {
            const urlInput = document.getElementById('urlInput');
            const url = urlInput.value.trim();
            
            if (!url) {
                // Error recovery: prompt for URL
                const userUrl = prompt('Please enter a valid URL:');
                if (!userUrl) {
                    showStatus('URL is required for download', 'error');
                return;
                }
                url = userUrl;
            }
            
            const stopLoading = showLoading(button);
            
            try {
                // Download file from URL
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const blob = await response.blob();
                const fileName = url.split('/').pop() || 'downloaded_file';
                
                const fileData = {
                    id: Date.now() + Math.random(),
                    name: fileName,
                    size: blob.size,
                    type: blob.type,
                    file: blob,
                    uploaded: false
                };
                
                window.uploadedFiles.push(fileData);
                displayFile(fileData);
                
                showStatus(`File downloaded successfully: ${fileName}`, 'success');
                urlInput.value = '';
                
            } catch (error) {
                showStatus(`Failed to download file: ${error.message}`, 'error');
            } finally {
                stopLoading();
            }
        }
        
        // Initialize file upload system when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeFileUpload();
            
            // Add event listeners for security scan dropdowns
            const securityTarget = document.getElementById('securityScanTarget');
            const securityFile = document.getElementById('securityScanFile');
            const threatTarget = document.getElementById('threatDetectionTarget');
            const threatFile = document.getElementById('threatDetectionFile');
            const vulnTarget = document.getElementById('vulnerabilityCheckTarget');
            const vulnFile = document.getElementById('vulnerabilityCheckFile');
            
            if (securityTarget) {
                securityTarget.addEventListener('change', function() {
                    securityFile.disabled = this.value !== 'uploaded';
                    if (this.value === 'uploaded') {
                        refreshSecurityFileList();
                    }
                });
            }
            
            if (threatTarget) {
                threatTarget.addEventListener('change', function() {
                    threatFile.disabled = this.value !== 'uploaded';
                    if (this.value === 'uploaded') {
                        refreshThreatFileList();
                    }
                });
            }
            
            if (vulnTarget) {
                vulnTarget.addEventListener('change', function() {
                    vulnFile.disabled = this.value !== 'uploaded';
                    if (this.value === 'uploaded') {
                        refreshVulnFileList();
                    }
                });
            }
        });
        
        // Security scan file list refresh functions
        async function refreshSecurityFileList() {
            try {
                const fileSelect = document.getElementById('securityScanFile');
                const targetSelect = document.getElementById('securityScanTarget');
                
                // Clear existing options except the first one
                fileSelect.innerHTML = '<option value="">Select uploaded file...</option>';
                
                // Use the local uploadedFiles array instead of server files
                if (window.uploadedFiles && window.uploadedFiles.length > 0) {
                    window.uploadedFiles.forEach(fileData => {
                        const option = document.createElement('option');
                        option.value = fileData.name; // Use filename for now
                        option.textContent = `${fileData.name} (${formatFileSize(fileData.size)})`;
                        fileSelect.appendChild(option);
                    });
                }
                
                // Enable/disable file select based on target type
                fileSelect.disabled = targetSelect.value !== 'uploaded';
            } catch (error) {
                showStatus(`Failed to refresh file list: ${error.message}`, 'error');
            }
        }
        
        async function refreshThreatFileList() {
            try {
                const fileSelect = document.getElementById('threatDetectionFile');
                const targetSelect = document.getElementById('threatDetectionTarget');
                
                // Clear existing options except the first one
                fileSelect.innerHTML = '<option value="">Select uploaded file...</option>';
                
                // Use the local uploadedFiles array instead of server files
                if (window.uploadedFiles && window.uploadedFiles.length > 0) {
                    window.uploadedFiles.forEach(fileData => {
                        const option = document.createElement('option');
                        option.value = fileData.name; // Use filename for now
                        option.textContent = `${fileData.name} (${formatFileSize(fileData.size)})`;
                        fileSelect.appendChild(option);
                    });
                }
                
                // Enable/disable file select based on target type
                fileSelect.disabled = targetSelect.value !== 'uploaded';
            } catch (error) {
                showStatus(`Failed to refresh file list: ${error.message}`, 'error');
            }
        }
        
        async function refreshVulnFileList() {
            try {
                const fileSelect = document.getElementById('vulnerabilityCheckFile');
                const targetSelect = document.getElementById('vulnerabilityCheckTarget');
                
                // Clear existing options except the first one
                fileSelect.innerHTML = '<option value="">Select uploaded file...</option>';
                
                // Use the local uploadedFiles array instead of server files
                if (window.uploadedFiles && window.uploadedFiles.length > 0) {
                    window.uploadedFiles.forEach(fileData => {
                        const option = document.createElement('option');
                        option.value = fileData.name; // Use filename for now
                        option.textContent = `${fileData.name} (${formatFileSize(fileData.size)})`;
                        fileSelect.appendChild(option);
                    });
                }
                
                // Enable/disable file select based on target type
                fileSelect.disabled = targetSelect.value !== 'uploaded';
            } catch (error) {
                showStatus(`Failed to refresh file list: ${error.message}`, 'error');
            }
        }
        
        // Embedded CLI System
        let cliHistory = [];
        let cliHistoryIndex = -1;
        
        function initializeCLI() {
            const cliInput = document.getElementById('cliInput');
            if (cliInput) {
                cliInput.addEventListener('keydown', handleCLIKeyDown);
                cliInput.addEventListener('keypress', handleCLIKeyPress);
            }
        }
        
        function handleCLIKeyDown(e) {
            if (e.key === 'ArrowUp') {
                e.preventDefault();
                if (cliHistoryIndex < cliHistory.length - 1) {
                    cliHistoryIndex++;
                    document.getElementById('cliInput').value = cliHistory[cliHistory.length - 1 - cliHistoryIndex];
                }
            } else if (e.key === 'ArrowDown') {
                e.preventDefault();
                if (cliHistoryIndex > 0) {
                    cliHistoryIndex--;
                    document.getElementById('cliInput').value = cliHistory[cliHistory.length - 1 - cliHistoryIndex];
                } else if (cliHistoryIndex === 0) {
                    cliHistoryIndex = -1;
                    document.getElementById('cliInput').value = '';
                }
            }
        }
        
        function handleCLIKeyPress(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                executeCLI();
            }
        }
        
        async function executeCLI() {
            const cliInput = document.getElementById('cliInput');
            const command = cliInput.value.trim();
            
            if (!command) return;
            
            // Add to history
            cliHistory.push(command);
            cliHistoryIndex = -1;
            
            // Display command
            addCLILine(`RawrZ@Security:~$ ${command}`);
            
            // Clear input
            cliInput.value = '';
            
            try {
                // Parse command
                const parts = parseCommand(command);
                const result = await executeCLICommand(parts);
                
                // Display result
                if (result.success) {
                    addCLILine(result.output, 'success');
                } else {
                    addCLILine(result.error, 'error');
                }
                
                // Add to history log
                addToCLIHistory(command, result.success ? 'Success' : 'Error');
                
            } catch (error) {
                addCLILine(`Error: ${error.message}`, 'error');
                addToCLIHistory(command, `Error: ${error.message}`);
            }
        }
        
        function parseCommand(command) {
            const parts = [];
            let current = '';
            let inQuotes = false;
            let quoteChar = '';
            
            for (let i = 0; i < command.length; i++) {
                const char = command[i];
                
                if ((char === '"' || char === "'") && !inQuotes) {
                    inQuotes = true;
                    quoteChar = char;
                } else if (char === quoteChar && inQuotes) {
                    inQuotes = false;
                    quoteChar = '';
                } else if (char === ' ' && !inQuotes) {
                    if (current.trim()) {
                        parts.push(current.trim());
                        current = '';
                    }
                } else {
                    current += char;
                }
            }
            
            if (current.trim()) {
                parts.push(current.trim());
            }
            
            return parts;
        }
        
        async function executeCLICommand(parts) {
            if (parts.length === 0) {
                return { success: false, error: 'No command provided' };
            }
            
            const command = parts[0];
            const args = parts.slice(1);
            
            try {
                const result = await api('/cli', 'POST', { command, args });
                
                if (result.status === 200) {
                    return { success: true, output: result.data.result || 'Command executed successfully' };
                } else {
                    return { success: false, error: result.data.error || 'Command failed' };
                }
            } catch (error) {
                return { success: false, error: error.message };
            }
        }
        
        function addCLILine(text, type = 'normal') {
            const cliOutput = document.getElementById('cliOutput');
            const line = document.createElement('div');
            line.className = 'cli-line';
            
            const prompt = document.createElement('span');
            prompt.className = 'cli-prompt';
            prompt.textContent = 'RawrZ@Security:~$';
            
            const textSpan = document.createElement('span');
            textSpan.className = 'cli-text';
            textSpan.textContent = text;
            
            if (type === 'error') {
                textSpan.style.color = '#e53e3e';
            } else if (type === 'success') {
                textSpan.style.color = '#68d391';
            }
            
            line.appendChild(prompt);
            line.appendChild(textSpan);
            cliOutput.appendChild(line);
            
            // Scroll to bottom
            cliOutput.scrollTop = cliOutput.scrollHeight;
        }
        
        function clearCLI() {
            const cliOutput = document.getElementById('cliOutput');
            cliOutput.innerHTML = `
                <div class="cli-line">
                    <span class="cli-prompt">RawrZ@Security:~$</span>
                    <span class="cli-text">RawrZ Security Platform - Embedded CLI</span>
                </div>
                <div class="cli-line">
                    <span class="cli-prompt">RawrZ@Security:~$</span>
                    <span class="cli-text">Type 'help' for available commands or use the buttons below</span>
                </div>
            `;
        }
        
        function showCLIHelp() {
            const helpText = `
RawrZ Security Platform - Available Commands:

[CORE CRYPTO]
  encrypt <algorithm> <input> [extension] - Encrypt data or file
  decrypt <algorithm> <input> [key] [extension] - Decrypt data or file
  hash <input> [algorithm] [save] [extension] - Generate hash
  keygen <algorithm> [length] [save] [extension] - Generate encryption key
  advancedcrypto <input> [operation] - Advanced crypto operations
  sign <input> [privatekey] - Sign data with RSA
  verify <input> <signature> <publickey> - Verify digital signature

[STUB GENERATION]
  stub <target> [options] - Generate executable stub
    Options: --type=native|dotnet, --framework=cpp|asm|csharp
    Encryption: --encryption=aes256|aes128|chacha20|cam
    Anti-analysis: --antiDebug, --antiVM, --antiSandbox
    Output: --output=filename.ext (direct generation)
    Attach: --attach=target.ext (attach to existing file)

[ENCODING]
  base64encode <input> - Base64 encode data
  base64decode <input> - Base64 decode data
  hexencode <input> - Hexadecimal encode data
  hexdecode <input> - Hexadecimal decode data
  urlencode <input> - URL encode string
  urldecode <input> - URL decode string

[RANDOM GENERATION]
  random [length] - Generate random bytes
  uuid - Generate UUID
  password [length] [special] - Generate secure password

[ANALYSIS]
  analyze <input> - Analyze file (type, entropy, hashes)
  sysinfo - System information
  processes - List running processes

[NETWORK]
  ping <host> [save] [extension] - Ping host
  dns <hostname> - DNS lookup
  portscan <host> [startport] [endport] - Port scan
  traceroute <host> - Trace network route
  whois <domain> - WHOIS domain lookup

[FILE OPERATIONS]
  files - List files in uploads directory
  upload <url> - Download file from URL
  fileops <operation> <input> [output] - File operations

[TEXT OPERATIONS]
  textops <operation> <input> - Text manipulation

[VALIDATION]
  validate <input> <type> - Validate data

[UTILITIES]
  time - Get current time information
  math <expression> - Mathematical operations
  help - Show this help

Examples:
  encrypt aes256 "Hello World"
  hash "test" sha256
  sysinfo
  ping google.com
  analyze C:\\Windows\\calc.exe
  base64encode "Hello World"
  validate user@example.com email
  math "2 + 2 * 3"
            `;
            
            addCLILine(helpText);
        }
        
        function executeQuickCommand(command) {
            document.getElementById('cliInput').value = command;
            executeCLI();
        }

        // Custom Commands Functions
        function addCustomCommand() {
            const name = document.getElementById('customCommandName').value.trim();
            const command = document.getElementById('customCommandText').value.trim();
            
            if (!name || !command) {
                showStatus('Please enter both command name and command text', 'error');
                return;
            }
            
            // Get existing custom commands
            let customCommands = JSON.parse(localStorage.getItem('rawrzCustomCommands') || '[]');
            
            // Check if command name already exists
            if (customCommands.some(cmd => cmd.name === name)) {
                showStatus('Command name already exists', 'error');
                return;
            }
            
            // Add new command
            customCommands.push({
                id: Date.now(),
                name: name,
                command: command,
                created: new Date().toISOString()
            });
            
            // Save to localStorage
            localStorage.setItem('rawrzCustomCommands', JSON.stringify(customCommands));
            
            // Clear form
            document.getElementById('customCommandName').value = '';
            document.getElementById('customCommandText').value = '';
            
            // Refresh custom commands list
            loadCustomCommands();
            
            showStatus(`Custom command "${name}" added successfully`, 'success');
        }

        function loadCustomCommands() {
            const customCommands = JSON.parse(localStorage.getItem('rawrzCustomCommands') || '[]');
            const container = document.getElementById('customCommandsList');
            
            if (customCommands.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: #a0aec0; padding: 1rem;">No custom commands yet. Add one above!</div>';
                return;
            }
            
            container.innerHTML = customCommands.map(cmd => `
                <div class="custom-command-item">
                    <div class="custom-command-info">
                        <div class="custom-command-name">${cmd.name}</div>
                        <div class="custom-command-text">${cmd.command}</div>
                    </div>
                    <div class="custom-command-actions">
                        <button class="custom-command-btn custom-command-execute" onclick="executeCustomCommand('${cmd.command}')">Execute</button>
                        <button class="custom-command-btn custom-command-delete" onclick="deleteCustomCommand(${cmd.id})">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        function executeCustomCommand(command) {
            executeQuickCommand(command);
        }

        function deleteCustomCommand(commandId) {
            if (!confirm('Are you sure you want to delete this custom command?')) {
                return;
            }
            
            let customCommands = JSON.parse(localStorage.getItem('rawrzCustomCommands') || '[]');
            customCommands = customCommands.filter(cmd => cmd.id !== commandId);
            
            localStorage.setItem('rawrzCustomCommands', JSON.stringify(customCommands));
            loadCustomCommands();
            
            showStatus('Custom command deleted successfully', 'success');
        }

        // Interactive CLI Terminal Functions
        function initializeInteractiveCLI() {
            const cliTerminal = document.getElementById('cliTerminal');
            if (!cliTerminal) return;

            // Add keyboard event listener
            cliTerminal.addEventListener('keydown', handleCLIKeyDown);
            cliTerminal.addEventListener('input', handleCLIInput);
            
            // Focus the terminal
            cliTerminal.focus();
        }

        function handleCLIKeyDown(event) {
            const cliTerminal = document.getElementById('cliTerminal');
            
            if (event.key === 'Enter') {
                event.preventDefault();
                executeCurrentLine();
            } else if (event.key === 'Backspace') {
                // Handle backspace to prevent deleting prompt
                const selection = window.getSelection();
                if (selection.rangeCount > 0) {
                    const range = selection.getRangeAt(0);
                    const currentLine = getCurrentLineElement();
                    if (currentLine && range.startContainer.parentElement === currentLine) {
                        const promptSpan = currentLine.querySelector('.cli-prompt');
                        if (promptSpan && range.startOffset <= promptSpan.textContent.length) {
                            event.preventDefault();
                            return;
                        }
                    }
                }
            } else if (event.key === 'ArrowUp') {
                event.preventDefault();
                navigateHistory(-1);
            } else if (event.key === 'ArrowDown') {
                event.preventDefault();
                navigateHistory(1);
            }
        }

        function handleCLIInput(event) {
            // Auto-scroll to bottom
            const cliTerminal = document.getElementById('cliTerminal');
            cliTerminal.scrollTop = cliTerminal.scrollHeight;
        }

        function getCurrentLineElement() {
            const cliTerminal = document.getElementById('cliTerminal');
            const lines = cliTerminal.querySelectorAll('.cli-line');
            return lines[lines.length - 1];
        }

        function executeCurrentLine() {
            const currentLine = getCurrentLineElement();
            if (!currentLine) return;

            const promptSpan = currentLine.querySelector('.cli-prompt');
            const textSpan = currentLine.querySelector('.cli-text');
            
            if (!textSpan) return;

            const command = textSpan.textContent.trim();
            if (!command) {
                addNewCLILine();
                return;
            }

            // Add command to history
            addToCLIHistory(command, 'Executing...');

            // Execute the command
            executeCLICommand(command);

            // Add new line for next command
            addNewCLILine();
        }

        function executeCLICommand(command) {
            // Parse and execute the command
            const parts = command.split(' ');
            const cmd = parts[0].toLowerCase();
            const args = parts.slice(1);

            switch (cmd) {
                case 'help':
                    showCLIHelp();
                    break;
                case 'clear':
                    clearCLI();
                    break;
                case 'encrypt':
                    if (args.length >= 2) {
                        const algorithm = args[0];
                        const text = args.slice(1).join(' ');
                        executeQuickCommand(`encrypt ${algorithm} ${text}`);
                    } else {
                        addCLILine('Usage: encrypt <algorithm> <text>');
                    }
                    break;
                case 'hash':
                    if (args.length >= 2) {
                        const text = args[0];
                        const algorithm = args[1];
                        executeQuickCommand(`hash ${text} ${algorithm}`);
                    } else {
                        addCLILine('Usage: hash <text> <algorithm>');
                    }
                    break;
                case 'ping':
                    if (args.length >= 1) {
                        executeQuickCommand(`ping ${args[0]}`);
                    } else {
                        addCLILine('Usage: ping <host>');
                    }
                    break;
                case 'dns':
                    if (args.length >= 1) {
                        executeQuickCommand(`dns ${args[0]}`);
                    } else {
                        addCLILine('Usage: dns <domain>');
                    }
                    break;
                case 'sysinfo':
                    executeQuickCommand('sysinfo');
                    break;
                case 'processes':
                    executeQuickCommand('processes');
                    break;
                case 'files':
                    if (args.length >= 1) {
                        executeQuickCommand(`files ${args[0]}`);
                    } else {
                        executeQuickCommand('files');
                    }
                    break;
                case 'uuid':
                    executeQuickCommand('uuid');
                    break;
                case 'keygen':
                    if (args.length >= 1) {
                        executeQuickCommand(`keygen ${args[0]}`);
                    } else {
                        addCLILine('Usage: keygen <algorithm>');
                    }
                    break;
                case 'analyze':
                    if (args.length >= 1) {
                        executeQuickCommand(`analyze ${args[0]}`);
                    } else {
                        addCLILine('Usage: analyze <filepath>');
                    }
                    break;
                case 'base64encode':
                    if (args.length >= 1) {
                        executeQuickCommand(`base64encode ${args.join(' ')}`);
                    } else {
                        addCLILine('Usage: base64encode <text>');
                    }
                    break;
                case 'validate':
                    if (args.length >= 2) {
                        executeQuickCommand(`validate ${args[0]} ${args[1]}`);
                    } else {
                        addCLILine('Usage: validate <value> <type>');
                    }
                    break;
                case 'portscan':
                    if (args.length >= 2) {
                        executeQuickCommand(`portscan ${args[0]} ${args[1]}`);
                    } else {
                        addCLILine('Usage: portscan <host> <ports>');
                    }
                    break;
                default:
                    addCLILine(`Unknown command: ${cmd}. Type 'help' for available commands.`);
            }
        }

        function addNewCLILine() {
            const cliTerminal = document.getElementById('cliTerminal');
            const newLine = document.createElement('div');
            newLine.className = 'cli-line';
            newLine.innerHTML = `
                <span class="cli-prompt">RawrZ@Security:~$</span>
                <span class="cli-text"></span>
            `;
            cliTerminal.appendChild(newLine);
            
            // Focus on the new line
            const textSpan = newLine.querySelector('.cli-text');
            const range = document.createRange();
            const selection = window.getSelection();
            range.setStart(textSpan, 0);
            range.collapse(true);
            selection.removeAllRanges();
            selection.addRange(range);
            
            cliTerminal.scrollTop = cliTerminal.scrollHeight;
        }

        function addCLILine(text) {
            const cliTerminal = document.getElementById('cliTerminal');
            const newLine = document.createElement('div');
            newLine.className = 'cli-line';
            newLine.innerHTML = `
                <span class="cli-text" style="color: #a0aec0;">${text}</span>
            `;
            cliTerminal.appendChild(newLine);
            cliTerminal.scrollTop = cliTerminal.scrollHeight;
        }

        // CLI History navigation
        let cliTerminalHistoryIndex = -1;
        let cliCommandHistory = [];

        function navigateHistory(direction) {
            if (cliCommandHistory.length === 0) return;
            
            cliTerminalHistoryIndex += direction;
            
            if (cliTerminalHistoryIndex < 0) {
                cliTerminalHistoryIndex = -1;
                return;
            }
            
            if (cliTerminalHistoryIndex >= cliCommandHistory.length) {
                cliTerminalHistoryIndex = cliCommandHistory.length - 1;
                return;
            }
            
            const currentLine = getCurrentLineElement();
            const textSpan = currentLine.querySelector('.cli-text');
            if (textSpan) {
                textSpan.textContent = cliCommandHistory[cliTerminalHistoryIndex];
            }
        }
        
        function addToCLIHistory(command, result) {
            const cliHistory = document.getElementById('cliHistory');
            const historyItem = document.createElement('div');
            historyItem.className = 'history-item';
            
            const time = new Date().toLocaleString();
            historyItem.innerHTML = `
                <span class="history-time">[${time}]</span>
                <span class="history-command">${command}</span>
                <span class="history-result">${result}</span>
            `;
            
            cliHistory.appendChild(historyItem);
            cliHistory.scrollTop = cliHistory.scrollHeight;
        }
        
        function exportCLIHistory() {
            const historyItems = document.querySelectorAll('.history-item');
            let historyText = 'RawrZ Security Platform - CLI History\n';
            historyText += '=====================================\n\n';
            
            historyItems.forEach(item => {
                const time = item.querySelector('.history-time').textContent;
                const command = item.querySelector('.history-command').textContent;
                const result = item.querySelector('.history-result').textContent;
                historyText += `${time} | ${command} | ${result}\n`;
            });
            
            downloadFile(historyText, `rawrz-cli-history-${new Date().toISOString().split('T')[0]}.txt`, 'txt');
        }
        
        function clearCLIHistory() {
            const cliHistory = document.getElementById('cliHistory');
            cliHistory.innerHTML = `
                <div class="history-item">
                    <span class="history-time">[${new Date().toLocaleString()}]</span>
                    <span class="history-command">help</span>
                    <span class="history-result">Available commands displayed</span>
                </div>
            `;
        }
        
        function toggleCLIHistory() {
            const cliHistory = document.getElementById('cliHistory');
            cliHistory.style.display = cliHistory.style.display === 'none' ? 'block' : 'none';
        }
        
        // Initialize CLI when page loads
        document.addEventListener('DOMContentLoaded', initializeCLI);
        
        // Save System
        let lastResult = null;
        let lastOperation = null;
        
        function saveCurrentResult(button) {
            const fileName = document.getElementById('saveFileName').value.trim();
            const fileType = document.getElementById('saveFileType').value;
            const includeTimestamp = document.getElementById('includeTimestamp').checked;
            const includeMetadata = document.getElementById('includeMetadata').checked;
            
            if (!fileName) {
                // Error recovery: prompt for filename
                const userFileName = prompt('Please enter a filename:');
                if (!userFileName) {
                    showStatus('Filename is required for saving', 'error');
                return;
                }
                fileName = userFileName;
            }
            
            if (!lastResult) {
                showStatus('No result to save. Perform an operation first.', 'error');
                return;
            }
            
            const stopLoading = showLoading(button);
            
            try {
                let content = lastResult;
                let finalFileName = fileName;
                
                // Add timestamp if requested
                if (includeTimestamp) {
                    const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
                    finalFileName += `_${timestamp}`;
                }
                
                // Add metadata if requested
                if (includeMetadata && lastOperation) {
                    const metadata = {
                        operation: lastOperation,
                        timestamp: new Date().toISOString(),
                        platform: 'RawrZ Security Platform',
                        version: '1.0.0'
                    };
                    
                    if (fileType === 'json') {
                        content = JSON.stringify({
                            metadata: metadata,
                            result: lastResult
                        }, null, 2);
                    } else {
                        content = `# RawrZ Security Platform Result\n` +
                                 `# Operation: ${lastOperation}\n` +
                                 `# Timestamp: ${metadata.timestamp}\n` +
                                 `# Platform: ${metadata.platform}\n` +
                                 `# Version: ${metadata.version}\n\n` +
                                 `${content}`;
                    }
                }
                
                // Format content based on file type
                content = formatContentForType(content, fileType);
                
                // Create and download file
                downloadFile(content, `${finalFileName}.${fileType}`, fileType);
                
                showStatus(`Result saved as ${finalFileName}.${fileType}`, 'success');
                
            } catch (error) {
                showStatus(`Failed to save result: ${error.message}`, 'error');
            } finally {
                stopLoading();
            }
        }
        
        function formatContentForType(content, fileType) {
            switch (fileType) {
                case 'json':
                    if (typeof content === 'string') {
                        try {
                            return JSON.stringify(JSON.parse(content), null, 2);
                        } catch {
                            return JSON.stringify({ result: content }, null, 2);
                        }
                    }
                    return JSON.stringify(content, null, 2);
                    
                case 'csv':
                    if (typeof content === 'object') {
                        return convertToCSV(content);
                    }
                    return content;
                    
                case 'xml':
                    if (typeof content === 'object') {
                        return convertToXML(content);
                    }
                    return `<result><![CDATA[${content}]]></result>`;
                    
                case 'log':
                    const timestamp = new Date().toISOString();
                    return `[${timestamp}] RawrZ Security Platform Result:\n${content}`;
                    
                default:
                    return content;
            }
        }
        
        function convertToCSV(data) {
            if (Array.isArray(data)) {
                if (data.length === 0) return '';
                const headers = Object.keys(data[0]);
                const csvContent = [
                    headers.join(','),
                    ...data.map(row => headers.map(header => `"${row[header] || ''}"`).join(','))
                ].join('\n');
                return csvContent;
            }
            return data;
        }
        
        function convertToXML(data, rootName = 'result') {
            if (typeof data === 'object' && data !== null) {
                let xml = `<${rootName}>`;
                for (const [key, value] of Object.entries(data)) {
                    if (typeof value === 'object') {
                        xml += convertToXML(value, key);
                    } else {
                        xml += `<${key}><![CDATA[${value}]]></${key}>`;
                    }
                }
                xml += `</${rootName}>`;
                return xml;
            }
            return `<${rootName}><![CDATA[${data}]]></${rootName}>`;
        }
        
        function downloadFile(content, fileName, fileType) {
            let blob;
            
            if (fileType === 'bin' || fileType === 'exe') {
                // For binary files, convert string to ArrayBuffer
                const encoder = new TextEncoder();
                blob = new Blob([encoder.encode(content)], { type: 'application/octet-stream' });
            } else {
                blob = new Blob([content], { type: getMimeType(fileType) });
            }
            
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        function getMimeType(fileType) {
            const mimeTypes = {
                'txt': 'text/plain',
                'json': 'application/json',
                'enc': 'application/octet-stream',
                'exe': 'application/octet-stream',
                'bin': 'application/octet-stream',
                'log': 'text/plain',
                'csv': 'text/csv',
                'xml': 'application/xml'
            };
            return mimeTypes[fileType] || 'text/plain';
        }
        
        function setLastResult(result, operation) {
            lastResult = result;
            lastOperation = operation;
            
            // Auto-populate filename based on operation
            if (operation) {
                const timestamp = new Date().toISOString().split('T')[0];
                document.getElementById('saveFileName').value = `${operation}_${timestamp}`;
            }
        }
        
        // Connection status tracking
        let connectionStatus = 'unknown';
        let lastSuccessfulRequest = null;
        
        // API helper function with retry mechanism
        async function api(endpoint, method = 'GET', body = null, retries = 3) {
            const headers = { 'Content-Type': 'application/json' };
            if (authToken) headers['Authorization'] = `Bearer ${authToken}`;
            
            console.log('API Call:', endpoint, method, body, headers);
            
            for (let attempt = 1; attempt <= retries; attempt++) {
            try {
                // Add timeout to prevent hanging requests
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 30000); // 30 second timeout
                
                const response = await fetch(endpoint, {
                    method,
                    headers,
                    body: body ? JSON.stringify(body) : undefined,
                    signal: controller.signal
                });
                
                clearTimeout(timeoutId);
                
                const text = await response.text();
                let data;
                try {
                    data = JSON.parse(text);
                } catch {
                    data = { text };
                }
                
                    console.log('API Response:', response.status, JSON.stringify(data, null, 2));
                    
                    // Update connection status on success
                    if (response.ok) {
                        connectionStatus = 'connected';
                        lastSuccessfulRequest = Date.now();
                        updateConnectionStatus();
                    }
                    
                return { status: response.status, data };
            } catch (error) {
                    console.error(`API Error (attempt ${attempt}/${retries}):`, error);
                    
                    // Update connection status on error
                    connectionStatus = 'disconnected';
                    updateConnectionStatus();
                    
                    // If this is the last attempt, return the error
                    if (attempt === retries) {
                // Provide more specific error messages
                let errorMessage = error.message;
                if (error.name === 'AbortError') {
                    errorMessage = 'Request timed out. Please try again.';
                        } else if (error.message.includes('fetch') || error.message.includes('Failed to fetch')) {
                            errorMessage = 'Cannot connect to server. Please ensure the RawrZ server is running on port 8080.';
                        } else if (error.message.includes('CORS')) {
                            errorMessage = 'CORS error. Please check server configuration.';
                        } else if (error.message.includes('NetworkError')) {
                            errorMessage = 'Network error. Please check your internet connection.';
                        } else if (error.message.includes('TypeError')) {
                            errorMessage = 'Connection error. Server may be down or unreachable.';
                }
                
                return { status: 0, data: { error: errorMessage } };
                    }
                    
                    // Wait before retrying (exponential backoff)
                    await new Promise(resolve => setTimeout(resolve, Math.pow(2, attempt) * 1000));
                }
            }
        }
        
        // Update connection status indicator
        function updateConnectionStatus() {
            const statusElement = document.getElementById('connectionStatus');
            if (!statusElement) return;
            
            const now = Date.now();
            const timeSinceLastSuccess = lastSuccessfulRequest ? now - lastSuccessfulRequest : Infinity;
            
            let statusHtml = '';
            if (connectionStatus === 'connected') {
                statusHtml = '<div class="status connected">Connected to RawrZ Server</div>';
            } else if (connectionStatus === 'disconnected') {
                statusHtml = '<div class="status error">Disconnected from RawrZ Server</div>';
            } else {
                statusHtml = '<div class="status warning">Connection status unknown</div>';
            }
            
            statusElement.innerHTML = statusHtml;
        }
        
        // Check server health periodically
        async function checkServerHealth() {
            try {
                const response = await fetch('/health', { method: 'GET' });
                if (response.ok) {
                    connectionStatus = 'connected';
                    lastSuccessfulRequest = Date.now();
                } else {
                    connectionStatus = 'disconnected';
                }
            } catch (error) {
                connectionStatus = 'disconnected';
            }
            updateConnectionStatus();
        }
        
        // Check server health every 30 seconds
        setInterval(checkServerHealth, 30000);
        
        // Initial health check
        checkServerHealth();
        
        // Utility functions
        function showStatus(message, type = 'info') {
            console.log('showStatus called:', message, type);
            const status = document.getElementById('connectionStatus');
            status.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        function showNotification(message, type = 'info') {
            console.log('showNotification called:', message, type);
            const status = document.getElementById('connectionStatus');
            status.innerHTML = `<div class="status ${type}">${message}</div>`;
        }
        
        function showOutput(data) {
            const output = document.getElementById('output');
            output.textContent = JSON.stringify(data, null, 2);
        }
        
        function showLoading(button) {
            console.log('showLoading called with button:', button);
            const originalText = button.textContent;
            button.disabled = true;
            button.innerHTML = '<span class="loading"></span> Processing...';
            return () => {
                console.log('stopLoading called');
                button.disabled = false;
                button.textContent = originalText;
            };
        }
        
        // Tab management
        function showTab(tabName, button = null) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            if (button) {
                button.classList.add('active');
            }
        }
        
        // Authentication
        function saveToken() {
            authToken = document.getElementById('authToken').value.trim();
            localStorage.setItem('authToken', authToken);
            showStatus('Token saved successfully', 'success');
        }
        
        async function checkHealth(button = null) {
            console.log('checkHealth called with button:', button);
            const stopLoading = button ? showLoading(button) : () => {};
            const result = await api('/health');
            stopLoading();
            
            if (result.status === 200) {
                showStatus('Connection successful! RawrZ API is running.', 'success');
                showOutput(result.data);
                setLastResult(result.data, 'health_check');
            } else if (result.status === 0) {
                showStatus('Connection failed: ' + result.data.error, 'error');
                showOutput({
                    error: result.data.error,
                    troubleshooting: {
                        'Server not running': 'Start the server with: node server.js',
                        'Wrong port': 'Check if server is running on port 8080',
                        'Network issues': 'Check your internet connection',
                        'Firewall blocking': 'Check firewall settings'
                    }
                });
                setLastResult(result.data, 'health_check_failed');
            } else {
                showStatus('Connection failed. Check your token or server status.', 'error');
                showOutput(result.data);
                setLastResult(result.data, 'health_check_failed');
            }
        }
        
        // Cryptography functions
        async function runEncrypt(button = null) {
            console.log('runEncrypt called with button:', button);
            const stopLoading = button ? showLoading(button) : () => {};
            const algorithm = document.getElementById('encAlgo').value;
            const input = document.getElementById('encInput').value;
            const extension = document.getElementById('encExtension').value;
            
            console.log('Encrypt values:', { algorithm, input, extension });
            
            // Check if we have a selected file
            if (window.selectedFile && !input) {
                // Encrypt the selected file
                const formData = new FormData();
                formData.append('file', window.selectedFile.file);
                formData.append('algorithm', algorithm);
                formData.append('extension', extension);
                
                try {
                    const response = await fetch('/encrypt-file', {
                        method: 'POST',
                        headers: { 'Authorization': `Bearer ${authToken}` },
                        body: formData
                    });
                    
                    const result = await response.json();
                    stopLoading();
                    
                    if (response.ok) {
                        showStatus('File encryption successful!', 'success');
                        showOutput(result);
                        setLastResult(result, 'file_encryption');
                        
                        // Show save dialog instead of auto-downloading
                        if (result.encryptedData) {
                            // Set the default filename based on the selected file and extension
                            const defaultName = window.selectedFile.name.replace(/\.[^/.]+$/, '') + extension;
                            document.getElementById('saveFileName').value = defaultName;
                            
                            // Show save section and prompt user
                            showStatus('File encrypted successfully! Choose where to save the result below.', 'success');
                            document.querySelector('.save-section').scrollIntoView({ behavior: 'smooth' });
                        }
                    } else {
                        showStatus('File encryption failed', 'error');
                        showOutput(result);
                        setLastResult(result, 'file_encryption_failed');
                    }
                } catch (error) {
                    stopLoading();
                    showStatus(`File encryption error: ${error.message}`, 'error');
                    setLastResult({ error: error.message }, 'file_encryption_error');
                }
                return;
            }
            
            if (!input) {
                console.log('No input provided');
                // Error recovery: prompt for input
                const userInput = prompt('Please enter text to encrypt:');
                if (!userInput) {
                    showStatus('Input is required for encryption', 'error');
                stopLoading();
                return;
                }
                input = userInput;
            }
            
            console.log('Proceeding with text encryption');
            
            const result = await api('/encrypt', 'POST', { algorithm, input, extension });
            console.log('Encrypt API result:', result);
            stopLoading();
            
            if (result.status === 200) {
                showStatus('Encryption successful!', 'success');
                showOutput(result.data);
                setLastResult(result.data, 'text_encryption');
            } else {
                showStatus('Encryption failed', 'error');
                showOutput(result.data);
                setLastResult(result.data, 'text_encryption_failed');
            }
        }
        
        async function runDecrypt(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            const algorithm = document.getElementById('decAlgo').value;
            const input = document.getElementById('decInput').value;
            const key = document.getElementById('decKey').value;
            const iv = document.getElementById('decIv').value;
            
            if (!input) {
                // Error recovery: prompt for encrypted data
                const userInput = prompt('Please enter encrypted data to decrypt:');
                if (!userInput) {
                    showStatus('Encrypted data is required for decryption', 'error');
                stopLoading();
                return;
                }
                input = userInput;
            }
            
            const result = await api('/decrypt', 'POST', { algorithm, input, key, iv });
            stopLoading();
            showOutput(result.data);
        }
        
        async function runKeygen(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            const algorithm = document.getElementById('keyAlgo').value;
            const length = parseInt(document.getElementById('keyLength').value);
            
            const result = await api('/keygen', 'POST', { algorithm, length, save: true });
            stopLoading();
            showOutput(result.data);
        }
        
        async function runHash(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            const algorithm = document.getElementById('hashAlgo').value;
            const input = document.getElementById('hashInput').value;
            
            if (!input) {
                // Error recovery: prompt for input to hash
                const userInput = prompt('Please enter text to hash:');
                if (!userInput) {
                    showStatus('Input is required for hashing', 'error');
                stopLoading();
                return;
                }
                input = userInput;
            }
            
            const result = await api('/hash', 'POST', { input, algorithm });
            stopLoading();
            showOutput(result.data);
        }
        
        async function runRandom(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            const length = parseInt(document.getElementById('keyLength').value);
            
            const result = await api('/random', 'POST', { length });
            stopLoading();
            showOutput(result.data);
        }
        
        async function runUUID(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            const result = await api('/uuid');
            stopLoading();
            showOutput(result.data);
        }
        
        async function runPassword(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            const result = await api('/password', 'POST', { length: 16, includeSpecial: true });
            stopLoading();
            showOutput(result.data);
        }
        
        // Encoding functions
        async function runBase64Encode(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            let input = document.getElementById('encodeInput').value;
            
            if (!input) {
                // Error recovery: prompt for input to encode
                const userInput = prompt('Please enter text to encode:');
                if (!userInput) {
                    showStatus('Input is required for encoding', 'error');
                stopLoading();
                return;
                }
                input = userInput;
            }
            
            try {
                const result = await api('/base64encode', 'POST', { input });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Base64 encoding successful!', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'base64_encode');
                } else {
                    showStatus('Base64 encoding failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'base64_encode_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Base64 encoding error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'base64_encode_error');
            }
        }
        
        async function runBase64Decode(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            let input = document.getElementById('encodeInput').value;
            
            if (!input) {
                // Error recovery: prompt for input to decode
                const userInput = prompt('Please enter text to decode:');
                if (!userInput) {
                    showStatus('Input is required for decoding', 'error');
                stopLoading();
                return;
                }
                input = userInput;
            }
            
            try {
                const result = await api('/base64decode', 'POST', { input });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Base64 decoding successful!', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'base64_decode');
                } else {
                    showStatus('Base64 decoding failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'base64_decode_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Base64 decoding error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'base64_decode_error');
            }
        }
        
        async function runHexEncode(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            let input = document.getElementById('encodeInput').value;
            
            if (!input) {
                // Error recovery: prompt for input to encode
                const userInput = prompt('Please enter text to encode:');
                if (!userInput) {
                    showStatus('Input is required for encoding', 'error');
                stopLoading();
                return;
                }
                input = userInput;
            }
            
            try {
                const result = await api('/hexencode', 'POST', { input });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Hex encoding successful!', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'hex_encode');
                } else {
                    showStatus('Hex encoding failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'hex_encode_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Hex encoding error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'hex_encode_error');
            }
        }
        
        async function runHexDecode(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            let input = document.getElementById('encodeInput').value;
            
            if (!input) {
                // Error recovery: prompt for input to decode
                const userInput = prompt('Please enter text to decode:');
                if (!userInput) {
                    showStatus('Input is required for decoding', 'error');
                stopLoading();
                return;
                }
                input = userInput;
            }
            
            try {
                const result = await api('/hexdecode', 'POST', { input });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Hex decoding successful!', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'hex_decode');
                } else {
                    showStatus('Hex decoding failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'hex_decode_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Hex decoding error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'hex_decode_error');
            }
        }
        
        async function runUrlEncode(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            let input = document.getElementById('encodeInput').value;
            
            if (!input) {
                // Error recovery: prompt for input to encode
                const userInput = prompt('Please enter text to encode:');
                if (!userInput) {
                    showStatus('Input is required for encoding', 'error');
                stopLoading();
                return;
                }
                input = userInput;
            }
            
            const result = await api('/urlencode', 'POST', { input });
            stopLoading();
            showOutput(result.data);
        }
        
        async function runUrlDecode(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            let input = document.getElementById('encodeInput').value;
            
            if (!input) {
                // Error recovery: prompt for input to decode
                const userInput = prompt('Please enter text to decode:');
                if (!userInput) {
                    showStatus('Input is required for decoding', 'error');
                stopLoading();
                return;
                }
                input = userInput;
            }
            
            const result = await api('/urldecode', 'POST', { input });
            stopLoading();
            showOutput(result.data);
        }
        
        // Digital signatures
        async function runSign(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            let input = document.getElementById('signInput').value;
            let privateKey = document.getElementById('signPrivateKey').value;
            
            if (!input) {
                // Error recovery: prompt for input to sign
                const userInput = prompt('Please enter data to sign:');
                if (!userInput) {
                    showStatus('Input is required for signing', 'error');
                stopLoading();
                return;
                }
                input = userInput;
            }
            
            if (!privateKey) {
                // Error recovery: prompt for private key
                const userKey = prompt('Please enter private key (optional):');
                if (userKey) {
                    privateKey = userKey;
                }
            }
            
            const result = await api('/sign', 'POST', { input, privateKey });
            stopLoading();
            showOutput(result.data);
        }
        
        async function runVerify(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            const input = document.getElementById('signInput').value;
            
            if (!input) {
                showStatus('Please provide input data to verify', 'error');
                stopLoading();
                return;
            }
            
            // Only prompt for missing values (error case)
            let signature = '';
            let publicKey = '';
            
            if (!signature) {
                signature = prompt('Enter signature to verify:');
                if (!signature) {
                    showStatus('Signature is required for verification', 'error');
                    stopLoading();
                    return;
                }
            }
            
            if (!publicKey) {
                publicKey = prompt('Enter public key:');
                if (!publicKey) {
                    showStatus('Public key is required for verification', 'error');
                    stopLoading();
                    return;
                }
            }
            
            const result = await api('/verify', 'POST', { input, signature, publicKey });
            stopLoading();
            showOutput(result.data);
        }
        
        // Stub generation
        async function runStub(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            let target = document.getElementById('stubTarget').value;
            const type = document.getElementById('stubType').value;
            const framework = document.getElementById('stubFramework').value;
            const encryption = document.getElementById('stubEncryption').value;
            const output = document.getElementById('stubOutput').value;
            const attach = document.getElementById('stubAttach').value;
            const antiDebug = document.getElementById('stubAntiDebug').checked;
            const antiVM = document.getElementById('stubAntiVM').checked;
            const antiSandbox = document.getElementById('stubAntiSandbox').checked;
            
            if (!target) {
                // Error recovery: prompt for target file
                const userTarget = prompt('Please enter target file:');
                if (!userTarget) {
                    showStatus('Target file is required for stub generation', 'error');
                stopLoading();
                return;
                }
                target = userTarget;
            }
            
            const options = {
                type,
                framework,
                encryption,
                antiDebug,
                antiVM,
                antiSandbox
            };
            
            // Add advanced options if available
            const hotPatch = document.getElementById('stubHotPatch');
            const memoryProtect = document.getElementById('stubMemoryProtect');
            const obfuscation = document.getElementById('stubObfuscation');
            const packing = document.getElementById('stubPacking');
            
            if (hotPatch) options.hotPatch = hotPatch.checked;
            if (memoryProtect) options.memoryProtect = memoryProtect.checked;
            if (obfuscation) options.obfuscation = obfuscation.checked;
            if (packing) options.packing = packing.checked;
            
            if (output) options.output = output;
            if (attach) options.attach = attach;
            
            const result = await api('/stub', 'POST', { target, options });
            stopLoading();
            showOutput(result.data);
        }
        
        async function runAdvancedStub(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            const target = document.getElementById('stubTarget').value;
            const type = document.getElementById('stubType').value;
            const framework = document.getElementById('stubFramework').value;
            const encryption = document.getElementById('stubEncryption').value;
            const polymorphic = document.getElementById('stubPolymorphic').value;
            const stealth = document.getElementById('stubStealth').value;
            const compression = document.getElementById('stubCompression').value;
            const hotPatch = document.getElementById('stubHotPatch').checked;
            const memoryProtect = document.getElementById('stubMemoryProtect').checked;
            const obfuscation = document.getElementById('stubObfuscation').checked;
            const packing = document.getElementById('stubPacking').checked;
            
            if (!target) {
                showStatus('Please enter target file', 'error');
                stopLoading();
                return;
            }
            
            const options = {
                type,
                framework,
                encryption,
                polymorphic,
                stealth,
                compression,
                hotPatch,
                memoryProtect,
                obfuscation,
                packing
            };
            
            const result = await api('/stub', 'POST', { target, options });
            stopLoading();
            showOutput(result.data);
        }
        
        // Network functions
        async function runPing(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            let host = document.getElementById('networkHost').value;
            
            if (!host) {
                // Error recovery: prompt for host to ping
                const userHost = prompt('Please enter host to ping:');
                if (!userHost) {
                    showStatus('Host is required for ping', 'error');
                stopLoading();
                return;
                }
                host = userHost;
            }
            
            const result = await api(`/ping?host=${encodeURIComponent(host)}`);
            stopLoading();
            showOutput(result.data);
        }
        
        async function runDns(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            let hostname = document.getElementById('networkHost').value;
            
            if (!hostname) {
                // Error recovery: prompt for hostname to lookup
                const userHostname = prompt('Please enter hostname to lookup:');
                if (!userHostname) {
                    showStatus('Hostname is required for DNS lookup', 'error');
                stopLoading();
                return;
                }
                hostname = userHostname;
            }
            
            const result = await api(`/dns?hostname=${encodeURIComponent(hostname)}`);
            stopLoading();
            showOutput(result.data);
        }
        
        async function runTraceroute(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            let host = document.getElementById('networkHost').value;
            
            if (!host) {
                // Error recovery: prompt for host for traceroute
                const userHost = prompt('Please enter host for traceroute:');
                if (!userHost) {
                    showStatus('Host is required for traceroute', 'error');
                stopLoading();
                return;
                }
                host = userHost;
            }
            
            const result = await api('/traceroute', 'POST', { host });
            stopLoading();
            showOutput(result.data);
        }
        
        async function runWhois(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            const domain = document.getElementById('networkHost').value;
            
            if (!domain) {
                showStatus('Please enter domain for WHOIS', 'error');
                stopLoading();
                return;
            }
            
            const result = await api('/whois', 'POST', { domain });
            stopLoading();
            showOutput(result.data);
        }
        
        async function runPortScan(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            let host = document.getElementById('scanHost').value;
            const startPort = parseInt(document.getElementById('scanStartPort').value);
            const endPort = parseInt(document.getElementById('scanEndPort').value);
            const scanType = document.getElementById('scanType').value;
            
            if (!host) {
                // Error recovery: prompt for host to scan
                const userHost = prompt('Please enter host to scan:');
                if (!userHost) {
                    showStatus('Host is required for port scan', 'error');
                stopLoading();
                return;
                }
                host = userHost;
            }
            
            const result = await api('/portscan', 'POST', { host, startPort, endPort, scanType });
            stopLoading();
            showOutput(result.data);
        }
        
        // System functions
        async function runSysInfo(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            const result = await api('/sysinfo');
            stopLoading();
            showOutput(result.data);
        }
        
        async function runProcesses(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            const result = await api('/processes');
            stopLoading();
            showOutput(result.data);
        }
        
        async function runTime(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            const result = await api('/time');
            stopLoading();
            showOutput(result.data);
        }
        
        // File operations
        async function runFileOps(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            const operation = document.getElementById('fileOp').value;
            let input = document.getElementById('fileInput').value;
            const output = document.getElementById('fileOutput').value;
            const content = document.getElementById('fileContent').value;
            
            if (!input) {
                // Error recovery: prompt for input file
                const userInput = prompt('Please enter input file:');
                if (!userInput) {
                    showStatus('Input file is required for file operations', 'error');
                stopLoading();
                return;
                }
                input = userInput;
            }
            
            const body = { operation, input };
            if (output) body.output = output;
            if (content) body.content = content;
            
            const result = await api('/fileops', 'POST', body);
            stopLoading();
            showOutput(result.data);
        }
        
        async function listFiles(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            const result = await api('/files');
            stopLoading();
            
            if (result.status === 200 && result.data.success) {
                const fileList = document.getElementById('fileList');
                fileList.innerHTML = '';
                
                result.data.files.forEach(file => {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'file-item';
                    fileItem.innerHTML = `
                        <span class="file-name">${file.name}</span>
                        <span class="file-size">${file.size} bytes</span>
                    `;
                    fileList.appendChild(fileItem);
                });
            }
            
            showOutput(result.data);
        }
        
        // Analysis functions
        async function runAnalyze(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            const input = document.getElementById('analyzeFile').value;
            const analysisType = document.getElementById('analysisType').value;
            
            if (!input) {
                showStatus('Please enter file to analyze', 'error');
                stopLoading();
                return;
            }
            
            const result = await api('/analyze', 'POST', { input, analysisType });
            stopLoading();
            showOutput(result.data);
        }
        
        async function runValidate(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            let input = document.getElementById('validateInput').value;
            const type = document.getElementById('validateType').value;
            
            if (!input) {
                // Error recovery: prompt for data to validate
                const userInput = prompt('Please enter data to validate:');
                if (!userInput) {
                    showStatus('Input is required for validation', 'error');
                stopLoading();
                return;
                }
                input = userInput;
            }
            
            const result = await api('/validate', 'POST', { input, type });
            stopLoading();
            showOutput(result.data);
        }
        
        // Utility functions
        async function runTextOps(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            const operation = document.getElementById('textOp').value;
            let input = document.getElementById('textInput').value;
            
            if (!input) {
                // Error recovery: prompt for text to process
                const userInput = prompt('Please enter text to process:');
                if (!userInput) {
                    showStatus('Input is required for text processing', 'error');
                stopLoading();
                return;
                }
                input = userInput;
            }
            
            const result = await api('/textops', 'POST', { operation, input });
            stopLoading();
            showOutput(result.data);
        }
        
        async function runMath(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            let expression = document.getElementById('mathExpression').value;
            
            if (!expression) {
                // Error recovery: prompt for mathematical expression
                const userExpression = prompt('Please enter mathematical expression:');
                if (!userExpression) {
                    showStatus('Expression is required for math calculation', 'error');
                stopLoading();
                return;
                }
                expression = userExpression;
            }
            
            const result = await api('/math', 'POST', { expression });
            stopLoading();
            showOutput(result.data);
        }
        
        async function runCLI(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            let command = document.getElementById('cliCommand').value;
            
            if (!command) {
                // Error recovery: prompt for CLI command
                const userCommand = prompt('Please enter CLI command:');
                if (!userCommand) {
                    showStatus('Command is required for CLI execution', 'error');
                stopLoading();
                return;
                }
                command = userCommand;
            }
            
            const args = command.split(' ').slice(1);
            const cmd = command.split(' ')[0];
            
            const result = await api('/cli', 'POST', { command: cmd, args });
            stopLoading();
            showOutput(result.data);
        }
        
        // OpenSSL Management Functions
        async function getOpenSSLStatus(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const response = await api('/openssl-management/status', 'GET');
                const status = response.status;
                
                let statusHtml = '<div class="status-info">';
                statusHtml += `<h4>OpenSSL Management Status</h4>`;
                statusHtml += `<p><strong>Engine:</strong> ${status.engine} v${status.version}</p>`;
                statusHtml += `<p><strong>Initialized:</strong> ${status.initialized ? 'Yes' : 'No'}</p>`;
                statusHtml += `<p><strong>Mode:</strong> ${status.configuration.mode}</p>`;
                statusHtml += `<p><strong>Custom Algorithms:</strong> ${status.configuration.customAlgorithms ? 'Enabled' : 'Disabled'}</p>`;
                statusHtml += `<p><strong>Auto Fallback:</strong> ${status.configuration.autoFallback ? 'Enabled' : 'Disabled'}</p>`;
                statusHtml += `<p><strong>Total Algorithms:</strong> ${status.algorithms.total}</p>`;
                statusHtml += `<p><strong>OpenSSL Algorithms:</strong> ${status.algorithms.openssl}</p>`;
                statusHtml += `<p><strong>Custom Algorithms:</strong> ${status.algorithms.custom}</p>`;
                statusHtml += `<p><strong>Active Engines:</strong> ${status.engines.registered}</p>`;
                statusHtml += `<p><strong>Success Rate:</strong> ${status.performance.successRate.toFixed(2)}%</p>`;
                statusHtml += `<p><strong>Average Performance:</strong> ${status.performance.averageEncryptionTime}ms</p>`;
                statusHtml += '</div>';
                
                document.getElementById('openssl-status-display').innerHTML = statusHtml;
                showStatus('OpenSSL status retrieved successfully', 'success');
            } catch (error) {
                showStatus(`Failed to get OpenSSL status: ${error.message}`, 'error');
            } finally {
                stopLoading();
            }
        }

        async function updateOpenSSLConfig(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const opensslMode = document.getElementById('opensslToggle').checked;
                const customAlgorithms = document.getElementById('customAlgorithmsToggle').checked;
                
                // Toggle OpenSSL mode
                await api('/openssl-management/toggle', 'POST', { enabled: opensslMode });
                
                // Toggle custom algorithms
                await api('/openssl/toggle-custom', 'POST', { enabled: customAlgorithms });
                
                showStatus('OpenSSL configuration updated successfully', 'success');
            } catch (error) {
                showStatus(`Failed to update configuration: ${error.message}`, 'error');
            } finally {
                stopLoading();
            }
        }

        async function applyOpenSSLPreset(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const preset = document.getElementById('openssl-preset').value;
                
                const response = await api('/openssl-management/preset', 'POST', { preset });
                
                showStatus(`Preset '${preset}' applied successfully`, 'success');
            } catch (error) {
                showStatus(`Failed to apply preset: ${error.message}`, 'error');
            } finally {
                stopLoading();
            }
        }

        async function testOpenSSLAlgorithm(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const algorithm = document.getElementById('test-algorithm').value;
                const data = document.getElementById('test-data').value;
                
                if (!algorithm) {
                    const userInput = prompt('Please enter algorithm to test:');
                    if (!userInput) {
                        showStatus('Algorithm is required for testing', 'error');
                        stopLoading();
                        return;
                    }
                    algorithm = userInput;
                }
                
                const response = await api('/openssl-management/test', 'POST', { algorithm, data });
                const result = response.result;
                
                let resultsHtml = '<div class="test-results">';
                resultsHtml += `<h4>Algorithm Test Results: ${algorithm}</h4>`;
                resultsHtml += '<table class="results-table">';
                resultsHtml += '<tr><th>Engine</th><th>Success</th><th>Duration (ms)</th><th>Key Size (bits)</th><th>IV Size (bits)</th></tr>';
                
                Object.entries(result.results).forEach(([engineName, engineResult]) => {
                    resultsHtml += '<tr>';
                    resultsHtml += `<td>${engineName}</td>`;
                    resultsHtml += `<td>${engineResult.success ? 'Success' : 'Failed'}</td>`;
                    resultsHtml += `<td>${engineResult.duration || 0}</td>`;
                    resultsHtml += `<td>${engineResult.keySize || 0}</td>`;
                    resultsHtml += `<td>${engineResult.ivSize || 0}</td>`;
                    resultsHtml += '</tr>';
                });
                
                resultsHtml += '</table>';
                resultsHtml += `<p><strong>Summary:</strong> ${result.summary.successful}/${result.summary.totalEngines} engines successful</p>`;
                resultsHtml += '</div>';
                
                document.getElementById('openssl-test-results').innerHTML = resultsHtml;
                showStatus('Algorithm test completed successfully', 'success');
            } catch (error) {
                showStatus(`Failed to test algorithm: ${error.message}`, 'error');
            } finally {
                stopLoading();
            }
        }

        async function getOpenSSLPerformance(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const response = await api('/openssl-management/status', 'GET');
                const performance = response.status.performance;
                
                let perfHtml = '<div class="performance-info">';
                perfHtml += '<h4>Performance Statistics</h4>';
                perfHtml += `<p><strong>Total Operations:</strong> ${performance.totalOperations}</p>`;
                perfHtml += `<p><strong>Successful Operations:</strong> ${performance.successfulOperations}</p>`;
                perfHtml += `<p><strong>Failed Operations:</strong> ${performance.failedOperations}</p>`;
                perfHtml += `<p><strong>Success Rate:</strong> ${performance.successRate.toFixed(2)}%</p>`;
                perfHtml += `<p><strong>Average Encryption Time:</strong> ${performance.averageEncryptionTime}ms</p>`;
                perfHtml += `<p><strong>Median Encryption Time:</strong> ${performance.medianEncryptionTime}ms</p>`;
                perfHtml += `<p><strong>Min Encryption Time:</strong> ${performance.minEncryptionTime}ms</p>`;
                perfHtml += `<p><strong>Max Encryption Time:</strong> ${performance.maxEncryptionTime}ms</p>`;
                perfHtml += `<p><strong>Uptime:</strong> ${Math.round(performance.uptime / 1000)}s</p>`;
                
                if (Object.keys(performance.algorithmUsage).length > 0) {
                    perfHtml += '<h5>Top Algorithms</h5>';
                    perfHtml += '<ul>';
                    Object.entries(performance.algorithmUsage)
                        .sort((a, b) => b[1] - a[1])
                        .slice(0, 10)
                        .forEach(([algorithm, count]) => {
                            perfHtml += `<li>${algorithm}: ${count} uses</li>`;
                        });
                    perfHtml += '</ul>';
                }
                
                perfHtml += '</div>';
                
                document.getElementById('openssl-performance-display').innerHTML = perfHtml;
                showStatus('Performance statistics retrieved successfully', 'success');
            } catch (error) {
                showStatus(`Failed to get performance stats: ${error.message}`, 'error');
            } finally {
                stopLoading();
            }
        }

        async function resetOpenSSLPerformance(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                // Note: This would need a specific endpoint for resetting performance data
                // For now, we'll just show a message
                showStatus('Performance data reset functionality would be implemented here', 'info');
            } catch (error) {
                showStatus(`Failed to reset performance data: ${error.message}`, 'error');
            } finally {
                stopLoading();
            }
        }

        async function generateOpenSSLReport(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const response = await api('/openssl-management/report', 'GET');
                const report = response.report;
                
                let reportHtml = '<div class="report-info">';
                reportHtml += '<h4>OpenSSL Management Report</h4>';
                reportHtml += `<p><strong>Generated:</strong> ${new Date(report.timestamp).toLocaleString()}</p>`;
                reportHtml += `<p><strong>Engine:</strong> ${report.engine} v${report.version}</p>`;
                reportHtml += `<p><strong>Total Algorithms:</strong> ${report.summary.totalAlgorithms}</p>`;
                reportHtml += `<p><strong>Active Engines:</strong> ${report.summary.activeEngines}</p>`;
                reportHtml += `<p><strong>Success Rate:</strong> ${report.summary.successRate.toFixed(2)}%</p>`;
                reportHtml += `<p><strong>Average Performance:</strong> ${report.summary.averagePerformance}ms</p>`;
                reportHtml += `<p><strong>Configuration:</strong> ${report.summary.configuration}</p>`;
                
                if (report.topAlgorithms && report.topAlgorithms.length > 0) {
                    reportHtml += '<h5>Top Algorithms</h5>';
                    reportHtml += '<ol>';
                    report.topAlgorithms.forEach(([algorithm, count]) => {
                        reportHtml += `<li>${algorithm}: ${count} uses</li>`;
                    });
                    reportHtml += '</ol>';
                }
                
                reportHtml += '</div>';
                
                document.getElementById('openssl-report-display').innerHTML = reportHtml;
                showStatus('OpenSSL report generated successfully', 'success');
            } catch (error) {
                showStatus(`Failed to generate report: ${error.message}`, 'error');
            } finally {
                stopLoading();
            }
        }
        
        // Advanced functions (these will use CLI for now)
        async function runAdvancedCrypto(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            let input = document.getElementById('advancedCryptoInput').value;
            const operation = document.getElementById('advancedCryptoOp').value;
            
            if (!input) {
                // Error recovery: prompt for input data
                const userInput = prompt('Please enter input data:');
                if (!userInput) {
                    showStatus('Input is required for advanced crypto operations', 'error');
                stopLoading();
                return;
                }
                input = userInput;
            }
            
            const result = await api('/advancedcrypto', 'POST', { input, operation });
            stopLoading();
            showOutput(result.data);
        }
        
        // Advanced feature implementations
        async function runStealthMode(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const target = document.getElementById('stealthTarget')?.value || 'test';
                const result = await api('/stealth-mode', 'POST', { target });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Stealth mode enabled', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'stealth_mode');
                } else {
                    showStatus('Stealth mode failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'stealth_mode_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Stealth mode error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'stealth_mode_error');
            }
        }
        async function runAntiDetection(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const target = document.getElementById('stealthTarget')?.value || 'test';
                const result = await api('/anti-detection', 'POST', { target });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Anti-detection enabled', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'anti_detection');
                } else {
                    showStatus('Anti-detection failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'anti_detection_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Anti-detection error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'anti_detection_error');
            }
        }
        async function runPolymorphic(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const target = document.getElementById('polyInput')?.value || 'test';
                const result = await api('/polymorphic', 'POST', { target });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Polymorphic engine activated', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'polymorphic_engine');
                } else {
                    showStatus('Polymorphic engine failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'polymorphic_engine_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Polymorphic engine error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'polymorphic_engine_error');
            }
        }

        // Mutex functionality
        async function generateMutex(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const language = document.getElementById('mutexLanguage')?.value || 'cpp';
                const pattern = document.getElementById('mutexPattern')?.value || 'standard';
                const options = {
                    stealth: document.getElementById('mutexStealth')?.checked || false,
                    antiAnalysis: document.getElementById('mutexAntiAnalysis')?.checked || false
                };
                
                const result = await api('/mutex/generate', 'POST', { language, pattern, options });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Mutex code generated successfully', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'mutex_generated');
                } else {
                    showStatus('Mutex generation failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'mutex_generation_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Mutex generation error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'mutex_generation_error');
            }
        }

        // UPX functionality
        async function packExecutable(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const executablePath = document.getElementById('upxExecutablePath')?.value;
                const method = document.getElementById('upxMethod')?.value || 'upx';
                
                if (!executablePath) {
                    showStatus('Please specify executable path', 'error');
                    stopLoading();
                    return;
                }
                
                const result = await api('/upx/pack', 'POST', { executablePath, method });
                stopLoading();
                if (result.status === 200) {
                    showStatus(`Executable packed successfully with ${method}`, 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'upx_packed');
                } else {
                    showStatus('UPX packing failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'upx_packing_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`UPX packing error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'upx_packing_error');
            }
        }

        async function checkPackingStatus(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const executablePath = document.getElementById('upxExecutablePath')?.value;
                
                if (!executablePath) {
                    showStatus('Please specify executable path', 'error');
                    stopLoading();
                    return;
                }
                
                const result = await api('/upx/status', 'POST', { executablePath });
                stopLoading();
                if (result.status === 200) {
                    const status = result.data.result;
                    showStatus(`Packing status: ${status.isPacked ? 'Packed' : 'Not Packed'} (${status.packer})`, 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'upx_status');
                } else {
                    showStatus('Failed to check packing status', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'upx_status_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Packing status check error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'upx_status_error');
            }
        }

        // Jotti Scanner functions
        function browseJottiFile() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.exe,.dll,.sys,.scr,.com,.bat,.cmd,.ps1,.js,.vbs';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    // Use the full path if available, otherwise use the name
                    const filePath = file.path || file.webkitRelativePath || file.name;
                    document.getElementById('jottiFilePath').value = filePath;
                    showStatus(`File selected: ${filePath}`, 'info');
                }
            };
            input.click();
        }

        async function scanWithJotti(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                let filePath = document.getElementById('jottiFilePath')?.value;
                
                if (!filePath) {
                    showStatus('Please specify file path to scan', 'error');
                    stopLoading();
                    return;
                }
                
                // If only filename is provided, try to find it in common locations
                if (!filePath.includes('\\') && !filePath.includes('/')) {
                    const commonPaths = [
                        'C:\\Users\\Garre\\Desktop\\Source\\uploads\\',
                        'C:\\Users\\Garre\\Desktop\\RawrZApp\\',
                        'C:\\Users\\Garre\\Desktop\\'
                    ];
                    
                    for (const basePath of commonPaths) {
                        const fullPath = basePath + filePath;
                        try {
                            // Check if file exists by making a test request
                            const testResult = await api('/jotti/scan', 'POST', { 
                                filePath: fullPath, 
                                options: { test: true } 
                            });
                            if (testResult.data && !testResult.data.error) {
                                filePath = fullPath;
                                document.getElementById('jottiFilePath').value = fullPath;
                                showStatus(`Found file at: ${fullPath}`, 'info');
                                break;
                            }
                        } catch (e) {
                            // Continue to next path
                        }
                    }
                }
                
                const options = {
                    detailedResults: document.getElementById('jottiDetailedResults')?.checked || false,
                    includeSummary: document.getElementById('jottiIncludeSummary')?.checked || false
                };
                
                showStatus('Scanning file with embedded Jotti scanner...', 'info');
                
                const result = await api('/jotti/scan', 'POST', { filePath, options });
                stopLoading();
                
                if (result.status === 200 && result.data.success) {
                    const scanResult = result.data.result;
                    displayJottiResults(scanResult);
                    
                    if (scanResult.summary) {
                        const summary = scanResult.summary;
                        showStatus(`Scan complete! ${summary.message} (FUD Score: ${summary.fudScore}/100)`, 
                                  summary.status === 'FUD' ? 'success' : 'warning');
                    } else {
                        showStatus('Scan completed successfully', 'success');
                    }
                    
                    setLastResult(result.data, 'jotti_scan');
                } else {
                    showStatus('Jotti scan failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'jotti_scan_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Jotti scan error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'jotti_scan_error');
            }
        }

        function displayJottiResults(scanResult) {
            const resultsDiv = document.getElementById('jottiResults');
            const contentDiv = document.getElementById('jottiResultsContent');
            
            if (!scanResult.success) {
                contentDiv.innerHTML = `<div class="error">Scan failed: ${scanResult.error}</div>`;
                resultsDiv.style.display = 'block';
                return;
            }
            
            let html = '<div class="scan-results">';
            
            // Summary
            if (scanResult.summary) {
                const summary = scanResult.summary;
                html += `
                    <div class="scan-summary">
                        <h5>Scan Summary</h5>
                        <div class="summary-stats">
                            <div class="stat-item">
                                <span class="stat-label">Status:</span>
                                <span class="stat-value ${summary.status.toLowerCase().replace(' ', '-')}">${summary.status}</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">FUD Score:</span>
                                <span class="stat-value">${summary.fudScore}/100</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Detection Rate:</span>
                                <span class="stat-value">${summary.detectionRate}%</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Engines:</span>
                                <span class="stat-value">${summary.engines}</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Detected:</span>
                                <span class="stat-value">${summary.detected}</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Clean:</span>
                                <span class="stat-value">${summary.clean}</span>
                            </div>
                        </div>
                        <div class="summary-message">${summary.message}</div>
                    </div>
                `;
            }
            
            // Engine Results
            if (scanResult.results && scanResult.results.engines) {
                html += '<div class="engine-results"><h5>Engine Results</h5><div class="engine-grid">';
                
                Object.entries(scanResult.results.engines).forEach(([engine, result]) => {
                    const statusClass = result.detected ? 'detected' : 'clean';
                    const statusIcon = result.detected ? 'Warning' : 'Success';
                    
                    html += `
                        <div class="engine-item ${statusClass}">
                            <div class="engine-name">${engine}</div>
                            <div class="engine-status">${statusIcon} ${result.result}</div>
                            ${result.threat ? `<div class="engine-threat">Threat: ${result.threat}</div>` : ''}
                        </div>
                    `;
                });
                
                html += '</div></div>';
            }
            
            // File Info
            html += `
                <div class="file-info">
                    <h5>File Information</h5>
                    <div class="info-item"><span class="info-label">File:</span> ${scanResult.filePath}</div>
                    <div class="info-item"><span class="info-label">Size:</span> ${formatFileSize(scanResult.fileSize)}</div>
                    <div class="info-item"><span class="info-label">Job ID:</span> ${scanResult.jobId}</div>
                    <div class="info-item"><span class="info-label">Scan Time:</span> ${new Date(scanResult.timestamp).toLocaleString()}</div>
                </div>
            `;
            
            html += '</div>';
            contentDiv.innerHTML = html;
            resultsDiv.style.display = 'block';
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        async function getJottiInfo(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/jotti/info', 'GET');
                stopLoading();
                
                if (result.status === 200) {
                    const info = result.data.result;
                    showStatus('Jotti Scanner info retrieved', 'success');
                    showOutput(info);
                    setLastResult(result.data, 'jotti_info');
                } else {
                    showStatus('Failed to get Jotti scanner info', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'jotti_info_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Jotti info error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'jotti_info_error');
            }
        }
        async function runHotPatch(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const target = document.getElementById('patchTarget')?.value || 'test';
                const result = await api('/hot-patch', 'POST', { target });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Hot patch applied', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'hot_patch');
                } else {
                    showStatus('Hot patch failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'hot_patch_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Hot patch error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'hot_patch_error');
            }
        }
        async function runPatchRollback(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const target = document.getElementById('patchTarget')?.value || 'test';
                const result = await api('/patch-rollback', 'POST', { target });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Patch rollback completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'patch_rollback');
                } else {
                    showStatus('Patch rollback failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'patch_rollback_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Patch rollback error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'patch_rollback_error');
            }
        }
        async function runMobileScan(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const target = document.getElementById('mobileTarget')?.value || 'test';
                const result = await api('/mobile-scan', 'POST', { target });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Mobile scan completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'mobile_scan');
                } else {
                    showStatus('Mobile scan failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'mobile_scan_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Mobile scan error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'mobile_scan_error');
            }
        }
        async function runAppAnalysis(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
                try {
                const target = document.getElementById('mobileTarget')?.value || 'test';
                const result = await api('/app-analysis', 'POST', { target });
                    stopLoading();
                    if (result.status === 200) {
                        showStatus('App analysis completed', 'success');
                        showOutput(result.data);
                        setLastResult(result.data, 'app_analysis');
                    } else {
                        showStatus('App analysis failed', 'error');
                        showOutput(result.data);
                        setLastResult(result.data, 'app_analysis_failed');
                    }
                } catch (error) {
                    stopLoading();
                    showStatus(`App analysis error: ${error.message}`, 'error');
                    setLastResult({ error: error.message }, 'app_analysis_error');
            }
        }
        async function runDeviceForensics(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const target = document.getElementById('mobileTarget')?.value || 'test';
                const result = await api('/device-forensics', 'POST', { target });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Device forensics completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'device_forensics');
                } else {
                    showStatus('Device forensics failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'device_forensics_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Device forensics error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'device_forensics_error');
            }
        }
        async function runAPIStatus(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/api-status', 'GET');
                stopLoading();
                if (result.status === 200) {
                    showStatus('API status check completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'api_status');
                } else {
                    showStatus('API status check failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'api_status_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`API status error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'api_status_error');
            }
        }
        async function runHealthCheck(button = null) { checkHealth(button); }
        async function runPerformanceMonitor(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/performance-monitor', 'GET');
                stopLoading();
                if (result.status === 200) {
                    showStatus('Performance monitoring completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'performance_monitor');
                } else {
                    showStatus('Performance monitoring failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'performance_monitor_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Performance monitoring error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'performance_monitor_error');
            }
        }
        
        // Bot Manager functions
        async function quickGenerateBot() {
            const button = event.target;
            const stopLoading = showLoading(button);
            
            try {
                const botType = document.getElementById('quickBotType').value;
                const config = {
                    name: document.getElementById('quickBotName').value,
                    server: botType === 'http' ? 'http://localhost:8080' : 'irc.rizon.net',
                    port: botType === 'http' ? 8080 : 6667,
                    channels: ['#test'],
                    username: 'rawrzuser',
                    realname: 'RawrZ Quick Bot',
                    targetOS: 'windows',
                    architecture: 'x64'
                };
                
                const features = ['fileManager', 'systemInfo', 'httpComm'];
                const language = document.getElementById('quickBotLanguage').value;
                
                showStatus(`Generating ${botType.toUpperCase()} bot...`, 'info');
                
                const endpoint = botType === 'http' ? '/http-bot/generate' : '/irc-bot/generate';
                const result = await api(endpoint, 'POST', {
                    config,
                    features,
                    extensions: [language]
                });
                
                stopLoading();
                
                if (result.status === 200) {
                    showStatus(`${botType.toUpperCase()} bot generated successfully!`, 'success');
                    showOutput(result.data);
                } else {
                    showStatus(`${botType.toUpperCase()} bot generation failed`, 'error');
                    showOutput(result.data);
                }
            } catch (error) {
                stopLoading();
                showStatus(`Error: ${error.message}`, 'error');
            }
        }

        async function getBotStatus() {
            const button = event.target;
            const stopLoading = showLoading(button);
            
            try {
                showStatus('Checking bot status...', 'info');
                
                const result = await api('/bot/status', 'GET');
                
                stopLoading();
                
                if (result.status === 200) {
                    showStatus('Bot status retrieved!', 'success');
                    showOutput(result.data);
                } else {
                    showStatus('Failed to get bot status', 'error');
                    showOutput(result.data);
                }
            } catch (error) {
                stopLoading();
                showStatus(`Error: ${error.message}`, 'error');
            }
        }

        async function refreshBotConnections() {
            const button = event.target;
            const stopLoading = showLoading(button);
            
            try {
                showStatus('Refreshing bot connections...', 'info');
                
                // Test both IRC and HTTP bot endpoints
                const ircResult = await api('/irc-bot/features', 'GET');
                const httpResult = await api('/http-bot/features', 'GET');
                
                stopLoading();
                
                if (ircResult.status === 200 && httpResult.status === 200) {
                    showStatus('Bot connections refreshed!', 'success');
                    showOutput({
                        irc: ircResult.data,
                        http: httpResult.data
                    });
                } else {
                    showStatus('Failed to refresh connections', 'error');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Error: ${error.message}`, 'error');
            }
        }

        async function testBotCommunication() {
            const button = event.target;
            const stopLoading = showLoading(button);
            
            try {
                showStatus('Testing bot communication...', 'info');
                
                // Test bot heartbeat endpoint
                const result = await api('/bot/heartbeat?bot_id=test&status=alive&timestamp=' + Date.now(), 'GET');
                
                stopLoading();
                
                if (result.status === 200) {
                    showStatus('Bot communication test successful!', 'success');
                    showOutput(result.data);
                } else {
                    showStatus('Bot communication test failed', 'error');
                    showOutput(result.data);
                }
            } catch (error) {
                stopLoading();
                showStatus(`Error: ${error.message}`, 'error');
            }
        }

        // IRC Bot Builder functions
        async function quickGenerateIRCBot() {
            const button = event.target;
            const stopLoading = showLoading(button);
            
            try {
                const config = {
                    name: document.getElementById('advancedBotName').value,
                    server: document.getElementById('quickIrcServer').value,
                    port: 6667,
                    channels: ['#test'],
                    username: 'rawrzuser',
                    realname: 'RawrZ Quick Bot',
                    targetOS: 'windows',
                    architecture: 'x64'
                };
                
                const features = ['fileManager', 'systemInfo'];
                const language = document.getElementById('quickBotLanguage').value;
                
                showStatus('Generating quick bot...', 'info');
                
                const result = await api('/irc-bot/generate', 'POST', {
                    config,
                    features,
                    extensions: [language]
                });
                
                stopLoading();
                
                if (result.status === 200) {
                    showStatus('Quick bot generated successfully!', 'success');
                    showOutput(result.data);
                } else {
                    showStatus('Quick bot generation failed', 'error');
                    showOutput(result.data);
                }
            } catch (error) {
                stopLoading();
                showStatus(`Error: ${error.message}`, 'error');
            }
        }

        async function getBotTemplates() {
            const button = event.target;
            const stopLoading = showLoading(button);
            
            try {
                showStatus('Loading bot templates...', 'info');
                
                const result = await api('/irc-bot/templates', 'GET');
                
                stopLoading();
                
                if (result.status === 200) {
                    showStatus('Bot templates loaded!', 'success');
                    showOutput(result.data);
                } else {
                    showStatus('Failed to load templates', 'error');
                    showOutput(result.data);
                }
            } catch (error) {
                stopLoading();
                showStatus(`Error: ${error.message}`, 'error');
            }
        }

        async function getBotFeatures() {
            const button = event.target;
            const stopLoading = showLoading(button);
            
            try {
                showStatus('Loading bot features...', 'info');
                
                const result = await api('/irc-bot/features', 'GET');
                
                stopLoading();
                
                if (result.status === 200) {
                    showStatus('Bot features loaded!', 'success');
                    showOutput(result.data);
                } else {
                    showStatus('Failed to load features', 'error');
                    showOutput(result.data);
                }
            } catch (error) {
                stopLoading();
                showStatus(`Error: ${error.message}`, 'error');
            }
        }

        async function testBotConnection() {
            const button = event.target;
            const stopLoading = showLoading(button);
            
            try {
                const config = {
                    name: 'TestBot',
                    server: document.getElementById('quickIrcServer').value || 'irc.rizon.net',
                    port: 6667,
                    channels: ['#test'],
                    username: 'testuser',
                    realname: 'Test Bot',
                    targetOS: 'windows',
                    architecture: 'x64'
                };
                
                showStatus('Testing bot connection...', 'info');
                
                const result = await api('/irc-bot/test', 'POST', { config });
                
                stopLoading();
                
                if (result.status === 200) {
                    showStatus('Bot connection test completed!', 'success');
                    showOutput(result.data);
                } else {
                    showStatus('Bot connection test failed', 'error');
                    showOutput(result.data);
                }
            } catch (error) {
                stopLoading();
                showStatus(`Error: ${error.message}`, 'error');
            }
        }

        // Private Virus Scanner functions
        async function browsePrivateScannerFile() {
            try {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.exe,.dll,.sys,.scr,.com,.bat,.cmd,.ps1,.js,.vbs,.txt,.pdf,.doc,.docx';
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        // Use the full path if available, otherwise use the name
                        const filePath = file.path || file.webkitRelativePath || file.name;
                        document.getElementById('privateScannerPath').value = filePath;
                        showStatus(`File selected: ${filePath}`, 'info');
                    }
                };
                input.click();
            } catch (error) {
                showStatus(`Error browsing file: ${error.message}`, 'error');
            }
        }

        async function scanWithPrivateScanner(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const filePath = document.getElementById('privateScannerPath').value;
                if (!filePath) {
                    showStatus('Please select a file to scan', 'error');
                    return;
                }

                const engines = [];
                if (document.getElementById('privateScannerClamAV').checked) engines.push('clamav');
                if (document.getElementById('privateScannerDefender').checked) engines.push('defender');
                if (document.getElementById('privateScannerYARA').checked) engines.push('yara');
                if (document.getElementById('privateScannerML').checked) engines.push('ml');
                if (document.getElementById('privateScannerHeuristic').checked) engines.push('heuristic');

                const options = {
                    engines: engines,
                    priority: document.getElementById('privateScannerPriority').value
                };

                const result = await api('/private-scanner/scan', 'POST', { filePath, options });
                stopLoading();
                displayPrivateScannerResults(result.data);
                showStatus('Private scanner completed successfully', 'success');
            } catch (error) {
                stopLoading();
                showStatus(`Private scanner error: ${error.message}`, 'error');
            }
        }

        async function queuePrivateScanner(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const filePath = document.getElementById('privateScannerPath').value;
                if (!filePath) {
                    showStatus('Please select a file to scan', 'error');
                    return;
                }

                const engines = [];
                if (document.getElementById('privateScannerClamAV').checked) engines.push('clamav');
                if (document.getElementById('privateScannerDefender').checked) engines.push('defender');
                if (document.getElementById('privateScannerYARA').checked) engines.push('yara');
                if (document.getElementById('privateScannerML').checked) engines.push('ml');
                if (document.getElementById('privateScannerHeuristic').checked) engines.push('heuristic');

                const options = {
                    engines: engines,
                    priority: document.getElementById('privateScannerPriority').value
                };

                const result = await api('/private-scanner/queue', 'POST', { filePath, options });
                stopLoading();
                showStatus(`Scan queued successfully. Scan ID: ${result.data.scanId}`, 'success');
            } catch (error) {
                stopLoading();
                showStatus(`Queue error: ${error.message}`, 'error');
            }
        }

        async function getPrivateScannerStats(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/private-scanner/stats', 'GET');
                stopLoading();
                displayPrivateScannerResults(result.data);
                showStatus('Scanner stats retrieved successfully', 'success');
            } catch (error) {
                stopLoading();
                showStatus(`Stats error: ${error.message}`, 'error');
            }
        }

        async function getPrivateScannerEngines(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/private-scanner/engines', 'GET');
                stopLoading();
                displayPrivateScannerResults(result.data);
                showStatus('Engine status retrieved successfully', 'success');
            } catch (error) {
                stopLoading();
                showStatus(`Engine status error: ${error.message}`, 'error');
            }
        }

        async function getPrivateScannerQueue(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/private-scanner/queue-status', 'GET');
                stopLoading();
                displayPrivateScannerResults(result.data);
                showStatus('Queue status retrieved successfully', 'success');
            } catch (error) {
                stopLoading();
                showStatus(`Queue status error: ${error.message}`, 'error');
            }
        }

        function displayPrivateScannerResults(data) {
            const resultsDiv = document.getElementById('privateScannerResults');
            const contentDiv = document.getElementById('privateScannerResultsContent');
            
            if (data && typeof data === 'object') {
                contentDiv.innerHTML = `
                    <div class="result-item">
                        <h5>Private Scanner Results</h5>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    </div>
                `;
            } else {
                contentDiv.innerHTML = `
                    <div class="result-item">
                        <h5>Private Scanner Results</h5>
                        <p>${data || 'No results available'}</p>
                    </div>
                `;
            }
            
            resultsDiv.style.display = 'block';
        }

        // CLI Scan Methods
        async function runCliScan(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const scanType = document.getElementById('cliScanType').value;
                const target = document.getElementById('cliScanTarget').value;
                const options = document.getElementById('cliScanOptionsInput').value;
                
                if (!target) {
                    showStatus('Please enter a target for the scan', 'error');
                    stopLoading();
                    return;
                }
                
                showStatus(`Running ${scanType} scan on ${target}...`, 'info');
                
                // Build command arguments
                const commandArgs = [target];
                if (options) {
                    commandArgs.push(...options.split(' '));
                }
                
                const result = await api('/cli', 'POST', { 
                    command: scanType, 
                    args: commandArgs 
                });
                
                stopLoading();
                displayCliScanResults(result.data, scanType, target);
                showStatus(`${scanType} scan completed successfully`, 'success');
                
            } catch (error) {
                stopLoading();
                showStatus(`CLI scan error: ${error.message}`, 'error');
            }
        }
        
        async function getCliScanHelp(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const scanType = document.getElementById('cliScanType').value;
                
                const helpText = getCliScanHelpText(scanType);
                stopLoading();
                
                const resultsDiv = document.getElementById('cliScanResults');
                const contentDiv = document.getElementById('cliScanResultsContent');
                
                contentDiv.innerHTML = `
                    <div class="result-item">
                        <h5>CLI Scan Help: ${scanType}</h5>
                        <pre>${helpText}</pre>
                    </div>
                `;
                
                resultsDiv.style.display = 'block';
                showStatus(`Help for ${scanType} displayed`, 'info');
                
            } catch (error) {
                stopLoading();
                showStatus(`Help error: ${error.message}`, 'error');
            }
        }
        
        function getCliScanHelpText(scanType) {
            const helpTexts = {
                'analyze': 'Usage: analyze <input>\nAnalyzes a file for malware, signatures, and behavior patterns.',
                'portscan': 'Usage: portscan <host> [startport] [endport]\nScans ports on a target host.',
                'netscan': 'Usage: netscan <network> [subnet]\nScans a network for active hosts.',
                'vulnscan': 'Usage: vulnscan <target>\nScans for vulnerabilities on a target.',
                'sigcheck': 'Usage: sigcheck <target>\nChecks digital signatures and certificates.',
                'forensics': 'Usage: forensics <target>\nPerforms comprehensive forensics analysis.',
                'malware': 'Usage: malware <target>\nScans for malware and suspicious behavior.',
                'vulncheck': 'Usage: vulncheck <target>\nChecks for known vulnerabilities (CVEs).',
                'appanalyze': 'Usage: appanalyze <target>\nAnalyzes mobile applications (APK/IPA).',
                'device': 'Usage: device <target>\nPerforms device forensics and hardware analysis.',
                'behavior': 'Usage: behavior <target>\nAnalyzes behavioral patterns and API calls.',
                'timeline': 'Usage: timeline <target>\nReconstructs timeline of events.',
                'disasm': 'Usage: disasm <target>\nDisassembles binary files.',
                'strings': 'Usage: strings <target>\nExtracts strings from binary files.',
                'memanalysis': 'Usage: memanalysis <target>\nAnalyzes memory dumps.',
                'procdump': 'Usage: procdump <target>\nDumps process memory.',
                'service': 'Usage: service <host> [port]\nDetects services running on ports.',
                'packet': 'Usage: packet <interface> [count]\nCaptures network packets.',
                'traffic': 'Usage: traffic <file>\nAnalyzes network traffic from capture file.',
                'protocol': 'Usage: protocol <file>\nAnalyzes network protocols.',
                'threat': 'Usage: threat <target>\nDetects threats and malicious indicators.'
            };
            
            return helpTexts[scanType] || 'No help available for this scan type.';
        }
        
        function displayCliScanResults(data, scanType, target) {
            const resultsDiv = document.getElementById('cliScanResults');
            const contentDiv = document.getElementById('cliScanResultsContent');
            
            if (data && typeof data === 'object') {
                contentDiv.innerHTML = `
                    <div class="result-item">
                        <h5>CLI Scan Results: ${scanType} on ${target}</h5>
                        <div class="scan-info">
                            <p><strong>Scan Type:</strong> ${scanType}</p>
                            <p><strong>Target:</strong> ${target}</p>
                            <p><strong>Timestamp:</strong> ${new Date().toISOString()}</p>
                        </div>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    </div>
                `;
            } else {
                contentDiv.innerHTML = `
                    <div class="result-item">
                        <h5>CLI Scan Results: ${scanType} on ${target}</h5>
                        <div class="scan-info">
                            <p><strong>Scan Type:</strong> ${scanType}</p>
                            <p><strong>Target:</strong> ${target}</p>
                            <p><strong>Timestamp:</strong> ${new Date().toISOString()}</p>
                        </div>
                        <pre>${data || 'No results available'}</pre>
                    </div>
                `;
            }
            
            resultsDiv.style.display = 'block';
        }
        
        function clearCliScanResults(button = null) {
            const resultsDiv = document.getElementById('cliScanResults');
            const contentDiv = document.getElementById('cliScanResultsContent');
            
            contentDiv.innerHTML = '';
            resultsDiv.style.display = 'none';
            
            if (button) {
                showStatus('CLI scan results cleared', 'info');
            }
        }
        
        // Show/hide additional options based on scan type
        document.addEventListener('DOMContentLoaded', function() {
            const scanTypeSelect = document.getElementById('cliScanType');
            const optionsDiv = document.getElementById('cliScanOptions');
            
            if (scanTypeSelect && optionsDiv) {
                scanTypeSelect.addEventListener('change', function() {
                    const scanType = this.value;
                    const needsOptions = ['portscan', 'netscan', 'packet', 'service'];
                    
                    if (needsOptions.includes(scanType)) {
                        optionsDiv.style.display = 'block';
                        const optionsInput = document.getElementById('cliScanOptionsInput');
                        switch(scanType) {
                            case 'portscan':
                                optionsInput.placeholder = 'Start port, End port (e.g., 80 443)';
                                break;
                            case 'netscan':
                                optionsInput.placeholder = 'Subnet mask (e.g., 24)';
                                break;
                            case 'packet':
                                optionsInput.placeholder = 'Packet count (e.g., 100)';
                                break;
                            case 'service':
                                optionsInput.placeholder = 'Port number (e.g., 80)';
                                break;
                        }
                    } else {
                        optionsDiv.style.display = 'none';
                    }
                });
            }
        });

        // Additional feature implementations
        async function runMemoryInfo(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/sysinfo');
                stopLoading();
                if (result.status === 200) {
                    showStatus('Memory info retrieved', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'memory_info');
                } else {
                    showStatus('Memory info failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'memory_info_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Memory info error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'memory_info_error');
            }
        }
        async function runGarbageCollect(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'sysinfo', args: ['--gc'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Garbage collection completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'garbage_collect');
                } else {
                    showStatus('Garbage collection failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'garbage_collect_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Garbage collection error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'garbage_collect_error');
            }
        }
        async function runMemoryCleanup(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'sysinfo', args: ['--cleanup'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Memory cleanup completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'memory_cleanup');
                } else {
                    showStatus('Memory cleanup failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'memory_cleanup_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Memory cleanup error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'memory_cleanup_error');
            }
        }
        async function runCpuUsage(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/sysinfo');
                stopLoading();
                if (result.status === 200) {
                    showStatus('CPU usage retrieved', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'cpu_usage');
                } else {
                    showStatus('CPU usage failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'cpu_usage_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`CPU usage error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'cpu_usage_error');
            }
        }
        async function runDiskUsage(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/sysinfo');
                stopLoading();
                if (result.status === 200) {
                    showStatus('Disk usage retrieved', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'disk_usage');
                } else {
                    showStatus('Disk usage failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'disk_usage_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Disk usage error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'disk_usage_error');
            }
        }
        async function runNetworkStats(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/sysinfo');
                stopLoading();
                if (result.status === 200) {
                    showStatus('Network statistics retrieved', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'network_stats');
                } else {
                    showStatus('Network statistics failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'network_stats_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Network statistics error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'network_stats_error');
            }
        }
        async function runSecurityScan(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const targetType = document.getElementById('securityScanTarget').value;
                let result;
                
                if (targetType === 'uploaded') {
                    // Scan uploaded file
                    const selectedFileName = document.getElementById('securityScanFile').value;
                    if (!selectedFileName) {
                        showStatus('Please select a file to scan', 'error');
                        stopLoading();
                        return;
                    }
                    
                    // Find the file data from uploadedFiles
                    const fileData = window.uploadedFiles.find(f => f.name === selectedFileName);
                    if (!fileData) {
                        showStatus('Selected file not found in uploaded files', 'error');
                        stopLoading();
                        return;
                    }
                    
                    // Use file analysis endpoint for uploaded files
                    result = await api('/file-analysis', 'POST', { filepath: fileData.name });
                } else {
                    // Scan local system
                    result = await api('/api/security/scan', 'POST', { target: 'localhost' });
                }
                
                stopLoading();
                if (result.status === 200) {
                    showStatus('Security scan completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'security_scan');
                } else {
                    showStatus('Security scan failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'security_scan_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Security scan error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'security_scan_error');
            }
        }
        async function runThreatDetection(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const targetType = document.getElementById('threatDetectionTarget').value;
                let result;
                
                if (targetType === 'uploaded') {
                    // Analyze uploaded file for threats
                    const selectedFileName = document.getElementById('threatDetectionFile').value;
                    if (!selectedFileName) {
                        showStatus('Please select a file to analyze', 'error');
                        stopLoading();
                        return;
                    }
                    
                    // Find the file data from uploadedFiles
                    const fileData = window.uploadedFiles.find(f => f.name === selectedFileName);
                    if (!fileData) {
                        showStatus('Selected file not found in uploaded files', 'error');
                        stopLoading();
                        return;
                    }
                    
                    // Use malware scan endpoint for threat detection on files
                    result = await api('/malware-scan', 'POST', { target: fileData.name });
                } else {
                    // Use threat detection endpoint for system
                    result = await api('/threat-detection', 'POST', { target: 'localhost' });
                }
                
                stopLoading();
                if (result.status === 200) {
                    showStatus('Threat detection completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'threat_detection');
                } else {
                    showStatus('Threat detection failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'threat_detection_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Threat detection error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'threat_detection_error');
            }
        }
        async function runVulnerabilityCheck(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const targetType = document.getElementById('vulnerabilityCheckTarget').value;
                let result;
                
                if (targetType === 'uploaded') {
                    // Check uploaded file for vulnerabilities
                    const selectedFileName = document.getElementById('vulnerabilityCheckFile').value;
                    if (!selectedFileName) {
                        showStatus('Please select a file to check', 'error');
                        stopLoading();
                        return;
                    }
                    
                    // Find the file data from uploadedFiles
                    const fileData = window.uploadedFiles.find(f => f.name === selectedFileName);
                    if (!fileData) {
                        showStatus('Selected file not found in uploaded files', 'error');
                        stopLoading();
                        return;
                    }
                    
                    // Use vulnerability check endpoint for files
                    result = await api('/vulnerability-check', 'POST', { target: fileData.name });
                } else {
                    // Use vulnerability check endpoint for system
                    result = await api('/vulnerability-check', 'POST', { target: 'localhost' });
                }
                
                stopLoading();
                if (result.status === 200) {
                    showStatus('Vulnerability check completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'vulnerability_check');
                } else {
                    showStatus('Vulnerability check failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'vulnerability_check_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Vulnerability check error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'vulnerability_check_error');
            }
        }
        async function runFileAnalysis(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            if (window.selectedFile) {
                try {
                    const result = await api('/analyze', 'POST', { input: window.selectedFile.name });
                    stopLoading();
                    if (result.status === 200) {
                        showStatus('File analysis completed', 'success');
                        showOutput(result.data);
                        setLastResult(result.data, 'file_analysis');
                    } else {
                        showStatus('File analysis failed', 'error');
                        showOutput(result.data);
                        setLastResult(result.data, 'file_analysis_failed');
                    }
                } catch (error) {
                    stopLoading();
                    showStatus(`File analysis error: ${error.message}`, 'error');
                    setLastResult({ error: error.message }, 'file_analysis_error');
                }
            } else {
                // Error recovery: prompt for file to analyze
                const userFile = prompt('Please enter file to analyze:');
                if (!userFile) {
                    showStatus('File is required for analysis', 'error');
                stopLoading();
                    return;
                }
                
                try {
                    const result = await api('/analyze', 'POST', { input: userFile });
                    stopLoading();
                    if (result.status === 200) {
                        showStatus('File analysis completed', 'success');
                        showOutput(result.data);
                        setLastResult(result.data, 'file_analysis');
                    } else {
                        showStatus('File analysis failed', 'error');
                        showOutput(result.data);
                        setLastResult(result.data, 'file_analysis_failed');
                    }
                } catch (error) {
                    stopLoading();
                    showStatus(`File analysis error: ${error.message}`, 'error');
                    setLastResult({ error: error.message }, 'file_analysis_error');
                }
            }
        }
        async function runFileHash(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            if (window.selectedFile) {
                try {
                    const result = await api('/hash', 'POST', { input: window.selectedFile.name, algorithm: 'sha256' });
                    stopLoading();
                    if (result.status === 200) {
                        showStatus('File hashing completed', 'success');
                        showOutput(result.data);
                        setLastResult(result.data, 'file_hashing');
                    } else {
                        showStatus('File hashing failed', 'error');
                        showOutput(result.data);
                        setLastResult(result.data, 'file_hashing_failed');
                    }
                } catch (error) {
                    stopLoading();
                    showStatus(`File hashing error: ${error.message}`, 'error');
                    setLastResult({ error: error.message }, 'file_hashing_error');
                }
            } else {
                // Error recovery: prompt for file to hash
                const userFile = prompt('Please enter file to hash:');
                if (!userFile) {
                    showStatus('File is required for hashing', 'error');
                stopLoading();
                    return;
                }
                
                try {
                    const result = await api('/hash', 'POST', { input: userFile, algorithm: 'sha256' });
                    stopLoading();
                    if (result.status === 200) {
                        showStatus('File hashing completed', 'success');
                        showOutput(result.data);
                        setLastResult(result.data, 'file_hashing');
                    } else {
                        showStatus('File hashing failed', 'error');
                        showOutput(result.data);
                        setLastResult(result.data, 'file_hashing_failed');
                    }
                } catch (error) {
                    stopLoading();
                    showStatus(`File hashing error: ${error.message}`, 'error');
                    setLastResult({ error: error.message }, 'file_hashing_error');
                }
            }
        }
        async function runFileSignature(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            if (window.selectedFile) {
                try {
                    const result = await api('/cli', 'POST', { command: 'analyze', args: [window.selectedFile.name, '--signature'] });
                    stopLoading();
                    if (result.status === 200) {
                        showStatus('File signature check completed', 'success');
                        showOutput(result.data);
                        setLastResult(result.data, 'file_signature');
                    } else {
                        showStatus('File signature check failed', 'error');
                        showOutput(result.data);
                        setLastResult(result.data, 'file_signature_failed');
                    }
                } catch (error) {
                    stopLoading();
                    showStatus(`File signature error: ${error.message}`, 'error');
                    setLastResult({ error: error.message }, 'file_signature_error');
                }
            } else {
                // Error recovery: prompt for file to check signature
                const userFile = prompt('Please enter file to check signature:');
                if (!userFile) {
                    showStatus('File is required for signature check', 'error');
                stopLoading();
                    return;
                }
                
                try {
                    const result = await api('/cli', 'POST', { command: 'analyze', args: [userFile, '--signature'] });
                    stopLoading();
                    if (result.status === 200) {
                        showStatus('File signature check completed', 'success');
                        showOutput(result.data);
                        setLastResult(result.data, 'file_signature');
                    } else {
                        showStatus('File signature check failed', 'error');
                        showOutput(result.data);
                        setLastResult(result.data, 'file_signature_failed');
                    }
                } catch (error) {
                    stopLoading();
                    showStatus(`File signature error: ${error.message}`, 'error');
                    setLastResult({ error: error.message }, 'file_signature_error');
                }
            }
        }
        async function runBackup(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'fileops', args: ['backup'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Backup created successfully', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'backup');
                } else {
                    showStatus('Backup failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'backup_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Backup error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'backup_error');
            }
        }
        async function runRestore(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'fileops', args: ['restore'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Restore completed successfully', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'restore');
                } else {
                    showStatus('Restore failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'restore_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Restore error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'restore_error');
            }
        }
        async function runBackupList(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/files');
                stopLoading();
                if (result.status === 200) {
                    showStatus('Backup list retrieved', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'backup_list');
                } else {
                    showStatus('Backup list failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'backup_list_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Backup list error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'backup_list_error');
            }
        }
        async function runMalwareScan(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            if (window.selectedFile) {
                try {
                    const result = await api('/cli', 'POST', { command: 'analyze', args: [window.selectedFile.name, '--malware-scan'] });
                    stopLoading();
                    if (result.status === 200) {
                        showStatus('Malware scan completed', 'success');
                        showOutput(result.data);
                        setLastResult(result.data, 'malware_scan');
                    } else {
                        showStatus('Malware scan failed', 'error');
                        showOutput(result.data);
                        setLastResult(result.data, 'malware_scan_failed');
                    }
                } catch (error) {
                    stopLoading();
                    showStatus(`Malware scan error: ${error.message}`, 'error');
                    setLastResult({ error: error.message }, 'malware_scan_error');
                }
            } else {
                showStatus('Please select a file first', 'error');
                stopLoading();
            }
        }
        async function runBehaviorAnalysis(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            if (window.selectedFile) {
                try {
                    const result = await api('/cli', 'POST', { command: 'analyze', args: [window.selectedFile.name, '--behavior'] });
                    stopLoading();
                    if (result.status === 200) {
                        showStatus('Behavior analysis completed', 'success');
                        showOutput(result.data);
                        setLastResult(result.data, 'behavior_analysis');
                    } else {
                        showStatus('Behavior analysis failed', 'error');
                        showOutput(result.data);
                        setLastResult(result.data, 'behavior_analysis_failed');
                    }
                } catch (error) {
                    stopLoading();
                    showStatus(`Behavior analysis error: ${error.message}`, 'error');
                    setLastResult({ error: error.message }, 'behavior_analysis_error');
                }
            } else {
                showStatus('Please select a file first', 'error');
                stopLoading();
            }
        }
        async function runSignatureCheck(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            if (window.selectedFile) {
                try {
                    const result = await api('/cli', 'POST', { command: 'analyze', args: [window.selectedFile.name, '--signature-check'] });
                    stopLoading();
                    if (result.status === 200) {
                        showStatus('Signature check completed', 'success');
                        showOutput(result.data);
                        setLastResult(result.data, 'signature_check');
                    } else {
                        showStatus('Signature check failed', 'error');
                        showOutput(result.data);
                        setLastResult(result.data, 'signature_check_failed');
                    }
                } catch (error) {
                    stopLoading();
                    showStatus(`Signature check error: ${error.message}`, 'error');
                    setLastResult({ error: error.message }, 'signature_check_error');
                }
            } else {
                showStatus('Please select a file first', 'error');
                stopLoading();
            }
        }
        async function runForensicsScan(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            if (window.selectedFile) {
                try {
                    const result = await api('/cli', 'POST', { command: 'analyze', args: [window.selectedFile.name, '--forensics'] });
                    stopLoading();
                    if (result.status === 200) {
                        showStatus('Forensics scan completed', 'success');
                        showOutput(result.data);
                        setLastResult(result.data, 'forensics_scan');
                    } else {
                        showStatus('Forensics scan failed', 'error');
                        showOutput(result.data);
                        setLastResult(result.data, 'forensics_scan_failed');
                    }
                } catch (error) {
                    stopLoading();
                    showStatus(`Forensics scan error: ${error.message}`, 'error');
                    setLastResult({ error: error.message }, 'forensics_scan_error');
                }
            } else {
                showStatus('Please select a file first', 'error');
                stopLoading();
            }
        }
        async function runDataRecovery(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'fileops', args: ['recover'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Data recovery completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'data_recovery');
                } else {
                    showStatus('Data recovery failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'data_recovery_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Data recovery error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'data_recovery_error');
            }
        }
        async function runTimelineAnalysis(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            if (window.selectedFile) {
                try {
                    const result = await api('/cli', 'POST', { command: 'analyze', args: [window.selectedFile.name, '--timeline'] });
                    stopLoading();
                    if (result.status === 200) {
                        showStatus('Timeline analysis completed', 'success');
                        showOutput(result.data);
                        setLastResult(result.data, 'timeline_analysis');
                    } else {
                        showStatus('Timeline analysis failed', 'error');
                        showOutput(result.data);
                        setLastResult(result.data, 'timeline_analysis_failed');
                    }
                } catch (error) {
                    stopLoading();
                    showStatus(`Timeline analysis error: ${error.message}`, 'error');
                    setLastResult({ error: error.message }, 'timeline_analysis_error');
                }
            } else {
                showStatus('Please select a file first', 'error');
                stopLoading();
            }
        }
        async function runDisassembly(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            if (window.selectedFile) {
                try {
                    const result = await api('/cli', 'POST', { command: 'analyze', args: [window.selectedFile.name, '--disassemble'] });
                    stopLoading();
                    if (result.status === 200) {
                        showStatus('Disassembly completed', 'success');
                        showOutput(result.data);
                        setLastResult(result.data, 'disassembly');
                    } else {
                        showStatus('Disassembly failed', 'error');
                        showOutput(result.data);
                        setLastResult(result.data, 'disassembly_failed');
                    }
                } catch (error) {
                    stopLoading();
                    showStatus(`Disassembly error: ${error.message}`, 'error');
                    setLastResult({ error: error.message }, 'disassembly_error');
                }
            } else {
                showStatus('Please select a file first', 'error');
                stopLoading();
            }
        }
        async function runDecompilation(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            if (window.selectedFile) {
                try {
                    const result = await api('/cli', 'POST', { command: 'analyze', args: [window.selectedFile.name, '--decompile'] });
                    stopLoading();
                    if (result.status === 200) {
                        showStatus('Decompilation completed', 'success');
                        showOutput(result.data);
                        setLastResult(result.data, 'decompilation');
                    } else {
                        showStatus('Decompilation failed', 'error');
                        showOutput(result.data);
                        setLastResult(result.data, 'decompilation_failed');
                    }
                } catch (error) {
                    stopLoading();
                    showStatus(`Decompilation error: ${error.message}`, 'error');
                    setLastResult({ error: error.message }, 'decompilation_error');
                }
            } else {
                showStatus('Please select a file first', 'error');
                stopLoading();
            }
        }
        async function runStringExtraction(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            if (window.selectedFile) {
                try {
                    const result = await api('/cli', 'POST', { command: 'analyze', args: [window.selectedFile.name, '--strings'] });
                    stopLoading();
                    if (result.status === 200) {
                        showStatus('String extraction completed', 'success');
                        showOutput(result.data);
                        setLastResult(result.data, 'string_extraction');
                    } else {
                        showStatus('String extraction failed', 'error');
                        showOutput(result.data);
                        setLastResult(result.data, 'string_extraction_failed');
                    }
                } catch (error) {
                    stopLoading();
                    showStatus(`String extraction error: ${error.message}`, 'error');
                    setLastResult({ error: error.message }, 'string_extraction_error');
                }
            } else {
                showStatus('Please select a file first', 'error');
                stopLoading();
            }
        }
        async function runMemoryAnalysis(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'analyze', args: ['--memory'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Memory analysis completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'memory_analysis');
                } else {
                    showStatus('Memory analysis failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'memory_analysis_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Memory analysis error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'memory_analysis_error');
            }
        }
        async function runProcessDump(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'processes', args: ['--dump'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Process dump completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'process_dump');
                } else {
                    showStatus('Process dump failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'process_dump_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Process dump error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'process_dump_error');
            }
        }
        async function runHeapAnalysis(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'analyze', args: ['--heap'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Heap analysis completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'heap_analysis');
                } else {
                    showStatus('Heap analysis failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'heap_analysis_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Heap analysis error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'heap_analysis_error');
            }
        }
        async function runRandomMath(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/random', 'POST', { length: 16 });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Random math completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'random_math');
                } else {
                    showStatus('Random math failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'random_math_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Random math error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'random_math_error');
            }
        }
        async function runDataConversion(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'base64encode', args: ['test data'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Data conversion completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'data_conversion');
                } else {
                    showStatus('Data conversion failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'data_conversion_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Data conversion error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'data_conversion_error');
            }
        }
        async function runCompress(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'fileops', args: ['compress'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Compression completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'compression');
                } else {
                    showStatus('Compression failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'compression_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Compression error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'compression_error');
            }
        }
        async function runDecompress(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'fileops', args: ['decompress'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Decompression completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'decompression');
                } else {
                    showStatus('Decompression failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'decompression_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Decompression error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'decompression_error');
            }
        }
        async function runQRGenerate(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'generate', args: ['qr', 'test data'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('QR code generated', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'qr_generation');
                } else {
                    showStatus('QR code generation failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'qr_generation_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`QR code generation error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'qr_generation_error');
            }
        }
        async function runBarcodeGenerate(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'generate', args: ['barcode', 'test data'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Barcode generated', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'barcode_generation');
                } else {
                    showStatus('Barcode generation failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'barcode_generation_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Barcode generation error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'barcode_generation_error');
            }
        }
        async function runNetworkScan(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'portscan', args: ['localhost', '1', '1000'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Network scan completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'network_scan');
                } else {
                    showStatus('Network scan failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'network_scan_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Network scan error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'network_scan_error');
            }
        }
        async function runServiceDetection(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'portscan', args: ['localhost', '80', '443'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Service detection completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'service_detection');
                } else {
                    showStatus('Service detection failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'service_detection_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Service detection error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'service_detection_error');
            }
        }
        async function runVulnerabilityScan(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'analyze', args: ['--vulnerability-scan'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Vulnerability scan completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'vulnerability_scan');
                } else {
                    showStatus('Vulnerability scan failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'vulnerability_scan_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Vulnerability scan error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'vulnerability_scan_error');
            }
        }
        async function runPacketCapture(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'network', args: ['--capture'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Packet capture completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'packet_capture');
                } else {
                    showStatus('Packet capture failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'packet_capture_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Packet capture error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'packet_capture_error');
            }
        }
        async function runTrafficAnalysis(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'network', args: ['--traffic'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Traffic analysis completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'traffic_analysis');
                } else {
                    showStatus('Traffic analysis failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'traffic_analysis_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Traffic analysis error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'traffic_analysis_error');
            }
        }
        async function runProtocolAnalysis(button = null) {
            const stopLoading = button ? showLoading(button) : () => {};
            
            try {
                const result = await api('/cli', 'POST', { command: 'network', args: ['--protocol'] });
                stopLoading();
                if (result.status === 200) {
                    showStatus('Protocol analysis completed', 'success');
                    showOutput(result.data);
                    setLastResult(result.data, 'protocol_analysis');
                } else {
                    showStatus('Protocol analysis failed', 'error');
                    showOutput(result.data);
                    setLastResult(result.data, 'protocol_analysis_failed');
                }
            } catch (error) {
                stopLoading();
                showStatus(`Protocol analysis error: ${error.message}`, 'error');
                setLastResult({ error: error.message }, 'protocol_analysis_error');
            }
        }
        
        // Test function to check if JavaScript is working
        function testJavaScript() {
            console.log('JavaScript is working!');
            showStatus('JavaScript is working!', 'success');
        }
        
        // Comprehensive test function for all event handlers
        function testAllHandlers() {
            console.log('Testing all event handlers...');
            
            // Test tab switching
            showTab('crypto');
            console.log('[INFO] Tab switching works');
            
            // Test API function
            api('/health').then(result => {
                console.log('[INFO] API function works:', result);
                if (result.status === 200) {
                    showStatus('Connection successful! RawrZ API is running.', 'success');
                } else {
                    showStatus('API test completed with status: ' + result.status, 'info');
                }
            });
            
            // Test status display
            showStatus('All handlers test completed!', 'success');
            console.log('[INFO] Status display works');
            
            // Test output display
            showOutput({test: 'All handlers working correctly'});
            console.log('[INFO] Output display works');
        }
        
        // Test function for all checkboxes and toggles
        function testAllCheckboxes() {
            console.log('Testing all checkboxes and toggles...');
            
            // Test save system checkboxes
            const includeTimestamp = document.getElementById('includeTimestamp');
            const includeMetadata = document.getElementById('includeMetadata');
            
            if (includeTimestamp && includeMetadata) {
                console.log('[INFO] Save system checkboxes found');
                console.log('  - Include timestamp:', includeTimestamp.checked);
                console.log('  - Include metadata:', includeMetadata.checked);
            }
            
            // Test stub generation checkboxes
            const stubCheckboxes = [
                'stubAntiDebug', 'stubAntiVM', 'stubAntiSandbox',
                'stubHotPatch', 'stubMemoryProtect', 'stubObfuscation', 'stubPacking'
            ];
            
            stubCheckboxes.forEach(id => {
                const checkbox = document.getElementById(id);
                if (checkbox) {
                    console.log(`[INFO] ${id}:`, checkbox.checked);
                } else {
                    console.log(`[INFO] ${id}: Not found`);
                }
            });
            
            // Test CLI history toggle
            const cliHistory = document.getElementById('cliHistory');
            if (cliHistory) {
                console.log('[INFO] CLI history toggle found');
                console.log('  - Current display:', cliHistory.style.display);
            }
            
            showStatus('All checkboxes and toggles tested!', 'success');
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Panel initialized');
            document.getElementById('authToken').value = authToken;
            checkHealth();
            initializeOpenSSLManager();
            initializeInteractiveControls();
            loadCustomCommands(); // Load custom commands on page load
            initializeInteractiveCLI(); // Initialize interactive CLI terminal
            
            // Force UI update after a short delay to ensure elements are loaded
            setTimeout(() => {
                console.log('Force updating OpenSSL UI after delay...');
                updateOpenSSLUI();
            }, 1000);
        });

        // Payload Manager functions
        async function quickCreatePayload(button) {
            const stopLoading = showLoading(button);
            
            try {
                const type = document.getElementById('quickPayloadType').value;
                const name = document.getElementById('quickPayloadName').value;
                
                if (!name.trim()) {
                    showStatus('Please enter a payload name', 'error', 'payload-status-display');
                    return;
                }
                
                const payloadData = {
                    name: name.trim(),
                    type: type,
                    description: `Quick created ${type} payload`,
                    config: {}
                };
                
                showStatus('Creating payload...', 'info', 'payload-status-display');
                
                const response = await fetch('/payload-manager/create', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payloadData)
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showStatus(`Payload "${data.payload.name}" created successfully! ID: ${data.payload.id}`, 'success', 'payload-status-display');
                    document.getElementById('quickPayloadName').value = '';
                } else {
                    showStatus(`Error: ${data.error}`, 'error', 'payload-status-display');
                }
            } catch (error) {
                showStatus(`Error: ${error.message}`, 'error', 'payload-status-display');
            } finally {
                stopLoading();
            }
        }

        async function loadPayloadStats(button) {
            const stopLoading = showLoading(button);
            
            try {
                showStatus('Loading payload statistics...', 'info', 'payload-stats-display');
                
                const response = await fetch('/payload-manager/status');
                const data = await response.json();
                
                if (data.success) {
                    const status = data.status;
                    const statsHtml = `
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-top: 1rem;">
                            <div style="text-align: center; padding: 1rem; background: #1a202c; border-radius: 8px;">
                                <div style="font-size: 1.5rem; color: #68d391; font-weight: bold;">${status.payloadCount}</div>
                                <div style="color: #a0aec0; font-size: 0.9rem;">Total Payloads</div>
                            </div>
                            <div style="text-align: center; padding: 1rem; background: #1a202c; border-radius: 8px;">
                                <div style="font-size: 1.5rem; color: #4299e1; font-weight: bold;">${status.payloadTypes.length}</div>
                                <div style="color: #a0aec0; font-size: 0.9rem;">Payload Types</div>
                            </div>
                            <div style="text-align: center; padding: 1rem; background: #1a202c; border-radius: 8px;">
                                <div style="font-size: 1.5rem; color: ${status.initialized ? '#68d391' : '#f56565'}; font-weight: bold;">${status.initialized ? 'Active' : 'Inactive'}</div>
                                <div style="color: #a0aec0; font-size: 0.9rem;">Status</div>
                            </div>
                        </div>
                        <div style="margin-top: 1rem;">
                            <strong>Payload Types:</strong> ${status.payloadTypes.join(', ')}
                        </div>
                        ${status.lastUpdated ? `<div style="margin-top: 0.5rem;"><strong>Last Updated:</strong> ${new Date(status.lastUpdated).toLocaleString()}</div>` : ''}
                    `;
                    
                    document.getElementById('payload-stats-display').innerHTML = statsHtml;
                } else {
                    showStatus(`Error: ${data.error}`, 'error', 'payload-stats-display');
                }
            } catch (error) {
                showStatus(`Error: ${error.message}`, 'error', 'payload-stats-display');
            } finally {
                stopLoading();
            }
        }

        function openPayloadCLI(button) {
            const stopLoading = showLoading(button);
            
            try {
                // Show instructions for opening CLI
                const instructions = `
                    <div style="background: #1a202c; padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                        <h4 style="color: #68d391; margin-bottom: 1rem;">CLI Access Instructions:</h4>
                        <div style="font-family: monospace; color: #a0aec0; line-height: 1.6;">
                            <strong>Option 1 - NPM Scripts:</strong><br>
                            npm run payload-cli<br>
                            npm run payloads<br><br>
                            
                            <strong>Option 2 - Direct Node:</strong><br>
                            node cli/payload-cli.js<br><br>
                            
                            <strong>Option 3 - Make Executable:</strong><br>
                            chmod +x cli/payload-cli.js<br>
                            ./cli/payload-cli.js<br><br>
                            
                            <em style="color: #fbb6ce;">Note: Make sure the RawrZ server is running before using the CLI.</em>
                        </div>
                    </div>
                `;
                
                document.getElementById('payload-stats-display').innerHTML = instructions;
            } finally {
                stopLoading();
            }
        }

        // HTTP Bot Panel Functions
        async function connectHTTPBot() {
            const botId = document.getElementById('httpBotId').value || 'bot-' + Date.now();
            const server = document.getElementById('httpBotServer').value;
            
            try {
                const response = await fetch('/http-bot/connect', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ botId, server })
                });
                const result = await response.json();
                showStatus(result.success ? 'Bot connected successfully' : 'Bot connection failed: ' + result.error, result.success ? 'success' : 'error', 'http-bot-status');
            } catch (error) {
                showStatus('Connection error: ' + error.message, 'error', 'http-bot-status');
            }
        }

        async function disconnectHTTPBot() {
            const botId = document.getElementById('httpBotId').value;
            if (!botId) {
                showStatus('Please enter a bot ID', 'error', 'http-bot-status');
                return;
            }
            
            try {
                const response = await fetch('/http-bot/disconnect', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ botId })
                });
                const result = await response.json();
                showStatus(result.success ? 'Bot disconnected successfully' : 'Bot disconnection failed: ' + result.error, result.success ? 'success' : 'error', 'http-bot-status');
            } catch (error) {
                showStatus('Disconnection error: ' + error.message, 'error', 'http-bot-status');
            }
        }

        async function getHTTPBotStatus() {
            try {
                const response = await fetch('/http-bot/status', {
                    headers: { 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') }
                });
                const result = await response.json();
                showStatus('Active bots: ' + (result.activeBots || 0), 'info', 'http-bot-status');
            } catch (error) {
                showStatus('Status error: ' + error.message, 'error', 'http-bot-status');
            }
        }

        async function executeHTTPBotCommand() {
            const botId = document.getElementById('httpBotId').value;
            const command = document.getElementById('httpBotCommand').value;
            
            if (!botId) {
                showStatus('Please enter a bot ID', 'error', 'http-bot-command-result');
                return;
            }
            
            try {
                const response = await fetch('/http-bot/command', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ botId, command })
                });
                const result = await response.json();
                showStatus(result.success ? 'Command executed successfully' : 'Command failed: ' + result.error, result.success ? 'success' : 'error', 'http-bot-command-result');
            } catch (error) {
                showStatus('Command error: ' + error.message, 'error', 'http-bot-command-result');
            }
        }

        // Anti-Analysis Functions
        async function runAntiAnalysis() {
            const file = document.getElementById('antiAnalysisFile').value || 'test.exe';
            const type = document.getElementById('antiAnalysisType').value;
            
            try {
                const response = await fetch('/anti-analysis/check', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ file, type })
                });
                const result = await response.json();
                showStatus(result.success ? 'Analysis completed' : 'Analysis failed: ' + result.error, result.success ? 'success' : 'error', 'anti-analysis-result');
            } catch (error) {
                showStatus('Analysis error: ' + error.message, 'error', 'anti-analysis-result');
            }
        }

        // Stealth Engine Functions
        async function activateStealth() {
            const mode = document.getElementById('stealthMode').value;
            const target = document.getElementById('stealthTarget').value || 'notepad.exe';
            
            try {
                const response = await fetch('/stealth/activate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ mode, target })
                });
                const result = await response.json();
                showStatus(result.success ? 'Stealth activated' : 'Stealth activation failed: ' + result.error, result.success ? 'success' : 'error', 'stealth-status');
            } catch (error) {
                showStatus('Stealth error: ' + error.message, 'error', 'stealth-status');
            }
        }

        async function deactivateStealth() {
            try {
                const response = await fetch('/stealth/deactivate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') }
                });
                const result = await response.json();
                showStatus(result.success ? 'Stealth deactivated' : 'Stealth deactivation failed: ' + result.error, result.success ? 'success' : 'error', 'stealth-status');
            } catch (error) {
                showStatus('Stealth error: ' + error.message, 'error', 'stealth-status');
            }
        }

        // FUD Engine Functions
        async function generateFUD() {
            const level = document.getElementById('fudLevel').value;
            const target = document.getElementById('fudTarget').value || 'test.exe';
            
            try {
                const response = await fetch('/fud/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ level, target })
                });
                const result = await response.json();
                showStatus(result.success ? 'FUD generated successfully' : 'FUD generation failed: ' + result.error, result.success ? 'success' : 'error', 'fud-result');
            } catch (error) {
                showStatus('FUD error: ' + error.message, 'error', 'fud-result');
            }
        }

        async function testFUD() {
            const target = document.getElementById('fudTarget').value || 'test.exe';
            
            try {
                const response = await fetch('/fud/test', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ target })
                });
                const result = await response.json();
                showStatus(result.success ? 'FUD test completed' : 'FUD test failed: ' + result.error, result.success ? 'success' : 'error', 'fud-result');
            } catch (error) {
                showStatus('FUD test error: ' + error.message, 'error', 'fud-result');
            }
        }

        // Digital Forensics Functions
        async function runForensics() {
            const type = document.getElementById('forensicsType').value;
            const target = document.getElementById('forensicsTarget').value || 'C:\\';
            
            try {
                const response = await fetch('/forensics/analyze', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ type, target })
                });
                const result = await response.json();
                showStatus(result.success ? 'Forensics analysis completed' : 'Forensics analysis failed: ' + result.error, result.success ? 'success' : 'error', 'forensics-result');
            } catch (error) {
                showStatus('Forensics error: ' + error.message, 'error', 'forensics-result');
            }
        }

        async function generateReport() {
            try {
                const response = await fetch('/forensics/report', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') }
                });
                const result = await response.json();
                showStatus(result.success ? 'Report generated successfully' : 'Report generation failed: ' + result.error, result.success ? 'success' : 'error', 'forensics-result');
            } catch (error) {
                showStatus('Report error: ' + error.message, 'error', 'forensics-result');
            }
        }

        // Reverse Engineering Functions
        async function runReverseEngineering() {
            const target = document.getElementById('reverseTarget').value || 'test.exe';
            const type = document.getElementById('reverseType').value;
            
            try {
                const response = await fetch('/api/analysis/reverse-engineering', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ file: target, type })
                });
                const result = await response.json();
                showStatus(result.success ? 'Reverse engineering completed' : 'Reverse engineering failed: ' + result.error, result.success ? 'success' : 'error', 'reverse-result');
            } catch (error) {
                showStatus('Reverse engineering error: ' + error.message, 'error', 'reverse-result');
            }
        }

        async function decompileFile() {
            const target = document.getElementById('reverseTarget').value || 'test.exe';
            
            try {
                const response = await fetch('/reverse/decompile', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ file: target })
                });
                const result = await response.json();
                showStatus(result.success ? 'Decompilation completed' : 'Decompilation failed: ' + result.error, result.success ? 'success' : 'error', 'reverse-result');
            } catch (error) {
                showStatus('Decompilation error: ' + error.message, 'error', 'reverse-result');
            }
        }

        // Hot Patchers Functions
        async function applyHotPatch() {
            const target = document.getElementById('hotPatchTarget').value || 'notepad.exe';
            const type = document.getElementById('hotPatchType').value;
            const data = document.getElementById('hotPatchData').value || 'test patch';
            
            try {
                const response = await fetch('/hot-patch', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ target, type, data })
                });
                const result = await response.json();
                showStatus(result.success ? 'Hot patch applied successfully' : 'Hot patch failed: ' + result.error, result.success ? 'success' : 'error', 'hot-patch-result');
            } catch (error) {
                showStatus('Hot patch error: ' + error.message, 'error', 'hot-patch-result');
            }
        }

        async function revertHotPatch() {
            const target = document.getElementById('hotPatchTarget').value || 'notepad.exe';
            
            try {
                const response = await fetch('/hot-patch/rollback', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ target })
                });
                const result = await response.json();
                showStatus(result.success ? 'Hot patch reverted successfully' : 'Hot patch revert failed: ' + result.error, result.success ? 'success' : 'error', 'hot-patch-result');
            } catch (error) {
                showStatus('Hot patch revert error: ' + error.message, 'error', 'hot-patch-result');
            }
        }

        // Native Compiler Functions
        async function compileNative() {
            const sourceLang = document.getElementById('nativeSourceLang').value;
            const target = document.getElementById('nativeTarget').value;
            const source = document.getElementById('nativeSource').value || 'int main() { return 0; }';
            
            try {
                const response = await fetch('/native/compile', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ sourceLang, target, source })
                });
                const result = await response.json();
                showStatus(result.success ? 'Native compilation completed' : 'Native compilation failed: ' + result.error, result.success ? 'success' : 'error', 'native-compile-result');
            } catch (error) {
                showStatus('Native compilation error: ' + error.message, 'error', 'native-compile-result');
            }
        }

        async function optimizeNative() {
            const sourceLang = document.getElementById('nativeSourceLang').value;
            const source = document.getElementById('nativeSource').value || 'int main() { return 0; }';
            
            try {
                const response = await fetch('/native/optimize', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ sourceLang, source })
                });
                const result = await response.json();
                showStatus(result.success ? 'Native optimization completed' : 'Native optimization failed: ' + result.error, result.success ? 'success' : 'error', 'native-compile-result');
            } catch (error) {
                showStatus('Native optimization error: ' + error.message, 'error', 'native-compile-result');
            }
        }

        // Red Killer Functions
        async function executeRedKiller() {
            const target = document.getElementById('redKillerTarget').value;
            const method = document.getElementById('redKillerMethod').value;
            
            try {
                const response = await fetch('/red-killer/execute', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ target, method })
                });
                const result = await response.json();
                showStatus(result.success ? 'Red Killer executed successfully' : 'Red Killer execution failed: ' + result.error, result.success ? 'success' : 'error', 'red-killer-result');
            } catch (error) {
                showStatus('Red Killer error: ' + error.message, 'error', 'red-killer-result');
            }
        }

        async function scanTargets() {
            try {
                const response = await fetch('/red-killer/scan', {
                    headers: { 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') }
                });
                const result = await response.json();
                showStatus(result.success ? 'Target scan completed' : 'Target scan failed: ' + result.error, result.success ? 'success' : 'error', 'red-killer-result');
            } catch (error) {
                showStatus('Target scan error: ' + error.message, 'error', 'red-killer-result');
            }
        }

        // Red Shells Functions
        async function createRedShell() {
            const type = document.getElementById('redShellType').value;
            const host = document.getElementById('redShellHost').value || '127.0.0.1';
            const port = document.getElementById('redShellPort').value || '4444';
            
            try {
                const response = await fetch('/red-shells/create', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ type, host, port })
                });
                const result = await response.json();
                showStatus(result.success ? 'Red shell created successfully' : 'Red shell creation failed: ' + result.error, result.success ? 'success' : 'error', 'red-shells-result');
            } catch (error) {
                showStatus('Red shell error: ' + error.message, 'error', 'red-shells-result');
            }
        }

        async function listRedShells() {
            try {
                const response = await fetch('/red-shells/list', {
                    headers: { 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') }
                });
                const result = await response.json();
                showStatus(result.success ? 'Red shells listed successfully' : 'Red shells listing failed: ' + result.error, result.success ? 'success' : 'error', 'red-shells-result');
            } catch (error) {
                showStatus('Red shells listing error: ' + error.message, 'error', 'red-shells-result');
            }
        }

        // Beaconism DLL Functions
        async function generateBeaconism() {
            const payload = document.getElementById('beaconismPayload').value;
            const target = document.getElementById('beaconismTarget').value || 'notepad.exe';
            const evasion = document.getElementById('beaconismEvasion').value;
            
            try {
                const response = await fetch('/beaconism/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ payload, target, evasion })
                });
                const result = await response.json();
                showStatus(result.success ? 'Beaconism payload generated successfully' : 'Beaconism generation failed: ' + result.error, result.success ? 'success' : 'error', 'beaconism-result');
            } catch (error) {
                showStatus('Beaconism error: ' + error.message, 'error', 'beaconism-result');
            }
        }

        async function deployBeaconism() {
            const payload = document.getElementById('beaconismPayload').value;
            const target = document.getElementById('beaconismTarget').value || 'notepad.exe';
            
            try {
                const response = await fetch('/beaconism/deploy', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ payload, target })
                });
                const result = await response.json();
                showStatus(result.success ? 'Beaconism payload deployed successfully' : 'Beaconism deployment failed: ' + result.error, result.success ? 'success' : 'error', 'beaconism-result');
            } catch (error) {
                showStatus('Beaconism deployment error: ' + error.message, 'error', 'beaconism-result');
            }
        }

        // Mutex Engine Functions
        async function generateMutex() {
            const name = document.getElementById('mutexName').value || 'test-mutex';
            const type = document.getElementById('mutexType').value;
            const language = document.getElementById('mutexLanguage').value;
            
            try {
                const response = await fetch('/mutex/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ name, type, language })
                });
                const result = await response.json();
                showStatus(result.success ? 'Mutex generated successfully' : 'Mutex generation failed: ' + result.error, result.success ? 'success' : 'error', 'mutex-result');
            } catch (error) {
                showStatus('Mutex error: ' + error.message, 'error', 'mutex-result');
            }
        }

        async function testMutex() {
            const name = document.getElementById('mutexName').value || 'test-mutex';
            
            try {
                const response = await fetch('/mutex/test', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ name })
                });
                const result = await response.json();
                showStatus(result.success ? 'Mutex test completed' : 'Mutex test failed: ' + result.error, result.success ? 'success' : 'error', 'mutex-result');
            } catch (error) {
                showStatus('Mutex test error: ' + error.message, 'error', 'mutex-result');
            }
        }

        // Polymorphic Engine Functions
        async function polymorphCode() {
            const source = document.getElementById('polymorphicSource').value || 'console.log("hello world");';
            const level = document.getElementById('polymorphicLevel').value;
            const language = document.getElementById('polymorphicLanguage').value;
            
            try {
                const response = await fetch('/polymorphic/transform', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ source, level, language })
                });
                const result = await response.json();
                showStatus(result.success ? 'Code polymorphized successfully' : 'Polymorphism failed: ' + result.error, result.success ? 'success' : 'error', 'polymorphic-result');
            } catch (error) {
                showStatus('Polymorphism error: ' + error.message, 'error', 'polymorphic-result');
            }
        }

        async function testPolymorphic() {
            const source = document.getElementById('polymorphicSource').value || 'console.log("hello world");';
            
            try {
                const response = await fetch('/polymorphic/test', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ source })
                });
                const result = await response.json();
                showStatus(result.success ? 'Polymorphic test completed' : 'Polymorphic test failed: ' + result.error, result.success ? 'success' : 'error', 'polymorphic-result');
            } catch (error) {
                showStatus('Polymorphic test error: ' + error.message, 'error', 'polymorphic-result');
            }
        }

        // Compression Engine Functions
        async function compressData() {
            const type = document.getElementById('compressionType').value;
            const level = document.getElementById('compressionLevel').value;
            const input = document.getElementById('compressionInput').value || 'test data to compress';
            
            try {
                const response = await fetch('/compression/compress', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ type, level, input })
                });
                const result = await response.json();
                showStatus(result.success ? 'Data compressed successfully' : 'Compression failed: ' + result.error, result.success ? 'success' : 'error', 'compression-result');
            } catch (error) {
                showStatus('Compression error: ' + error.message, 'error', 'compression-result');
            }
        }

        async function decompressData() {
            const type = document.getElementById('compressionType').value;
            const input = document.getElementById('compressionInput').value || 'compressed data';
            
            try {
                const response = await fetch('/compression/decompress', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ type, input })
                });
                const result = await response.json();
                showStatus(result.success ? 'Data decompressed successfully' : 'Decompression failed: ' + result.error, result.success ? 'success' : 'error', 'compression-result');
            } catch (error) {
                showStatus('Decompression error: ' + error.message, 'error', 'compression-result');
            }
        }

        // Mobile Tools Functions
        async function generateMobileTool() {
            const platform = document.getElementById('mobilePlatform').value;
            const tool = document.getElementById('mobileTool').value;
            const target = document.getElementById('mobileTarget').value || 'com.example.app';
            
            try {
                const response = await fetch('/mobile/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ platform, tool, target })
                });
                const result = await response.json();
                showStatus(result.success ? 'Mobile tool generated successfully' : 'Mobile tool generation failed: ' + result.error, result.success ? 'success' : 'error', 'mobile-result');
            } catch (error) {
                showStatus('Mobile tool error: ' + error.message, 'error', 'mobile-result');
            }
        }

        async function testMobileTool() {
            const platform = document.getElementById('mobilePlatform').value;
            const tool = document.getElementById('mobileTool').value;
            
            try {
                const response = await fetch('/mobile/test', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ platform, tool })
                });
                const result = await response.json();
                showStatus(result.success ? 'Mobile tool test completed' : 'Mobile tool test failed: ' + result.error, result.success ? 'success' : 'error', 'mobile-result');
            } catch (error) {
                showStatus('Mobile tool test error: ' + error.message, 'error', 'mobile-result');
            }
        }

        // Backup System Functions
        async function createBackup() {
            const type = document.getElementById('backupType').value;
            const source = document.getElementById('backupSource').value || 'C:\\test';
            const destination = document.getElementById('backupDestination').value || 'C:\\backup';
            
            try {
                const response = await fetch('/backup/create', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ type, source, destination })
                });
                const result = await response.json();
                showStatus(result.success ? 'Backup created successfully' : 'Backup creation failed: ' + result.error, result.success ? 'success' : 'error', 'backup-result');
            } catch (error) {
                showStatus('Backup error: ' + error.message, 'error', 'backup-result');
            }
        }

        async function restoreBackup() {
            const destination = document.getElementById('backupDestination').value || 'C:\\backup';
            
            try {
                const response = await fetch('/backup/restore', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ destination })
                });
                const result = await response.json();
                showStatus(result.success ? 'Backup restored successfully' : 'Backup restore failed: ' + result.error, result.success ? 'success' : 'error', 'backup-result');
            } catch (error) {
                showStatus('Backup restore error: ' + error.message, 'error', 'backup-result');
            }
        }

        async function listBackups() {
            try {
                const response = await fetch('/backup/list', {
                    headers: { 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') }
                });
                const result = await response.json();
                showStatus(result.success ? 'Backups listed successfully' : 'Backup listing failed: ' + result.error, result.success ? 'success' : 'error', 'backup-result');
            } catch (error) {
                showStatus('Backup listing error: ' + error.message, 'error', 'backup-result');
            }
        }

        // Implementation Checker Functions
        async function runImplementationCheck() {
            const check = document.getElementById('implementationCheck').value;
            
            try {
                const response = await fetch('/implementation-check/run', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') },
                    body: JSON.stringify({ check })
                });
                const result = await response.json();
                showStatus(result.success ? 'Implementation check completed' : 'Implementation check failed: ' + result.error, result.success ? 'success' : 'error', 'implementation-result');
            } catch (error) {
                showStatus('Implementation check error: ' + error.message, 'error', 'implementation-result');
            }
        }

        async function forceImplementationCheck() {
            try {
                const response = await fetch('/implementation-check/force', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') }
                });
                const result = await response.json();
                showStatus(result.success ? 'Force implementation check completed' : 'Force implementation check failed: ' + result.error, result.success ? 'success' : 'error', 'implementation-result');
            } catch (error) {
                showStatus('Force implementation check error: ' + error.message, 'error', 'implementation-result');
            }
        }

        async function getImplementationStatus() {
            try {
                const response = await fetch('/implementation-check/status', {
                    headers: { 'Authorization': 'Bearer ' + (localStorage.getItem('authToken') || 'test-token') }
                });
                const result = await response.json();
                showStatus(result.success ? 'Implementation status retrieved' : 'Implementation status failed: ' + result.error, result.success ? 'success' : 'error', 'implementation-result');
            } catch (error) {
                showStatus('Implementation status error: ' + error.message, 'error', 'implementation-result');
            }
        }
    </script>

    <!-- HTTP Bot Panel Content -->
    <div id="http-bot" class="tab-content">
        <div class="grid">
            <div class="card">
                <h3>HTTP Bot Management</h3>
                <div class="form-group">
                    <label>Bot ID:</label>
                    <input type="text" id="httpBotId" placeholder="Enter bot ID or leave empty for auto-generate">
                </div>
                <div class="form-group">
                    <label>Server URL:</label>
                    <input type="text" id="httpBotServer" placeholder="http://localhost:8080" value="http://localhost:8080">
                </div>
                <button onclick="connectHTTPBot()">Connect Bot</button>
                <button onclick="disconnectHTTPBot()">Disconnect Bot</button>
                <button onclick="getHTTPBotStatus()">Get Status</button>
                <div id="http-bot-status" class="status-display"></div>
            </div>
            
            <div class="card">
                <h3>Bot Commands</h3>
                <div class="form-group">
                    <label>Command:</label>
                    <select id="httpBotCommand">
                        <option value="screenshot">Take Screenshot</option>
                        <option value="keylog_start">Start Keylogger</option>
                        <option value="keylog_stop">Stop Keylogger</option>
                        <option value="browser_data">Collect Browser Data</option>
                        <option value="crypto_data">Collect Crypto Data</option>
                        <option value="system_info">Get System Info</option>
                        <option value="process_list">List Processes</option>
                        <option value="file_list">List Files</option>
                    </select>
                </div>
                <button onclick="executeHTTPBotCommand()">Execute Command</button>
                <div id="http-bot-command-result" class="status-display"></div>
            </div>
        </div>
    </div>

    <!-- Anti-Analysis Content -->
    <div id="anti-analysis" class="tab-content">
        <div class="grid">
            <div class="card">
                <h3>Anti-Analysis Engine</h3>
                <div class="form-group">
                    <label>Target File:</label>
                    <input type="text" id="antiAnalysisFile" placeholder="Enter file path">
                </div>
                <div class="form-group">
                    <label>Analysis Type:</label>
                    <select id="antiAnalysisType">
                        <option value="sandbox">Sandbox Detection</option>
                        <option value="vm">VM Detection</option>
                        <option value="debugger">Debugger Detection</option>
                        <option value="analysis">Full Analysis</option>
                    </select>
                </div>
                <button onclick="runAntiAnalysis()">Run Analysis</button>
                <div id="anti-analysis-result" class="status-display"></div>
            </div>
        </div>
    </div>

    <!-- Stealth Engine Content -->
    <div id="stealth" class="tab-content">
        <div class="grid">
            <div class="card">
                <h3>Stealth Engine</h3>
                <div class="form-group">
                    <label>Stealth Mode:</label>
                    <select id="stealthMode">
                        <option value="basic">Basic Stealth</option>
                        <option value="advanced">Advanced Stealth</option>
                        <option value="maximum">Maximum Stealth</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Target Process:</label>
                    <input type="text" id="stealthTarget" placeholder="Process name or PID">
                </div>
                <button onclick="activateStealth()">Activate Stealth</button>
                <button onclick="deactivateStealth()">Deactivate Stealth</button>
                <div id="stealth-status" class="status-display"></div>
            </div>
        </div>
    </div>

    <!-- FUD Engine Content -->
    <div id="fud" class="tab-content">
        <div class="grid">
            <div class="card">
                <h3>FUD Engine</h3>
                <div class="form-group">
                    <label>FUD Level:</label>
                    <select id="fudLevel">
                        <option value="low">Low FUD</option>
                        <option value="medium">Medium FUD</option>
                        <option value="high">High FUD</option>
                        <option value="maximum">Maximum FUD</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Target File:</label>
                    <input type="text" id="fudTarget" placeholder="File to make FUD">
                </div>
                <button onclick="generateFUD()">Generate FUD</button>
                <button onclick="testFUD()">Test FUD</button>
                <div id="fud-result" class="status-display"></div>
            </div>
        </div>
    </div>

    <!-- Digital Forensics Content -->
    <div id="forensics" class="tab-content">
        <div class="grid">
            <div class="card">
                <h3>Digital Forensics</h3>
                <div class="form-group">
                    <label>Forensics Type:</label>
                    <select id="forensicsType">
                        <option value="memory">Memory Analysis</option>
                        <option value="disk">Disk Analysis</option>
                        <option value="network">Network Analysis</option>
                        <option value="timeline">Timeline Analysis</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Target:</label>
                    <input type="text" id="forensicsTarget" placeholder="File, directory, or device">
                </div>
                <button onclick="runForensics()">Run Forensics</button>
                <button onclick="generateReport()">Generate Report</button>
                <div id="forensics-result" class="status-display"></div>
            </div>
        </div>
    </div>

    <!-- Reverse Engineering Content -->
    <div id="reverse" class="tab-content">
        <div class="grid">
            <div class="card">
                <h3>Reverse Engineering</h3>
                <div class="form-group">
                    <label>Target File:</label>
                    <input type="text" id="reverseTarget" placeholder="Binary or executable file">
                </div>
                <div class="form-group">
                    <label>Analysis Type:</label>
                    <select id="reverseType">
                        <option value="strings">String Analysis</option>
                        <option value="functions">Function Analysis</option>
                        <option value="imports">Import Analysis</option>
                        <option value="sections">Section Analysis</option>
                        <option value="full">Full Analysis</option>
                    </select>
                </div>
                <button onclick="runReverseEngineering()">Analyze</button>
                <button onclick="decompileFile()">Decompile</button>
                <div id="reverse-result" class="status-display"></div>
            </div>
        </div>
    </div>

    <!-- Hot Patchers Content -->
    <div id="hot-patch" class="tab-content">
        <div class="grid">
            <div class="card">
                <h3>Hot Patchers</h3>
                <div class="form-group">
                    <label>Target Process:</label>
                    <input type="text" id="hotPatchTarget" placeholder="Process name or PID">
                </div>
                <div class="form-group">
                    <label>Patch Type:</label>
                    <select id="hotPatchType">
                        <option value="memory">Memory Patch</option>
                        <option value="api">API Hook</option>
                        <option value="injection">Code Injection</option>
                        <option value="modification">Code Modification</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Patch Data:</label>
                    <textarea id="hotPatchData" placeholder="Patch code or data"></textarea>
                </div>
                <button onclick="applyHotPatch()">Apply Patch</button>
                <button onclick="revertHotPatch()">Revert Patch</button>
                <div id="hot-patch-result" class="status-display"></div>
            </div>
        </div>
    </div>

    <!-- Native Compiler Content -->
    <div id="native-compile" class="tab-content">
        <div class="grid">
            <div class="card">
                <h3>Native Compiler</h3>
                <div class="form-group">
                    <label>Source Language:</label>
                    <select id="nativeSourceLang">
                        <option value="c">C</option>
                        <option value="cpp">C++</option>
                        <option value="rust">Rust</option>
                        <option value="go">Go</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Target Platform:</label>
                    <select id="nativeTarget">
                        <option value="windows">Windows</option>
                        <option value="linux">Linux</option>
                        <option value="macos">macOS</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Source Code:</label>
                    <textarea id="nativeSource" placeholder="Enter source code"></textarea>
                </div>
                <button onclick="compileNative()">Compile</button>
                <button onclick="optimizeNative()">Optimize</button>
                <div id="native-compile-result" class="status-display"></div>
            </div>
        </div>
    </div>

    <!-- Red Killer Content -->
    <div id="red-killer" class="tab-content">
        <div class="grid">
            <div class="card">
                <h3>Red Killer</h3>
                <div class="form-group">
                    <label>Target Type:</label>
                    <select id="redKillerTarget">
                        <option value="av">Antivirus</option>
                        <option value="edr">EDR</option>
                        <option value="firewall">Firewall</option>
                        <option value="all">All Security</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Kill Method:</label>
                    <select id="redKillerMethod">
                        <option value="process">Process Kill</option>
                        <option value="service">Service Stop</option>
                        <option value="registry">Registry Disable</option>
                        <option value="driver">Driver Unload</option>
                    </select>
                </div>
                <button onclick="executeRedKiller()">Execute</button>
                <button onclick="scanTargets()">Scan Targets</button>
                <div id="red-killer-result" class="status-display"></div>
            </div>
        </div>
    </div>

    <!-- Red Shells Content -->
    <div id="red-shells" class="tab-content">
        <div class="grid">
            <div class="card">
                <h3>Red Shells</h3>
                <div class="form-group">
                    <label>Shell Type:</label>
                    <select id="redShellType">
                        <option value="cmd">CMD</option>
                        <option value="powershell">PowerShell</option>
                        <option value="bash">Bash</option>
                        <option value="python">Python</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Target Host:</label>
                    <input type="text" id="redShellHost" placeholder="IP address or hostname">
                </div>
                <div class="form-group">
                    <label>Port:</label>
                    <input type="number" id="redShellPort" placeholder="Port number" value="4444">
                </div>
                <button onclick="createRedShell()">Create Shell</button>
                <button onclick="listRedShells()">List Shells</button>
                <div id="red-shells-result" class="status-display"></div>
            </div>
        </div>
    </div>

    <!-- Beaconism DLL Content -->
    <div id="beaconism" class="tab-content">
        <div class="grid">
            <div class="card">
                <h3>Beaconism DLL Sideloading</h3>
                <div class="form-group">
                    <label>Payload Type:</label>
                    <select id="beaconismPayload">
                        <option value="meterpreter">Meterpreter</option>
                        <option value="beacon">Cobalt Strike Beacon</option>
                        <option value="custom">Custom Payload</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Target Process:</label>
                    <input type="text" id="beaconismTarget" placeholder="Target process for sideloading">
                </div>
                <div class="form-group">
                    <label>Evasion Level:</label>
                    <select id="beaconismEvasion">
                        <option value="basic">Basic</option>
                        <option value="advanced">Advanced</option>
                        <option value="maximum">Maximum</option>
                    </select>
                </div>
                <button onclick="generateBeaconism()">Generate Payload</button>
                <button onclick="deployBeaconism()">Deploy Payload</button>
                <div id="beaconism-result" class="status-display"></div>
            </div>
        </div>
    </div>

    <!-- Mutex Engine Content -->
    <div id="mutex" class="tab-content">
        <div class="grid">
            <div class="card">
                <h3>Mutex Engine</h3>
                <div class="form-group">
                    <label>Mutex Name:</label>
                    <input type="text" id="mutexName" placeholder="Enter mutex name">
                </div>
                <div class="form-group">
                    <label>Mutex Type:</label>
                    <select id="mutexType">
                        <option value="single">Single Instance</option>
                        <option value="named">Named Mutex</option>
                        <option value="anonymous">Anonymous Mutex</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Target Language:</label>
                    <select id="mutexLanguage">
                        <option value="cpp">C++</option>
                        <option value="csharp">C#</option>
                        <option value="python">Python</option>
                    </select>
                </div>
                <button onclick="generateMutex()">Generate Mutex</button>
                <button onclick="testMutex()">Test Mutex</button>
                <div id="mutex-result" class="status-display"></div>
            </div>
        </div>
    </div>

    <!-- Polymorphic Engine Content -->
    <div id="polymorphic" class="tab-content">
        <div class="grid">
            <div class="card">
                <h3>Polymorphic Engine</h3>
                <div class="form-group">
                    <label>Source Code:</label>
                    <textarea id="polymorphicSource" placeholder="Enter code to polymorph"></textarea>
                </div>
                <div class="form-group">
                    <label>Polymorphism Level:</label>
                    <select id="polymorphicLevel">
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                        <option value="maximum">Maximum</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Target Language:</label>
                    <select id="polymorphicLanguage">
                        <option value="javascript">JavaScript</option>
                        <option value="python">Python</option>
                        <option value="cpp">C++</option>
                    </select>
                </div>
                <button onclick="polymorphCode()">Polymorph Code</button>
                <button onclick="testPolymorphic()">Test Output</button>
                <div id="polymorphic-result" class="status-display"></div>
            </div>
        </div>
    </div>

    <!-- Compression Engine Content -->
    <div id="compression" class="tab-content">
        <div class="grid">
            <div class="card">
                <h3>Compression Engine</h3>
                <div class="form-group">
                    <label>Compression Type:</label>
                    <select id="compressionType">
                        <option value="gzip">GZIP</option>
                        <option value="deflate">Deflate</option>
                        <option value="brotli">Brotli</option>
                        <option value="lz4">LZ4</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Compression Level:</label>
                    <select id="compressionLevel">
                        <option value="1">Level 1 (Fastest)</option>
                        <option value="6">Level 6 (Balanced)</option>
                        <option value="9">Level 9 (Best)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Input Data:</label>
                    <textarea id="compressionInput" placeholder="Enter data to compress"></textarea>
                </div>
                <button onclick="compressData()">Compress</button>
                <button onclick="decompressData()">Decompress</button>
                <div id="compression-result" class="status-display"></div>
            </div>
        </div>
    </div>

    <!-- Mobile Tools Content -->
    <div id="mobile" class="tab-content">
        <div class="grid">
            <div class="card">
                <h3>Mobile Tools</h3>
                <div class="form-group">
                    <label>Mobile Platform:</label>
                    <select id="mobilePlatform">
                        <option value="android">Android</option>
                        <option value="ios">iOS</option>
                        <option value="cross">Cross-Platform</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Tool Type:</label>
                    <select id="mobileTool">
                        <option value="payload">Payload Generator</option>
                        <option value="backdoor">Backdoor</option>
                        <option value="keylogger">Keylogger</option>
                        <option value="spyware">Spyware</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Target App:</label>
                    <input type="text" id="mobileTarget" placeholder="Target application">
                </div>
                <button onclick="generateMobileTool()">Generate Tool</button>
                <button onclick="testMobileTool()">Test Tool</button>
                <div id="mobile-result" class="status-display"></div>
            </div>
        </div>
    </div>

    <!-- Backup System Content -->
    <div id="backup" class="tab-content">
        <div class="grid">
            <div class="card">
                <h3>Backup System</h3>
                <div class="form-group">
                    <label>Backup Type:</label>
                    <select id="backupType">
                        <option value="full">Full Backup</option>
                        <option value="incremental">Incremental</option>
                        <option value="differential">Differential</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Source Path:</label>
                    <input type="text" id="backupSource" placeholder="Path to backup">
                </div>
                <div class="form-group">
                    <label>Destination:</label>
                    <input type="text" id="backupDestination" placeholder="Backup destination">
                </div>
                <button onclick="createBackup()">Create Backup</button>
                <button onclick="restoreBackup()">Restore Backup</button>
                <button onclick="listBackups()">List Backups</button>
                <div id="backup-result" class="status-display"></div>
            </div>
        </div>
    </div>

    <!-- Implementation Checker Content -->
    <div id="implementation" class="tab-content">
        <div class="grid">
            <div class="card">
                <h3>Implementation Checker</h3>
                <div class="form-group">
                    <label>Check Type:</label>
                    <select id="implementationCheck">
                        <option value="modules">Module Check</option>
                        <option value="endpoints">Endpoint Check</option>
                        <option value="dependencies">Dependency Check</option>
                        <option value="full">Full System Check</option>
                    </select>
                </div>
                <button onclick="runImplementationCheck()">Run Check</button>
                <button onclick="forceImplementationCheck()">Force Check</button>
                <button onclick="getImplementationStatus()">Get Status</button>
                <div id="implementation-result" class="status-display"></div>
            </div>
        </div>
    </div>

</body>
</html>
