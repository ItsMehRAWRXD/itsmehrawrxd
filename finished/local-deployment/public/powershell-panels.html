<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RawrZ PowerShell Utilities Panel</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Consolas', 'Monaco', monospace;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            color: #00ff00;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .header {
            background: linear-gradient(90deg, #ff0000, #ff6600, #ffff00, #00ff00, #0066ff, #6600ff);
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0, 255, 0, 0.3);
        }

        .header h1 {
            color: #000;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.5);
            margin-bottom: 10px;
        }

        .header p {
            color: #000;
            font-size: 1.2em;
            font-weight: bold;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .panel {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #00ff00;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
            transition: all 0.3s ease;
        }

        .panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 255, 0, 0.5);
        }

        .panel h3 {
            color: #00ff00;
            font-size: 1.5em;
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 2px solid #00ff00;
            padding-bottom: 10px;
        }

        .panel p {
            color: #cccccc;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .file-input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #00ff00;
            border-radius: 5px;
            color: #00ff00;
            font-family: inherit;
        }

        .file-input:focus {
            outline: none;
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
        }

        .btn {
            background: linear-gradient(45deg, #ff0000, #ff6600);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s ease;
            width: 100%;
            margin: 10px 0;
        }

        .btn:hover {
            background: linear-gradient(45deg, #ff6600, #ffff00);
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(255, 102, 0, 0.4);
        }

        .btn:active {
            transform: scale(0.95);
        }

        .output {
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid #00ff00;
            border-radius: 5px;
            padding: 15px;
            margin-top: 15px;
            min-height: 100px;
            font-family: 'Consolas', monospace;
            font-size: 0.9em;
            color: #00ff00;
            white-space: pre-wrap;
            overflow-y: auto;
            max-height: 300px;
        }

        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-weight: bold;
            text-align: center;
        }

        .status.success {
            background: rgba(0, 255, 0, 0.2);
            border: 1px solid #00ff00;
            color: #00ff00;
        }

        .status.error {
            background: rgba(255, 0, 0, 0.2);
            border: 1px solid #ff0000;
            color: #ff0000;
        }

        .status.info {
            background: rgba(0, 102, 255, 0.2);
            border: 1px solid #0066ff;
            color: #0066ff;
        }

        .drag-drop {
            border: 2px dashed #00ff00;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            margin: 15px 0;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .drag-drop:hover {
            background: rgba(0, 255, 0, 0.1);
            border-color: #ffff00;
        }

        .drag-drop.dragover {
            background: rgba(0, 255, 0, 0.2);
            border-color: #ff0000;
        }

        .tool-description {
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            border-left: 4px solid #00ff00;
        }

        .warning {
            background: rgba(255, 165, 0, 0.2);
            border: 1px solid #ffa500;
            color: #ffa500;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .container {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>RawrZ PowerShell Utilities Panel</h1>
        <p>Advanced Evasion Tools - Interactive Web Interface</p>
    </div>

    <div class="container">
        <div class="warning">
            ‚ö†Ô∏è WARNING: These tools are for educational and authorized security testing purposes only. Use responsibly and in compliance with applicable laws.
        </div>

        <div class="grid">
            <!-- EvAdrKiller Panel -->
            <div class="panel">
                <h3>üî¥ EvAdrKiller</h3>
                <div class="tool-description">
                    <strong>EV/ADR Certificate Killer</strong><br>
                    In-memory patching to neutralize EV/ADR certificate tables and strip AMSI/ETW hooks.
                </div>
                <div class="drag-drop" id="evadr-drop">
                    <p>üìÅ Drag & Drop executable here</p>
                    <p>or</p>
                    <input type="file" id="evadr-file" class="file-input" accept=".exe,.dll,.sys">
                </div>
                <button class="btn" onclick="executeEvAdrKiller()">Execute EvAdrKiller</button>
                <div id="evadr-status"></div>
                <div id="evadr-output" class="output"></div>
            </div>

            <!-- Beaconism Dropper Panel -->
            <div class="panel">
                <h3>üü° Beaconism Dropper</h3>
                <div class="tool-description">
                    <strong>Beacon Stub Injector</strong><br>
                    Drag-and-drop beacon stub injection into DLLs/XLLs/LNKs with in-memory execution.
                </div>
                <div class="drag-drop" id="beacon-drop">
                    <p>üìÅ Drag & Drop .xll/.lnk/.dll here</p>
                    <p>or</p>
                    <input type="file" id="beacon-file" class="file-input" accept=".xll,.lnk,.dll">
                </div>
                <button class="btn" onclick="executeBeaconism()">Execute Beaconism</button>
                <div id="beacon-status"></div>
                <div id="beacon-output" class="output"></div>
            </div>

            <!-- CppEncExe Panel -->
            <div class="panel">
                <h3>üîµ CppEncExe</h3>
                <div class="tool-description">
                    <strong>C++ Compiler & Camellia Encryptor</strong><br>
                    Drag-and-drop C++ compilation with in-memory Camellia-256 encryption.
                </div>
                <div class="drag-drop" id="cppenc-drop">
                    <p>üìÅ Drag & Drop .cpp file here</p>
                    <p>or</p>
                    <input type="file" id="cppenc-file" class="file-input" accept=".cpp,.c">
                </div>
                <button class="btn" onclick="executeCppEncExe()">Compile & Encrypt</button>
                <div id="cppenc-status"></div>
                <div id="cppenc-output" class="output"></div>
            </div>

            <!-- File-less Hot-patch Panel -->
            <div class="panel">
                <h3>üü¢ File-less Hot-patch</h3>
                <div class="tool-description">
                    <strong>FHp - File-less Hot-patch</strong><br>
                    Compiles C++ in memory, encrypts, and hot-injects into current process.
                </div>
                <div class="drag-drop" id="fhp-drop">
                    <p>üìÅ Drag & Drop .cpp file here</p>
                    <p>or</p>
                    <input type="file" id="fhp-file" class="file-input" accept=".cpp,.c">
                </div>
                <button class="btn" onclick="executeFHp()">Execute File-less Hot-patch</button>
                <div id="fhp-status"></div>
                <div id="fhp-output" class="output"></div>
            </div>

            <!-- Triple Crypto Panel -->
            <div class="panel">
                <h3>üü£ Triple Crypto</h3>
                <div class="tool-description">
                    <strong>Triple Encryption (Camellia + AES + ChaCha20)</strong><br>
                    Drag-and-drop 3-layer cascade encryption with Argon2id key derivation.
                </div>
                <div class="drag-drop" id="triple-drop">
                    <p>üìÅ Drag & Drop any file here</p>
                    <p>or</p>
                    <input type="file" id="triple-file" class="file-input">
                </div>
                <input type="password" id="triple-password" class="file-input" placeholder="Enter passphrase (optional)">
                <button class="btn" onclick="executeTripleCrypto()">Triple Encrypt</button>
                <div id="triple-status"></div>
                <div id="triple-output" class="output"></div>
            </div>

            <!-- Hot Drop Panel -->
            <div class="panel">
                <h3>üü† Hot Drop</h3>
                <div class="tool-description">
                    <strong>Hot-patch Dropper</strong><br>
                    Drag-and-drop hot-patching using DPAPI for memory-only operations.
                </div>
                <div class="drag-drop" id="hotdrop-drop">
                    <p>üìÅ Drag & Drop executable here</p>
                    <p>or</p>
                    <input type="file" id="hotdrop-file" class="file-input" accept=".exe,.dll">
                </div>
                <button class="btn" onclick="executeHotDrop()">Execute Hot Drop</button>
                <div id="hotdrop-status"></div>
                <div id="hotdrop-output" class="output"></div>
            </div>

            <!-- File-less Encryptor Panel -->
            <div class="panel">
                <h3>üîµ File-less Encryptor</h3>
                <div class="tool-description">
                    <strong>File-less Encryption with Polymorphic Stub</strong><br>
                    In-memory Camellia-256-CTR encryption with polymorphic C stub generation.
                </div>
                <div class="drag-drop" id="fileless-drop">
                    <p>üìÅ Drag & Drop any file here</p>
                    <p>or</p>
                    <input type="file" id="fileless-file" class="file-input">
                </div>
                <button class="btn" onclick="executeFilelessEncryptor()">File-less Encrypt</button>
                <div id="fileless-status"></div>
                <div id="fileless-output" class="output"></div>
            </div>

            <!-- Auto-Key File-less Panel -->
            <div class="panel">
                <h3>üü¢ Auto-Key File-less</h3>
                <div class="tool-description">
                    <strong>Auto-Key File-less Encryption</strong><br>
                    Derives key/IV from Windows logon password + machine SID automatically.
                </div>
                <div class="drag-drop" id="autokey-drop">
                    <p>üìÅ Drag & Drop any file here</p>
                    <p>or</p>
                    <input type="file" id="autokey-file" class="file-input">
                </div>
                <button class="btn" onclick="executeAutoKeyFileless()">Auto-Key Encrypt</button>
                <div id="autokey-status"></div>
                <div id="autokey-output" class="output"></div>
            </div>

            <!-- CamDrop Panel -->
            <div class="panel">
                <h3>üü° CamDrop</h3>
                <div class="tool-description">
                    <strong>Drag-and-Drop Encrypted Stub Generator</strong><br>
                    Auto-key derivation with polymorphic stub generation and elevation.
                </div>
                <div class="drag-drop" id="camdrop-drop">
                    <p>üìÅ Drag & Drop any file here</p>
                    <p>or</p>
                    <input type="file" id="camdrop-file" class="file-input">
                </div>
                <button class="btn" onclick="executeCamDrop()">Generate Encrypted Stub</button>
                <div id="camdrop-status"></div>
                <div id="camdrop-output" class="output"></div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let selectedFiles = {};

        // Initialize drag and drop functionality
        document.addEventListener('DOMContentLoaded', function() {
            initializeDragAndDrop();
        });

        function initializeDragAndDrop() {
            const dropZones = document.querySelectorAll('.drag-drop');
            
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('dragleave', handleDragLeave);
                zone.addEventListener('drop', handleDrop);
                zone.addEventListener('click', () => {
                    const fileInput = zone.querySelector('input[type="file"]');
                    if (fileInput) fileInput.click();
                });
            });

            // File input change handlers
            document.querySelectorAll('input[type="file"]').forEach(input => {
                input.addEventListener('change', handleFileSelect);
            });
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('dragover');
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            const panelId = e.currentTarget.id.replace('-drop', '');
            
            if (files.length > 0) {
                selectedFiles[panelId] = files[0];
                updateFileDisplay(panelId, files[0].name);
            }
        }

        function handleFileSelect(e) {
            const panelId = e.target.id.replace('-file', '');
            if (e.target.files.length > 0) {
                selectedFiles[panelId] = e.target.files[0];
                updateFileDisplay(panelId, e.target.files[0].name);
            }
        }

        function updateFileDisplay(panelId, fileName) {
            const dropZone = document.getElementById(panelId + '-drop');
            dropZone.innerHTML = `<p>‚úÖ Selected: ${fileName}</p><p>Click to change file</p>`;
        }

        function showStatus(panelId, message, type = 'info') {
            const statusDiv = document.getElementById(panelId + '-status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        function showOutput(panelId, output) {
            const outputDiv = document.getElementById(panelId + '-output');
            outputDiv.textContent = output;
        }

        // PowerShell execution functions
        async function executeEvAdrKiller() {
            if (!selectedFiles.evadr) {
                showStatus('evadr', 'Please select a file first', 'error');
                return;
            }

            showStatus('evadr', 'Executing EvAdrKiller...', 'info');
            
            try {
                const formData = new FormData();
                formData.append('file', selectedFiles.evadr);
                formData.append('tool', 'evadr');

                const response = await fetch('/api/powershell/execute', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();
                
                if (result.success) {
                    showStatus('evadr', 'EvAdrKiller executed successfully', 'success');
                    showOutput('evadr', result.output);
                } else {
                    showStatus('evadr', 'EvAdrKiller execution failed', 'error');
                    showOutput('evadr', result.error);
                }
            } catch (error) {
                showStatus('evadr', 'Error executing EvAdrKiller', 'error');
                showOutput('evadr', error.message);
            }
        }

        async function executeBeaconism() {
            if (!selectedFiles.beacon) {
                showStatus('beacon', 'Please select a file first', 'error');
                return;
            }

            showStatus('beacon', 'Executing Beaconism...', 'info');
            
            try {
                const formData = new FormData();
                formData.append('file', selectedFiles.beacon);
                formData.append('tool', 'beacon');

                const response = await fetch('/api/powershell/execute', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();
                
                if (result.success) {
                    showStatus('beacon', 'Beaconism executed successfully', 'success');
                    showOutput('beacon', result.output);
                } else {
                    showStatus('beacon', 'Beaconism execution failed', 'error');
                    showOutput('beacon', result.error);
                }
            } catch (error) {
                showStatus('beacon', 'Error executing Beaconism', 'error');
                showOutput('beacon', error.message);
            }
        }

        async function executeCppEncExe() {
            if (!selectedFiles.cppenc) {
                showStatus('cppenc', 'Please select a C++ file first', 'error');
                return;
            }

            showStatus('cppenc', 'Compiling and encrypting...', 'info');
            
            try {
                const formData = new FormData();
                formData.append('file', selectedFiles.cppenc);
                formData.append('tool', 'cppenc');

                const response = await fetch('/api/powershell/execute', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();
                
                if (result.success) {
                    showStatus('cppenc', 'C++ compilation and encryption completed', 'success');
                    showOutput('cppenc', result.output);
                } else {
                    showStatus('cppenc', 'C++ compilation failed', 'error');
                    showOutput('cppenc', result.error);
                }
            } catch (error) {
                showStatus('cppenc', 'Error executing CppEncExe', 'error');
                showOutput('cppenc', error.message);
            }
        }

        async function executeFHp() {
            if (!selectedFiles.fhp) {
                showStatus('fhp', 'Please select a C++ file first', 'error');
                return;
            }

            showStatus('fhp', 'Executing file-less hot-patch...', 'info');
            
            try {
                const formData = new FormData();
                formData.append('file', selectedFiles.fhp);
                formData.append('tool', 'fhp');

                const response = await fetch('/api/powershell/execute', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();
                
                if (result.success) {
                    showStatus('fhp', 'File-less hot-patch executed successfully', 'success');
                    showOutput('fhp', result.output);
                } else {
                    showStatus('fhp', 'File-less hot-patch failed', 'error');
                    showOutput('fhp', result.error);
                }
            } catch (error) {
                showStatus('fhp', 'Error executing file-less hot-patch', 'error');
                showOutput('fhp', error.message);
            }
        }

        async function executeTripleCrypto() {
            if (!selectedFiles.triple) {
                showStatus('triple', 'Please select a file first', 'error');
                return;
            }

            showStatus('triple', 'Executing triple encryption...', 'info');
            
            try {
                const formData = new FormData();
                formData.append('file', selectedFiles.triple);
                formData.append('tool', 'triple');
                formData.append('password', document.getElementById('triple-password').value);

                const response = await fetch('/api/powershell/execute', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();
                
                if (result.success) {
                    showStatus('triple', 'Triple encryption completed', 'success');
                    showOutput('triple', result.output);
                } else {
                    showStatus('triple', 'Triple encryption failed', 'error');
                    showOutput('triple', result.error);
                }
            } catch (error) {
                showStatus('triple', 'Error executing triple encryption', 'error');
                showOutput('triple', error.message);
            }
        }

        async function executeHotDrop() {
            if (!selectedFiles.hotdrop) {
                showStatus('hotdrop', 'Please select a file first', 'error');
                return;
            }

            showStatus('hotdrop', 'Executing hot drop...', 'info');
            
            try {
                const formData = new FormData();
                formData.append('file', selectedFiles.hotdrop);
                formData.append('tool', 'hotdrop');

                const response = await fetch('/api/powershell/execute', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();
                
                if (result.success) {
                    showStatus('hotdrop', 'Hot drop executed successfully', 'success');
                    showOutput('hotdrop', result.output);
                } else {
                    showStatus('hotdrop', 'Hot drop failed', 'error');
                    showOutput('hotdrop', result.error);
                }
            } catch (error) {
                showStatus('hotdrop', 'Error executing hot drop', 'error');
                showOutput('hotdrop', error.message);
            }
        }

        async function executeFilelessEncryptor() {
            if (!selectedFiles.fileless) {
                showStatus('fileless', 'Please select a file first', 'error');
                return;
            }

            showStatus('fileless', 'Executing file-less encryption...', 'info');
            
            try {
                const formData = new FormData();
                formData.append('file', selectedFiles.fileless);
                formData.append('tool', 'fileless');

                const response = await fetch('/api/powershell/execute', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();
                
                if (result.success) {
                    showStatus('fileless', 'File-less encryption completed', 'success');
                    showOutput('fileless', result.output);
                } else {
                    showStatus('fileless', 'File-less encryption failed', 'error');
                    showOutput('fileless', result.error);
                }
            } catch (error) {
                showStatus('fileless', 'Error executing file-less encryption', 'error');
                showOutput('fileless', error.message);
            }
        }

        async function executeAutoKeyFileless() {
            if (!selectedFiles.autokey) {
                showStatus('autokey', 'Please select a file first', 'error');
                return;
            }

            showStatus('autokey', 'Executing auto-key file-less encryption...', 'info');
            
            try {
                const formData = new FormData();
                formData.append('file', selectedFiles.autokey);
                formData.append('tool', 'autokey');

                const response = await fetch('/api/powershell/execute', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();
                
                if (result.success) {
                    showStatus('autokey', 'Auto-key file-less encryption completed', 'success');
                    showOutput('autokey', result.output);
                } else {
                    showStatus('autokey', 'Auto-key file-less encryption failed', 'error');
                    showOutput('autokey', result.error);
                }
            } catch (error) {
                showStatus('autokey', 'Error executing auto-key file-less encryption', 'error');
                showOutput('autokey', error.message);
            }
        }

        async function executeCamDrop() {
            if (!selectedFiles.camdrop) {
                showStatus('camdrop', 'Please select a file first', 'error');
                return;
            }

            showStatus('camdrop', 'Generating encrypted stub...', 'info');
            
            try {
                const formData = new FormData();
                formData.append('file', selectedFiles.camdrop);
                formData.append('tool', 'camdrop');

                const response = await fetch('/api/powershell/execute', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();
                
                if (result.success) {
                    showStatus('camdrop', 'Encrypted stub generated successfully', 'success');
                    showOutput('camdrop', result.output);
                } else {
                    showStatus('camdrop', 'Stub generation failed', 'error');
                    showOutput('camdrop', result.error);
                }
            } catch (error) {
                showStatus('camdrop', 'Error generating encrypted stub', 'error');
                showOutput('camdrop', error.message);
            }
        }
    </script>
</body>
</html>
